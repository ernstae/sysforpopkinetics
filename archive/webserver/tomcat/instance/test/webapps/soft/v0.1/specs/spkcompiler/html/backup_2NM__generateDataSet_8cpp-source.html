<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Compiler API Documentation: NM_generateDataSet.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">spkcompiler</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">nonmem</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">backup</a></div>
<h1>backup/NM_generateDataSet.cpp</h1><div class="fragment"><pre class="fragment">00001 
00005 <span class="preprocessor">#include &lt;fstream&gt;</span>
00006 <span class="preprocessor">#include &lt;string&gt;</span>
00007 <span class="preprocessor">#include "<a class="code" href="NonmemTranslator_8h.html">NonmemTranslator.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="SpkCompilerException_8h.html">SpkCompilerException.h</a>"</span>
00009 
00010 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00011 <span class="keyword">using</span> <span class="keyword">namespace </span>xercesc;
00012 
00013 <span class="comment">//=========================================================================================</span>
00014 <span class="comment">//</span>
00015 <span class="comment">// Generate DataSet.h, a file declaring and defining DataSet template class,</span>
00016 <span class="comment">// a class that represents an entire population data set.</span>
00017 <span class="comment">//</span>
00018 <span class="comment">// Pre-conditions  - The symbol table contains the NONMEM keywords and user defined variable</span>
00019 <span class="comment">//                   names needed by the user-provided model.</span>
00020 <span class="comment">//</span>
00021 <span class="comment">//                 - The symbol table contains entries for the data labels and aliases.</span>
00022 <span class="comment">//                   The list of data labels have to be retrievable by calling </span>
00023 <span class="comment">//                   SymbolTable::getlabels().  </span>
00024 <span class="comment">//          </span>
00025 <span class="comment">//                 - The vector returned by SymbolTable::getLables() must contain</span>
00026 <span class="comment">//                   the data labels in the order in which they define the data items </span>
00027 <span class="comment">//                   (ie. columns) in the data set.</span>
00028 <span class="comment">//</span>
00029 <span class="comment">//                 - The current working directory is writable.</span>
00030 <span class="comment">//</span>
00031 <span class="comment">// post-conditions - DataSet.h will be generated in the current working directory.</span>
00032 <span class="comment">//</span>
00033 <span class="comment">//=========================================================================================</span>
<a name="l00034"></a><a class="code" href="classNonmemTranslator.html#d19">00034</a> <span class="keywordtype">void</span> <a class="code" href="classNonmemTranslator.html#d19">NonmemTranslator::generateDataSet</a>( )<span class="keyword"> const</span>
00035 <span class="keyword"></span>{
00036   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
00037   <span class="comment">//</span>
00038   <span class="comment">// Preliminaries</span>
00039   <span class="comment">//</span>
00040   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
00041 
00042   <span class="comment">// </span>
00043   <span class="comment">// A SymbolTable object uses a std::map object as the actual</span>
00044   <span class="comment">// table.  The usual way of retrieving the entries in the internal</span>
00045   <span class="comment">// table is though member functions provided by SymbolTable class.</span>
00046   <span class="comment">// Another way, which is used here, is to access the internal</span>
00047   <span class="comment">// table directly, which is faster and convenient.</span>
00048   <span class="comment">//</span>
00049   <span class="keyword">const</span> map&lt;const string, Symbol&gt; * <span class="keyword">const</span> t = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a8">getTable</a>();
00050 
00051   <span class="comment">//</span>
00052   <span class="comment">// The order in which the label strings appear is significant.</span>
00053   <span class="comment">// So, get a constant pointer to the list so that I cannot </span>
00054   <span class="comment">// mess it up.</span>
00055   <span class="comment">//</span>
00056   <span class="keyword">const</span> vector&lt;string&gt; *labels = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a7">getLabels</a>();
00057   vector&lt;string&gt;::const_iterator pLabel;
00058   <span class="keyword">const</span> <span class="keywordtype">int</span> nLabels = labels-&gt;size();
00059 
00060   <span class="comment">//</span>
00061   <span class="comment">// Reference to an Symbol object that represents "ID" data label.</span>
00062   <span class="comment">// Keep it for repetitive use.</span>
00063   <span class="comment">//</span>
00064   <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a> * <span class="keyword">const</span> pID = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( nonmem::ID );
00065 
00066   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
00067   <span class="comment">//</span>
00068   <span class="comment">// Write into DataSet.h</span>
00069   <span class="comment">//</span>
00070   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
00071 
00072   <span class="comment">//</span>
00073   <span class="comment">// Declare and define DataSet template class.</span>
00074   <span class="comment">// For name binding reason, the declaration and the definition</span>
00075   <span class="comment">// are both stored in a single file: DataSet.h</span>
00076   <span class="comment">// </span>
00077   <span class="comment">// The only legal constructor is the default constructor.</span>
00078   <span class="comment">// The constructor initializes the array of IndData objects,</span>
00079   <span class="comment">// each contains the entire data set for a subject.</span>
00080   <span class="comment">//</span>
00081   <span class="comment">// The order in which the arguments to the IndData </span>
00082   <span class="comment">// constructor appear is significant.  The order must</span>
00083   <span class="comment">// match with the IndData constructor's interface.</span>
00084   <span class="comment">// It relizes on the order of strings stored in the list </span>
00085   <span class="comment">// returned by "SymbolTable::getLabels()".</span>
00086   <span class="comment">// Thus, in between the time when the DataSet constructor</span>
00087   <span class="comment">// is defined and the time when the IndData constructor</span>
00088   <span class="comment">// is declared/defined, the SymbolTable object</span>
00089   <span class="comment">// may NOT be modified.</span>
00090   <span class="comment">//</span>
00091   ofstream oDataSet_h( <a class="code" href="classNonmemTranslator.html#v2">fDataSet_h</a> );
00092   <span class="keywordflow">if</span>( !oDataSet_h.good() )
00093     {
00094       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e3">SpkCompilerError::maxMessageLen</a>() ];
00095       snprintf( mess, 
00096         SpkCompilerError::maxMessageLen(),
00097         <span class="stringliteral">"Failed to create a file, %s."</span>, <a class="code" href="classNonmemTranslator.html#v2">fDataSet_h</a> );
00098       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( SpkCompilerError::ASPK_STD_ERR, mess, __LINE__, __FILE__ );
00099       <span class="keywordflow">throw</span> e;
00100     }
00101 
00102   <span class="comment">//---------------------------------------------------------------------------------------</span>
00103   <span class="comment">//</span>
00104   <span class="comment">// Print out some description for this file.</span>
00105   <span class="comment">//</span>
00106   <span class="comment">//---------------------------------------------------------------------------------------</span>
00107   oDataSet_h &lt;&lt; <span class="stringliteral">"// "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r2">myDescription</a> &lt;&lt; endl;
00108 
00109   <span class="comment">//---------------------------------------------------------------------------------------</span>
00110   <span class="comment">// </span>
00111   <span class="comment">// Header include statements.</span>
00112   <span class="comment">//</span>
00113   <span class="comment">//---------------------------------------------------------------------------------------</span>
00114   oDataSet_h &lt;&lt; <span class="stringliteral">"#ifndef DATASET_H"</span> &lt;&lt; endl;
00115   oDataSet_h &lt;&lt; <span class="stringliteral">"#define DATASET_H"</span> &lt;&lt; endl;
00116 
00117   oDataSet_h &lt;&lt; <span class="stringliteral">"#include &lt;vector&gt;"</span> &lt;&lt; endl;
00118   oDataSet_h &lt;&lt; <span class="stringliteral">"#include &lt;spk/SpkValarray.h&gt;"</span> &lt;&lt; endl;
00119   oDataSet_h &lt;&lt; <span class="stringliteral">"#include \"IndData.h\""</span> &lt;&lt; endl;
00120   oDataSet_h &lt;&lt; endl;
00121 
00122   <span class="comment">//---------------------------------------------------------------------------------------</span>
00123   <span class="comment">//</span>
00124   <span class="comment">// Declaration of DataSet class</span>
00125   <span class="comment">//</span>
00126   <span class="comment">// The template argument (ie. "ValueType" in this case)</span>
00127   <span class="comment">// must be something guaranteed that the user</span>
00128   <span class="comment">// do not use for one of their user-defined variables.</span>
00129   <span class="comment">//</span>
00130   <span class="comment">// The specification for SpkSourceML where the </span>
00131   <span class="comment">// definition of PRED or other models appears</span>
00132   <span class="comment">// restricts user use of variable names beginning</span>
00133   <span class="comment">// with "spk_", let's take advantage of it here.</span>
00134   <span class="comment">//</span>
00135   <span class="comment">//---------------------------------------------------------------------------------------</span>
00136   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00137   oDataSet_h &lt;&lt; <span class="stringliteral">"class DataSet"</span> &lt;&lt; endl;
00138   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00139       
00140   <span class="comment">//----------------------------------------</span>
00141   <span class="comment">// Public member declarations.</span>
00142   <span class="comment">//----------------------------------------</span>
00143   oDataSet_h &lt;&lt; <span class="stringliteral">"public:"</span> &lt;&lt; endl;
00144 
00145   <span class="comment">// -------------------</span>
00146   <span class="comment">// Default constructor</span>
00147   <span class="comment">// -------------------</span>
00148   <span class="comment">// The default constructor initializes the entire data set</span>
00149   <span class="comment">// internally.</span>
00150   <span class="comment">//</span>
00151   oDataSet_h &lt;&lt; <span class="stringliteral">"   DataSet();"</span> &lt;&lt; endl;
00152 
00153   <span class="comment">// ----------</span>
00154   <span class="comment">// Destructor</span>
00155   <span class="comment">// ----------</span>
00156   oDataSet_h &lt;&lt; <span class="stringliteral">"   ~DataSet();"</span> &lt;&lt; endl;
00157   oDataSet_h &lt;&lt; endl;
00158 
00159   <span class="comment">// ------------</span>
00160   <span class="comment">// The data set</span>
00161   <span class="comment">// ------------</span>
00162   oDataSet_h &lt;&lt; <span class="stringliteral">"   std::vector&lt;IndData&lt;spk_ValueType&gt;*&gt; data;"</span> &lt;&lt; endl;
00163 
00164   <span class="comment">// -----------------------</span>
00165   <span class="comment">// Public member functions</span>
00166   <span class="comment">// -----------------------</span>
00167   oDataSet_h &lt;&lt; <span class="stringliteral">"   void expand( const SPK_VA::valarray&lt;double&gt;&amp; measurements, SPK_VA::valarray&lt;double&gt;&amp; records ) const;"</span> &lt;&lt; endl;
00168   oDataSet_h &lt;&lt; <span class="stringliteral">"   void expand( int who, const SPK_VA::valarray&lt;double&gt;&amp; measurements_who, SPK_VA::valarray&lt;double&gt;&amp; records_who ) const;"</span> &lt;&lt; endl;
00169   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getMeasurementIndex( int recordIndex ) const;"</span> &lt;&lt; endl;
00170   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getMeasurementIndex( int who, int recordIndex ) const;"</span> &lt;&lt; endl;
00171   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getRecordIndex( int measurementIndex ) const;"</span> &lt;&lt; endl;
00172   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getRecordIndex( int who, int measurementIndex ) const;"</span> &lt;&lt; endl;
00173   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getPopSize() const;"</span> &lt;&lt; endl;
00174   oDataSet_h &lt;&lt; <span class="stringliteral">"   const SPK_VA::valarray&lt;int&gt; getN() const;"</span> &lt;&lt; endl;
00175   oDataSet_h &lt;&lt; <span class="stringliteral">"   const SPK_VA::valarray&lt;int&gt; getNObservs() const;"</span> &lt;&lt; endl;
00176   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getNObservs( int i ) const;"</span> &lt;&lt; endl;
00177   oDataSet_h &lt;&lt; <span class="stringliteral">"   const SPK_VA::valarray&lt;int&gt; getNRecords() const;"</span> &lt;&lt; endl;
00178   oDataSet_h &lt;&lt; <span class="stringliteral">"   int getNRecords( int i ) const;"</span> &lt;&lt; endl;
00179   oDataSet_h &lt;&lt; <span class="stringliteral">"   const SPK_VA::valarray&lt;double&gt; getAllMeasurements() const;"</span> &lt;&lt; endl;
00180   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceAllMeasurements( const SPK_VA::valarray&lt;double&gt; &amp; yy );"</span>    &lt;&lt; endl;
00181   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceEta     ( const SPK_VA::valarray&lt;double&gt;&amp; EtaIn );"</span>      &lt;&lt; endl;
00182   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePred    ( const SPK_VA::valarray&lt;double&gt;&amp; PredIn );"</span>        &lt;&lt; endl;
00183   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceRes     ( const SPK_VA::valarray&lt;double&gt;&amp; ResIn );"</span>         &lt;&lt; endl;
00184   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceWRes    ( const SPK_VA::valarray&lt;double&gt;&amp; WResIn );"</span>        &lt;&lt; endl;
00185   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceEtaRes  ( const SPK_VA::valarray&lt;double&gt;&amp; EtaResIn );"</span>      &lt;&lt; endl;
00186   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceWEtaRes ( const SPK_VA::valarray&lt;double&gt;&amp; WEtaResIn );"</span>     &lt;&lt; endl;
00187   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceIPred   ( const SPK_VA::valarray&lt;double&gt;&amp; iPredIn );"</span>       &lt;&lt; endl;
00188   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceIRes    ( const SPK_VA::valarray&lt;double&gt;&amp; iResIn );"</span>        &lt;&lt; endl;
00189   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceIWRes   ( const SPK_VA::valarray&lt;double&gt;&amp; iWResIn );"</span>       &lt;&lt; endl;
00190   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceIEtaRes ( const SPK_VA::valarray&lt;double&gt;&amp; iEtaResIn );"</span>     &lt;&lt; endl;
00191   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceIWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; iWEtaResIn );"</span>    &lt;&lt; endl;
00192   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePPred   ( const SPK_VA::valarray&lt;double&gt;&amp; pPredIn );"</span>       &lt;&lt; endl;
00193   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePRes    ( const SPK_VA::valarray&lt;double&gt;&amp; pResAllIn );"</span>     &lt;&lt; endl;
00194   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePWRes   ( const SPK_VA::valarray&lt;double&gt;&amp; pWResAllIn );"</span>    &lt;&lt; endl;
00195   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePEtaRes ( const SPK_VA::valarray&lt;double&gt;&amp; pEtaResAllIn );"</span>  &lt;&lt; endl;
00196   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replacePWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; pWEtaResAllIn );"</span> &lt;&lt; endl;
00197   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceCPred   ( const SPK_VA::valarray&lt;double&gt;&amp; cPredIn );"</span>       &lt;&lt; endl;
00198   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceCRes    ( const SPK_VA::valarray&lt;double&gt;&amp; cResAllIn );"</span>     &lt;&lt; endl;
00199   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceCWRes   ( const SPK_VA::valarray&lt;double&gt;&amp; cWResAllIn );"</span>    &lt;&lt; endl;
00200   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceCEtaRes ( const SPK_VA::valarray&lt;double&gt;&amp; cEtaResAllIn );"</span>  &lt;&lt; endl;
00201   oDataSet_h &lt;&lt; <span class="stringliteral">"   void replaceCWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; cWEtaResAllIn );"</span> &lt;&lt; endl;
00202   oDataSet_h &lt;&lt; endl;
00203   <span class="comment">//  oDataSet_h &lt;&lt; "   friend std::ostream&amp; operator&lt;&lt; &lt;spk_ValueType&gt;( std::ostream&amp; o, const DataSet&lt;spk_ValueType&gt;&amp; A );" &lt;&lt; endl;</span>
00204   oDataSet_h &lt;&lt; endl;
00205  
00206   <span class="comment">//----------------------------------------</span>
00207   <span class="comment">// Protected member declarations.</span>
00208   <span class="comment">//----------------------------------------</span>
00209   oDataSet_h &lt;&lt; <span class="stringliteral">"protected:"</span> &lt;&lt; endl;
00210   oDataSet_h &lt;&lt; <span class="stringliteral">"   DataSet( const DataSet&amp; );"</span> &lt;&lt; endl;
00211   oDataSet_h &lt;&lt; <span class="stringliteral">"   DataSet&amp; operator=( const DataSet&amp; );"</span> &lt;&lt; endl;
00212   oDataSet_h &lt;&lt; endl;
00213 
00214   <span class="comment">//----------------------------------------</span>
00215   <span class="comment">// Converted to public due to access by non-friends 06/22/2006 ernst@u</span>
00216   <span class="comment">//----------------------------------------</span>
00217   oDataSet_h &lt;&lt; <span class="stringliteral">"public:"</span> &lt;&lt; endl;
00218   oDataSet_h &lt;&lt; <span class="stringliteral">"   SPK_VA::valarray&lt;int&gt; NRecords;  // # of records for each individual."</span> &lt;&lt; endl;  
00219 
00220   <span class="comment">//----------------------------------------</span>
00221   <span class="comment">// Private member declarations.</span>
00222   <span class="comment">//----------------------------------------</span>
00223   oDataSet_h &lt;&lt; <span class="stringliteral">"private:"</span> &lt;&lt; endl;
00224   oDataSet_h &lt;&lt; <span class="stringliteral">"   SPK_VA::valarray&lt;double&gt; measurements; // a long vector containg all measurements"</span> &lt;&lt; endl;
00225   <span class="comment">//  oDataSet_h &lt;&lt; "   SPK_VA::valarray&lt;int&gt; NRecords;  // # of records for each individual." &lt;&lt; endl;</span>
00226   oDataSet_h &lt;&lt; <span class="stringliteral">"   SPK_VA::valarray&lt;int&gt; NObservs; // # of measurements for each individual."</span> &lt;&lt; endl;
00227   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int popSize;"</span> &lt;&lt; endl;
00228   oDataSet_h &lt;&lt; endl;
00229   oDataSet_h &lt;&lt; <span class="stringliteral">"   /////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00230   oDataSet_h &lt;&lt; <span class="stringliteral">"   //      original                     y"</span>                    &lt;&lt; endl;
00231   oDataSet_h &lt;&lt; <span class="stringliteral">"   //  -------------------      -------------------"</span>          &lt;&lt; endl;
00232   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   j    i   MDV   DV         j'  j   i   DV"</span>             &lt;&lt; endl;
00233   oDataSet_h &lt;&lt; <span class="stringliteral">"   //  -------------------      -------------------"</span>          &lt;&lt; endl;
00234   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   0    0    0    0.1        0   0   0   0.1"</span>            &lt;&lt; endl;
00235   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   1    0    1               1   2   0   0.2"</span>            &lt;&lt; endl;
00236   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   2    0    0    0.2        2   4   0   0.3"</span>            &lt;&lt; endl;
00237   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   3    0    1               3   5   1   0.01"</span>           &lt;&lt; endl;
00238   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   4    0    0    0.3        4   7   1   0.02"</span>           &lt;&lt; endl;
00239   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   5    1    0    0.1        5   9   1   0.03"</span>           &lt;&lt; endl;
00240   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   6    1    1"</span>                                          &lt;&lt; endl;
00241   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   7    1    0    0.2"</span>                                   &lt;&lt; endl;
00242   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   8    1    1"</span>                                          &lt;&lt; endl;
00243   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   9    1    0    0.3"</span>                                   &lt;&lt; endl;
00244   oDataSet_h &lt;&lt; <span class="stringliteral">"   //"</span>                                                        &lt;&lt; endl;
00245   oDataSet_h &lt;&lt; <span class="stringliteral">"   //"</span>                                                        &lt;&lt; endl;
00246   oDataSet_h &lt;&lt; <span class="stringliteral">"   //   jTojPrime            jPrimeToj"</span>                       &lt;&lt; endl;
00247   oDataSet_h &lt;&lt; <span class="stringliteral">"   //  -----------          -----------"</span>                      &lt;&lt; endl;
00248   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    j    j'              j'   j"</span>                         &lt;&lt; endl;
00249   oDataSet_h &lt;&lt; <span class="stringliteral">"   //  -----------          -----------"</span>                      &lt;&lt; endl;
00250   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    0    0               0    0"</span>                         &lt;&lt; endl;
00251   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    1   -1*              1    2"</span>                         &lt;&lt; endl;
00252   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    2    1               2    4"</span>                         &lt;&lt; endl;
00253   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    3   -1*              3    5"</span>                         &lt;&lt; endl;
00254   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    4    2               4    7"</span>                         &lt;&lt; endl;
00255   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    5    3               5    9"</span>                         &lt;&lt; endl;
00256   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    6   -1*"</span>                                             &lt;&lt; endl;
00257   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    7    4"</span>                                              &lt;&lt; endl;
00258   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    8   -1*"</span>                                             &lt;&lt; endl;
00259   oDataSet_h &lt;&lt; <span class="stringliteral">"   //    9    5"</span>                                              &lt;&lt; endl;
00260   oDataSet_h &lt;&lt; <span class="stringliteral">"   //"</span>                                                        &lt;&lt; endl;
00261   oDataSet_h &lt;&lt; <span class="stringliteral">"   //  * (-1) points to no j', i.e. MDV=1"</span>                    &lt;&lt; endl;
00262   oDataSet_h &lt;&lt; <span class="stringliteral">"   /////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00263   oDataSet_h &lt;&lt; <span class="stringliteral">"   std::vector&lt;int&gt; jTojPrime;"</span> &lt;&lt; endl;
00264   oDataSet_h &lt;&lt; <span class="stringliteral">"   std::vector&lt;int&gt; jPrimeToj;"</span> &lt;&lt; endl;
00265 
00266   oDataSet_h &lt;&lt; <span class="stringliteral">"};"</span> &lt;&lt; endl;
00267   oDataSet_h &lt;&lt; endl;
00268 
00269   <span class="comment">//---------------------------------------------------------------------------------------</span>
00270   <span class="comment">//</span>
00271   <span class="comment">// Definition of DataSet class</span>
00272   <span class="comment">//</span>
00273   <span class="comment">//---------------------------------------------------------------------------------------</span>
00274        
00275   <span class="comment">// -------------------</span>
00276   <span class="comment">// Default constructor</span>
00277   <span class="comment">// -------------------</span>
00278   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00279   oDataSet_h &lt;&lt; <span class="stringliteral">"DataSet&lt;spk_ValueType&gt;::DataSet()"</span> &lt;&lt; endl;
00280 
00281   <span class="comment">//</span>
00282   <span class="comment">// Constructor intialization</span>
00283   <span class="comment">//</span>
00284   oDataSet_h &lt;&lt; <span class="stringliteral">": popSize( "</span>  &lt;&lt; <a class="code" href="classClientTranslator.html#a12">getPopSize</a>() &lt;&lt; <span class="stringliteral">" ),"</span> &lt;&lt; endl;
00285   oDataSet_h &lt;&lt; <span class="stringliteral">"  data( "</span>     &lt;&lt; <a class="code" href="classClientTranslator.html#a12">getPopSize</a>() &lt;&lt; <span class="stringliteral">" ),"</span> &lt;&lt; endl;
00286   oDataSet_h &lt;&lt; <span class="stringliteral">"  NRecords( "</span> &lt;&lt; <a class="code" href="classClientTranslator.html#a12">getPopSize</a>() &lt;&lt; <span class="stringliteral">" ), // #of records for each individual"</span> &lt;&lt; endl;
00287   oDataSet_h &lt;&lt; <span class="stringliteral">"  NObservs( "</span> &lt;&lt; <a class="code" href="classClientTranslator.html#a12">getPopSize</a>() &lt;&lt; <span class="stringliteral">" )  // #of DVs for each individuals"</span> &lt;&lt; endl;
00288 
00289   <span class="comment">//</span>
00290   <span class="comment">// Constructor body</span>
00291   <span class="comment">//</span>
00292   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00293 
00294   <span class="comment">// Initialize the entire data set.</span>
00295   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> who=0, sofar=0, nRecords=0; who &lt; <a class="code" href="classClientTranslator.html#a12">getPopSize</a>(); who++, sofar+=nRecords )
00296     {
00297       <span class="keywordtype">char</span> c_who[256];
00298       snprintf( c_who, 256,<span class="stringliteral">"%d"</span>, who );
00299       <span class="keywordtype">int</span> nRecords = pID-&gt;<a class="code" href="classSymbol.html#o4">initial</a>[who].size();
00300       <span class="keywordtype">int</span> nDVs = 0;
00301       <span class="keyword">const</span> string <span class="keywordtype">id</span> = pID-&gt;<a class="code" href="classSymbol.html#o4">initial</a>[who][0];
00302 
00303       <span class="comment">//</span>
00304       <span class="comment">// The order in which the labels appear must be consistent</span>
00305       <span class="comment">// with the order in the constructor declaration.</span>
00306       <span class="comment">// By using the iterator in both places, here and up there,</span>
00307       <span class="comment">// they shall match.  However, this should be tested in</span>
00308       <span class="comment">// the corresponding unit tests.</span>
00309       <span class="comment">//</span>
00310       oDataSet_h &lt;&lt; <span class="stringliteral">"   //------------------------------------"</span> &lt;&lt; endl;
00311       oDataSet_h &lt;&lt; <span class="stringliteral">"   // Subject &lt;"</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">"&gt; "</span> &lt;&lt; endl;
00312       oDataSet_h &lt;&lt; <span class="stringliteral">"   // # of sampling points = "</span> &lt;&lt; nRecords &lt;&lt; endl;
00313       oDataSet_h &lt;&lt; <span class="stringliteral">"   //------------------------------------"</span> &lt;&lt; endl;
00314       oDataSet_h &lt;&lt; <span class="stringliteral">"   NRecords["</span> &lt;&lt; who &lt;&lt; <span class="stringliteral">"] = "</span> &lt;&lt; nRecords &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00315 
00316       <span class="comment">//</span>
00317       <span class="comment">// Initialize C arrays with data values.</span>
00318       <span class="comment">// The C arrays are passed to the valarray's constructor.</span>
00319       <span class="comment">//</span>
00320       pLabel = labels-&gt;begin();
00321       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; pLabel != labels-&gt;end(), i&lt;nLabels; i++, pLabel++ )
00322     {
00323       <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a> * s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( *pLabel );
00324       <span class="keywordtype">bool</span> isID  = (*pLabel == pID-&gt;<a class="code" href="classSymbol.html#o0">name</a>);
00325       <span class="keywordtype">bool</span> isInt = (*pLabel == nonmem::EVID || *pLabel == nonmem::CMT || *pLabel == nonmem::PCMT );
00326 
00327       string carray_name = s-&gt;<a class="code" href="classSymbol.html#o0">name</a> + <span class="stringliteral">"_"</span> + c_who + <span class="stringliteral">"_c"</span>;
00328       string vector_name = s-&gt;<a class="code" href="classSymbol.html#o0">name</a> + <span class="stringliteral">"_"</span> + c_who;
00329 
00330           <span class="keywordflow">if</span>( isID )
00331         oDataSet_h &lt;&lt; <span class="stringliteral">"char*"</span>;
00332       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( isInt )
00333         oDataSet_h &lt;&lt; <span class="stringliteral">"int"</span>;
00334       <span class="keywordflow">else</span>
00335         oDataSet_h &lt;&lt; <span class="stringliteral">"spk_ValueType"</span>;
00336       
00337       oDataSet_h &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; carray_name &lt;&lt; <span class="stringliteral">"[] = { "</span>;
00338       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j=0; j&lt;nRecords; j++ )
00339         {
00340           <span class="keywordflow">if</span>( j &gt; 0 )
00341         oDataSet_h &lt;&lt; <span class="stringliteral">", "</span>;
00342           <span class="keywordflow">if</span>( isID )
00343         oDataSet_h &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; s-&gt;<a class="code" href="classSymbol.html#o4">initial</a>[who][j] &lt;&lt; <span class="stringliteral">"\""</span>;
00344           <span class="keywordflow">else</span>
00345         oDataSet_h &lt;&lt; s-&gt;<a class="code" href="classSymbol.html#o4">initial</a>[who][j];
00346         }
00347       oDataSet_h &lt;&lt; <span class="stringliteral">" };"</span> &lt;&lt; endl;
00348       oDataSet_h &lt;&lt; <span class="stringliteral">"   std::vector&lt;"</span>;
00349       <span class="keywordflow">if</span>( isID )
00350         oDataSet_h &lt;&lt; <span class="stringliteral">"char*"</span>;
00351       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( isInt )
00352         oDataSet_h &lt;&lt; <span class="stringliteral">"int"</span>;
00353       <span class="keywordflow">else</span>
00354             oDataSet_h &lt;&lt; <span class="stringliteral">"spk_ValueType"</span>;
00355           oDataSet_h &lt;&lt; <span class="stringliteral">"&gt; "</span>;
00356       oDataSet_h &lt;&lt; vector_name;
00357       oDataSet_h &lt;&lt; <span class="stringliteral">"( "</span> &lt;&lt; nRecords &lt;&lt; <span class="stringliteral">" );"</span> &lt;&lt; endl;
00358       oDataSet_h &lt;&lt; <span class="stringliteral">"   copy( "</span> &lt;&lt; carray_name &lt;&lt; <span class="stringliteral">", "</span> &lt;&lt; carray_name &lt;&lt; <span class="stringliteral">"+"</span> &lt;&lt; nRecords;
00359       oDataSet_h &lt;&lt; <span class="stringliteral">", "</span> &lt;&lt; vector_name &lt;&lt; <span class="stringliteral">".begin() );"</span> &lt;&lt; endl;
00360     }
00361 
00362       <span class="comment">//</span>
00363       <span class="comment">// Create an IndData object.  The order in which the arguments</span>
00364       <span class="comment">// are passed to the IndData constructor must be strictly</span>
00365       <span class="comment">// compliant to the order in which the label strings are stored</span>
00366       <span class="comment">// in the list returned by SymbolTable::getLabels().</span>
00367       <span class="comment">//</span>
00368       oDataSet_h &lt;&lt; <span class="stringliteral">"   data["</span> &lt;&lt; who &lt;&lt; <span class="stringliteral">"] = new IndData&lt;spk_ValueType&gt;"</span>;
00369       oDataSet_h &lt;&lt; <span class="stringliteral">"( "</span> &lt;&lt; nRecords &lt;&lt; <span class="stringliteral">", "</span>;
00370       pLabel = labels-&gt;begin();
00371       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; pLabel != labels-&gt;end(), i&lt;nLabels; i++, pLabel++ )
00372     {
00373       <span class="keywordflow">if</span>( i&gt;0 )
00374         oDataSet_h &lt;&lt; <span class="stringliteral">", "</span>;
00375       <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a> * s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( *pLabel );
00376       string array_name = s-&gt;<a class="code" href="classSymbol.html#o0">name</a> + <span class="stringliteral">"_"</span> + c_who;
00377       oDataSet_h &lt;&lt; array_name;
00378     }
00379 
00380       oDataSet_h &lt;&lt; <span class="stringliteral">" );"</span> &lt;&lt; endl;
00381       oDataSet_h &lt;&lt; endl; 
00382     }
00383   oDataSet_h &lt;&lt; endl;
00384 
00385   <span class="comment">// </span>
00386   <span class="comment">// Extracts measurements (ie. SPK's y) from the entire data set and keep it in "measurements".</span>
00387   <span class="comment">//</span>
00388   oDataSet_h &lt;&lt; <span class="stringliteral">"   int nRecords = 0;"</span> &lt;&lt; endl;
00389   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;popSize; i++ )"</span> &lt;&lt; endl;
00390   oDataSet_h &lt;&lt; <span class="stringliteral">"      nRecords += data[i]-&gt;getNRecords();"</span> &lt;&lt; endl;
00391   oDataSet_h &lt;&lt; <span class="stringliteral">"   "</span> &lt;&lt; endl;
00392   oDataSet_h &lt;&lt; <span class="stringliteral">"   int nY = 0;  // # of DVs"</span> &lt;&lt; endl;
00393   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;popSize; i++ )"</span> &lt;&lt; endl;
00394   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00395   oDataSet_h &lt;&lt; <span class="stringliteral">"      NObservs[i] = data[i]-&gt;getMeasurements().size();"</span> &lt;&lt; endl;
00396   oDataSet_h &lt;&lt; <span class="stringliteral">"      nY += NObservs[i];"</span> &lt;&lt; endl;  
00397   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00398   oDataSet_h &lt;&lt; <span class="stringliteral">"   measurements.resize( nY ); "</span> &lt;&lt; endl;
00399   oDataSet_h &lt;&lt; <span class="stringliteral">"   jPrimeToj.resize( nY );"</span> &lt;&lt; endl;
00400   oDataSet_h &lt;&lt; <span class="stringliteral">"   jTojPrime.resize( nRecords );"</span> &lt;&lt; endl;
00401   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, m=0, j=0, jPrime=0; i&lt;popSize; i++ )"</span> &lt;&lt; endl;
00402   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00403   oDataSet_h &lt;&lt; <span class="stringliteral">"      int nYi = data[i]-&gt;getMeasurements().size();"</span> &lt;&lt; endl;
00404   oDataSet_h &lt;&lt; <span class="stringliteral">"      measurements[ SPK_VA::slice( m, nYi, 1 ) ] = data[i]-&gt;getMeasurements();"</span> &lt;&lt; endl;
00405   oDataSet_h &lt;&lt; <span class="stringliteral">"      m+=nYi;"</span> &lt;&lt; endl;
00406   oDataSet_h &lt;&lt; <span class="stringliteral">"      int n = data[i]-&gt;getNRecords();"</span> &lt;&lt; endl;
00407   oDataSet_h &lt;&lt; <span class="stringliteral">"      for( int k=0; k&lt;n; k++, j++ )"</span> &lt;&lt; endl;
00408   oDataSet_h &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00409   oDataSet_h &lt;&lt; <span class="stringliteral">"         if( data[i]-&gt;"</span> &lt;&lt; nonmem::MDV &lt;&lt; <span class="stringliteral">"[k] == 0 )"</span> &lt;&lt; endl;
00410   oDataSet_h &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00411   oDataSet_h &lt;&lt; <span class="stringliteral">"            jPrimeToj[jPrime] = j;"</span> &lt;&lt; endl;
00412   oDataSet_h &lt;&lt; <span class="stringliteral">"            jTojPrime[j] = jPrime;"</span> &lt;&lt; endl;
00413   oDataSet_h &lt;&lt; <span class="stringliteral">"            jPrime++;"</span> &lt;&lt; endl;
00414   oDataSet_h &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00415   oDataSet_h &lt;&lt; <span class="stringliteral">"         else"</span> &lt;&lt; endl;
00416   oDataSet_h &lt;&lt; <span class="stringliteral">"            jTojPrime[j] = -1;"</span> &lt;&lt; endl;
00417   oDataSet_h &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
00418   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00419 
00420   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00421   oDataSet_h &lt;&lt; endl;
00422 
00423   <span class="comment">// ----------</span>
00424   <span class="comment">// Destructor</span>
00425   <span class="comment">// ----------</span>
00426   <span class="comment">// Free the memory allocated for the data set.</span>
00427   <span class="comment">//</span>
00428   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00429   oDataSet_h &lt;&lt; <span class="stringliteral">"DataSet&lt;spk_ValueType&gt;::~DataSet()"</span> &lt;&lt; endl;
00430   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00431   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nPop = data.size();"</span> &lt;&lt; endl;
00432   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;nPop; i++ )"</span> &lt;&lt; endl;
00433   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00434   oDataSet_h &lt;&lt; <span class="stringliteral">"      delete data[i];"</span> &lt;&lt; endl;
00435   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00436   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00437   oDataSet_h &lt;&lt; endl;
00438 
00439   <span class="comment">// ----------------</span>
00440   <span class="comment">// Copy constructor</span>
00441   <span class="comment">// (protected)</span>
00442   <span class="comment">// ----------------</span>
00443   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00444   oDataSet_h &lt;&lt; <span class="stringliteral">"DataSet&lt;spk_ValueType&gt;::DataSet( const DataSet&lt;spk_ValueType&gt;&amp; )"</span> &lt;&lt; endl;
00445   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00446   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00447   oDataSet_h &lt;&lt; endl;
00448 
00449   <span class="comment">// -------------------</span>
00450   <span class="comment">// Assignment operator</span>
00451   <span class="comment">// (protected)</span>
00452   <span class="comment">// -------------------</span>
00453   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00454   oDataSet_h &lt;&lt; <span class="stringliteral">"DataSet&lt;spk_ValueType&gt;&amp; DataSet&lt;spk_ValueType&gt;::operator=( const DataSet&lt;spk_ValueType&gt;&amp; )"</span> &lt;&lt; endl;
00455   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00456   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00457   oDataSet_h &lt;&lt; endl;
00458 
00459   <span class="comment">// ------------------------------</span>
00460   <span class="comment">// getMeasurementIndex( int j )</span>
00461   <span class="comment">// This returns the index to an observation record that corresponds to the record index within the whole population.</span>
00462   <span class="comment">// ------------------------------</span>
00463   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00464   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getMeasurementIndex( int recordIndex ) const"</span> &lt;&lt; endl;
00465   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00466   oDataSet_h &lt;&lt; <span class="stringliteral">"   return jTojPrime[ recordIndex ];"</span> &lt;&lt; endl;
00467   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00468 
00469   <span class="comment">// ------------------------------</span>
00470   <span class="comment">// getMeasurementIndex( int i, int j )</span>
00471   <span class="comment">// This returns the index to an observation record that corresponds to the i-th individual's record index.</span>
00472   <span class="comment">// ------------------------------</span>
00473   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00474   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getMeasurementIndex( int who, int recordIndex ) const"</span> &lt;&lt; endl;
00475   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00476   oDataSet_h &lt;&lt; <span class="stringliteral">"   return data[who]-&gt;getMeasurementIndex(recordIndex);"</span> &lt;&lt; endl;
00477   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00478 
00479   <span class="comment">// ------------------------------</span>
00480   <span class="comment">// getRecordIndex( int i, int jPrime )</span>
00481   <span class="comment">// This returns the index to a record that corresponds to the measurement index within the whole population.</span>
00482   <span class="comment">// ------------------------------</span>
00483   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00484   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getRecordIndex( int measurementIndex ) const"</span> &lt;&lt; endl;
00485   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00486   oDataSet_h &lt;&lt; <span class="stringliteral">"   return jPrimeToj[ measurementIndex ];"</span> &lt;&lt; endl;
00487   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00488 
00489   <span class="comment">// ------------------------------</span>
00490   <span class="comment">// getRecordIndex( int i, int jPrime )</span>
00491   <span class="comment">// This returns the index to a record that corresponds to the i-th individual's measurement index.</span>
00492   <span class="comment">// ------------------------------</span>
00493   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00494   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getRecordIndex( int who, int measurementIndex ) const"</span> &lt;&lt; endl;
00495   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00496   <span class="comment">/*</span>
00497 <span class="comment">  oDataSet_h &lt;&lt; "   return jPrimeToj[ measurementIndex ];" &lt;&lt; endl;</span>
00498 <span class="comment">  */</span>
00499   oDataSet_h &lt;&lt; <span class="stringliteral">"   return data[who]-&gt;getRecordIndex(measurementIndex);"</span> &lt;&lt; endl;
00500   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00501 
00502   <span class="comment">// --------------------</span>
00503   <span class="comment">// getAllMeasurements()</span>
00504   <span class="comment">// --------------------</span>
00505   <span class="comment">// Returns SPK's y.</span>
00506   <span class="comment">//</span>
00507   oDataSet_h &lt;&lt; <span class="stringliteral">"// Returns SPK's y."</span> &lt;&lt; endl;
00508   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00509   oDataSet_h &lt;&lt; <span class="stringliteral">"const SPK_VA::valarray&lt;double&gt; DataSet&lt;spk_ValueType&gt;::getAllMeasurements() const"</span> &lt;&lt; endl;
00510   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00511   oDataSet_h &lt;&lt; <span class="stringliteral">"   return measurements;"</span> &lt;&lt; endl;
00512   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00513   oDataSet_h &lt;&lt; endl;
00514 
00515 
00516   <span class="comment">//----------------------------------------------------------</span>
00517   <span class="comment">// expand( const valarray&amp; measurements, valarray&amp; records )</span>
00518   <span class="comment">// ----------------------------------------------------------</span>
00519   oDataSet_h &lt;&lt; <span class="stringliteral">"// Sets the record values that have measurement values for all of the individuals."</span> &lt;&lt; endl;
00520   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00521   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::expand( "</span> &lt;&lt; endl;
00522   oDataSet_h &lt;&lt; <span class="stringliteral">"       const SPK_VA::valarray&lt;double&gt; &amp; measurements,"</span> &lt;&lt; endl;  
00523   oDataSet_h &lt;&lt; <span class="stringliteral">"       SPK_VA::valarray&lt;double&gt; &amp; records ) const"</span> &lt;&lt; endl;
00524   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00525   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = NObservs.sum();"</span> &lt;&lt; endl;
00526   oDataSet_h &lt;&lt; <span class="stringliteral">"   int m = 0;"</span> &lt;&lt; endl;
00527   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;popSize; i++ )"</span> &lt;&lt; endl;
00528   oDataSet_h &lt;&lt; <span class="stringliteral">"      m += getNRecords(i);"</span> &lt;&lt; endl;
00529   oDataSet_h &lt;&lt; <span class="stringliteral">"   records.resize( m );"</span> &lt;&lt; endl;
00530   oDataSet_h &lt;&lt; <span class="stringliteral">"   double zero = 0.0;"</span> &lt;&lt; endl;
00531   oDataSet_h &lt;&lt; <span class="stringliteral">"   double notANumber = zero / zero;"</span> &lt;&lt; endl;
00532   oDataSet_h &lt;&lt; <span class="stringliteral">"   records = notANumber;  // This indicates undefined values."</span> &lt;&lt; endl;
00533   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00534   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00535   oDataSet_h &lt;&lt; <span class="stringliteral">"      records[ getRecordIndex( i ) ] = measurements[i];"</span> &lt;&lt; endl;
00536   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00537   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00538                                                                                 
00539   <span class="comment">//----------------------------------------------------------</span>
00540   <span class="comment">// expand( int who, const valarray&amp; measurements_who, valarray&amp; records_who )</span>
00541   <span class="comment">// ----------------------------------------------------------</span>
00542   oDataSet_h &lt;&lt; <span class="stringliteral">"// Sets the record values that have measurement values for the who-th individual."</span> &lt;&lt; endl;
00543   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00544   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::expand( "</span> &lt;&lt; endl;
00545   oDataSet_h &lt;&lt; <span class="stringliteral">"       int who,"</span> &lt;&lt; endl;
00546   oDataSet_h &lt;&lt; <span class="stringliteral">"       const SPK_VA::valarray&lt;double&gt;&amp; measurements_who,"</span> &lt;&lt; endl;
00547   oDataSet_h &lt;&lt; <span class="stringliteral">"       SPK_VA::valarray&lt;double&gt;&amp; records_who ) const"</span> &lt;&lt; endl;
00548   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00549   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = measurements_who.size();"</span> &lt;&lt; endl;
00550   oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( n == NObservs[who] );"</span> &lt;&lt; endl;
00551   oDataSet_h &lt;&lt; <span class="stringliteral">"   int m = getNRecords(who);"</span> &lt;&lt; endl;
00552   oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( m &gt;= n );"</span> &lt;&lt; endl;
00553   oDataSet_h &lt;&lt; <span class="stringliteral">"   records_who.resize( m );"</span> &lt;&lt; endl;
00554   oDataSet_h &lt;&lt; <span class="stringliteral">"   double zero = 0.0;"</span> &lt;&lt; endl;
00555   oDataSet_h &lt;&lt; <span class="stringliteral">"   double notANumber = zero / zero;"</span> &lt;&lt; endl;
00556   oDataSet_h &lt;&lt; <span class="stringliteral">"   records_who = notANumber;  // This indicates undefined values."</span> &lt;&lt; endl;
00557   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00558   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00559   oDataSet_h &lt;&lt; <span class="stringliteral">"      records_who[ getRecordIndex( who, i ) ] = measurements_who[i];"</span> &lt;&lt; endl;
00560   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00561   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00562                                                                                 
00563   <span class="comment">//------------</span>
00564   <span class="comment">// getPopSize()</span>
00565   <span class="comment">// ------------</span>
00566   <span class="comment">// Return the size of population.</span>
00567   <span class="comment">//</span>
00568   oDataSet_h &lt;&lt; <span class="stringliteral">"// Returns the population size."</span> &lt;&lt; endl;
00569   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00570   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getPopSize() const"</span> &lt;&lt; endl;
00571   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00572   oDataSet_h &lt;&lt; <span class="stringliteral">"   return popSize;"</span> &lt;&lt; endl;
00573   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00574   oDataSet_h &lt;&lt; endl;
00575 
00576   <span class="comment">// ------</span>
00577   <span class="comment">// getN()</span>
00578   <span class="comment">// ------</span>
00579   <span class="comment">// Return SPK's N (ie. N[i] is the number of measurements of the i-th individual.</span>
00580   <span class="comment">//</span>
00581   oDataSet_h &lt;&lt; <span class="stringliteral">"// Return SPK's N (ie. N[i] is the number of measurements of the i-th individual."</span> &lt;&lt; endl;
00582   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00583   oDataSet_h &lt;&lt; <span class="stringliteral">"const SPK_VA::valarray&lt;int&gt; DataSet&lt;spk_ValueType&gt;::getN() const"</span> &lt;&lt; endl;
00584   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00585   oDataSet_h &lt;&lt; <span class="stringliteral">"   return NObservs;"</span> &lt;&lt; endl;
00586   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00587   oDataSet_h &lt;&lt; endl;
00588 
00589   <span class="comment">// -------------</span>
00590   <span class="comment">// getNObservs()</span>
00591   <span class="comment">// Return the number of observation records for the entire population.</span>
00592   <span class="comment">// -------------</span>
00593   oDataSet_h &lt;&lt; <span class="stringliteral">"// Return the number of measurements (DVs) for the entire population."</span> &lt;&lt; endl;
00594   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00595   oDataSet_h &lt;&lt; <span class="stringliteral">"const SPK_VA::valarray&lt;int&gt; DataSet&lt;spk_ValueType&gt;::getNObservs() const"</span> &lt;&lt; endl;
00596   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00597   oDataSet_h &lt;&lt; <span class="stringliteral">"   return NObservs;"</span> &lt;&lt; endl;
00598   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00599 
00600   <span class="comment">// -------------</span>
00601   <span class="comment">// getNObservs(i)</span>
00602   <span class="comment">// Return the i-th individual's number of observation records.</span>
00603   <span class="comment">// -------------</span>
00604   oDataSet_h &lt;&lt; <span class="stringliteral">"// Return the number of measurements (DVs) of the i-th individual."</span> &lt;&lt; endl;
00605   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00606   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getNObservs( int i ) const"</span> &lt;&lt; endl;
00607   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00608   oDataSet_h &lt;&lt; <span class="stringliteral">"   return data[i]-&gt;getNObservs();"</span> &lt;&lt; endl;
00609   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00610 
00611   <span class="comment">// -------------</span>
00612   <span class="comment">// getNRecords()</span>
00613   <span class="comment">// Return the number of total records for the entire population.</span>
00614   <span class="comment">// -------------</span>
00615   oDataSet_h &lt;&lt; <span class="stringliteral">"// Return the number of data records (including MDV=1) for the entire population."</span> &lt;&lt; endl;
00616   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00617   oDataSet_h &lt;&lt; <span class="stringliteral">"const SPK_VA::valarray&lt;int&gt; DataSet&lt;spk_ValueType&gt;::getNRecords() const"</span> &lt;&lt; endl;
00618   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00619   oDataSet_h &lt;&lt; <span class="stringliteral">"   return NRecords;"</span> &lt;&lt; endl;
00620   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00621 
00622   <span class="comment">// -------------</span>
00623   <span class="comment">// getNRecords(i)</span>
00624   <span class="comment">// Return the i-th individual's number of total records.</span>
00625   <span class="comment">// -------------</span>
00626   oDataSet_h &lt;&lt; <span class="stringliteral">"// Return the number of data records (including MDV=1) of the i-th individual."</span> &lt;&lt; endl;
00627   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00628   oDataSet_h &lt;&lt; <span class="stringliteral">"int DataSet&lt;spk_ValueType&gt;::getNRecords( int i ) const"</span> &lt;&lt; endl;
00629   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00630   oDataSet_h &lt;&lt; <span class="stringliteral">"   return data[i]-&gt;getNRecords();"</span> &lt;&lt; endl;
00631   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00632 
00633   <span class="comment">// ------------------------</span>
00634   <span class="comment">// replaceAllMeasurements()</span>
00635   <span class="comment">// ------------------------</span>
00636   <span class="comment">// Replace the currently kept y with the given y'.</span>
00637   <span class="comment">//</span>
00638   oDataSet_h &lt;&lt; <span class="stringliteral">"// Replace the currently kept y with the given y'."</span> &lt;&lt; endl;
00639   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00640   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceAllMeasurements( const SPK_VA::valarray&lt;double&gt; &amp; yy )"</span> &lt;&lt; endl;
00641   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00642   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n= data.size();"</span> &lt;&lt; endl;
00643   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00644   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00645   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceMeasurements( yy[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00646   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00647   oDataSet_h &lt;&lt; <span class="stringliteral">"   measurements = yy;"</span> &lt;&lt; endl;
00648   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00649   oDataSet_h &lt;&lt; endl;
00650 
00651 
00652   <span class="comment">// ------------------------</span>
00653   <span class="comment">// replacePred()</span>
00654   <span class="comment">// ------------------------</span>
00655   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00656   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePred( const SPK_VA::valarray&lt;double&gt;&amp; PredIn )"</span>     &lt;&lt; endl;
00657   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00658   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00659   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00660   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00661   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePred( PredIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00662   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00663   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00664   oDataSet_h &lt;&lt; endl;
00665 
00666   <span class="comment">// ------------------------</span>
00667   <span class="comment">// replaceRes()</span>
00668   <span class="comment">// ------------------------</span>
00669   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00670   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceRes( const SPK_VA::valarray&lt;double&gt;&amp; ResIn )"</span>     &lt;&lt; endl;
00671   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00672   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00673   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00674   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00675   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceRes( ResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00676   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00677   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00678   oDataSet_h &lt;&lt; endl;
00679 
00680   <span class="comment">// ------------------------</span>
00681   <span class="comment">// replaceWRes()</span>
00682   <span class="comment">// ------------------------</span>
00683   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00684   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceWRes( const SPK_VA::valarray&lt;double&gt;&amp; WResIn )"</span>    &lt;&lt; endl;
00685   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00686   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00687   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00688   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00689   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceWRes( WResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00690   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00691   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00692   oDataSet_h &lt;&lt; endl;
00693 
00694   <span class="comment">// ------------------------</span>
00695   <span class="comment">// replaceIPred()</span>
00696   <span class="comment">// ------------------------</span>
00697   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00698   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceIPred( const SPK_VA::valarray&lt;double&gt;&amp; iPredIn )"</span>     &lt;&lt; endl;
00699   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00700   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00701   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00702   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00703   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceIPred( iPredIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00704   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00705   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00706   oDataSet_h &lt;&lt; endl;
00707 
00708   <span class="comment">// ------------------------</span>
00709   <span class="comment">// replaceIRes()</span>
00710   <span class="comment">// ------------------------</span>
00711   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00712   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceIRes( const SPK_VA::valarray&lt;double&gt;&amp; iResIn )"</span>     &lt;&lt; endl;
00713   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00714   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00715   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00716   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00717   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceIRes( iResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00718   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00719   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00720   oDataSet_h &lt;&lt; endl;
00721 
00722   <span class="comment">// ------------------------</span>
00723   <span class="comment">// replaceIWRes()</span>
00724   <span class="comment">// ------------------------</span>
00725   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00726   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceIWRes( const SPK_VA::valarray&lt;double&gt;&amp; iWResIn )"</span>    &lt;&lt; endl;
00727   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00728   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00729   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00730   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00731   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceIWRes( iWResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00732   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00733   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00734   oDataSet_h &lt;&lt; endl;
00735 
00736   <span class="comment">// ------------------------</span>
00737   <span class="comment">// replacePPred()</span>
00738   <span class="comment">// ------------------------</span>
00739   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00740   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePPred( const SPK_VA::valarray&lt;double&gt;&amp; pPredIn )"</span>     &lt;&lt; endl;
00741   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00742   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00743   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00744   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00745   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePPred( pPredIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00746   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00747   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00748   oDataSet_h &lt;&lt; endl;
00749 
00750   <span class="comment">// ------------------------</span>
00751   <span class="comment">// replacePRes()</span>
00752   <span class="comment">// ------------------------</span>
00753   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00754   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePRes( const SPK_VA::valarray&lt;double&gt;&amp; pResIn )"</span>     &lt;&lt; endl;
00755   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00756   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00757   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00758   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00759   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePRes( pResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00760   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00761   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00762   oDataSet_h &lt;&lt; endl;
00763 
00764   <span class="comment">// ------------------------</span>
00765   <span class="comment">// replacePWRes()</span>
00766   <span class="comment">// ------------------------</span>
00767   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00768   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePWRes( const SPK_VA::valarray&lt;double&gt;&amp; pWResIn )"</span>    &lt;&lt; endl;
00769   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00770   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00771   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00772   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00773   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePWRes( pWResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00774   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00775   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00776   oDataSet_h &lt;&lt; endl;
00777 
00778   <span class="comment">// ------------------------</span>
00779   <span class="comment">// replaceCPred()</span>
00780   <span class="comment">// ------------------------</span>
00781   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00782   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceCPred( const SPK_VA::valarray&lt;double&gt;&amp; cPredIn )"</span>     &lt;&lt; endl;
00783   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00784   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00785   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00786   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00787   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceCPred( cPredIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00788   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00789   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00790   oDataSet_h &lt;&lt; endl;
00791 
00792   <span class="comment">// ------------------------</span>
00793   <span class="comment">// replaceCRes()</span>
00794   <span class="comment">// ------------------------</span>
00795   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00796   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceCRes( const SPK_VA::valarray&lt;double&gt;&amp; cResIn )"</span>     &lt;&lt; endl;
00797   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00798   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00799   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00800   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00801   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceCRes( cResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00802   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00803   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00804   oDataSet_h &lt;&lt; endl;
00805 
00806   <span class="comment">// ------------------------</span>
00807   <span class="comment">// replaceCWRes()</span>
00808   <span class="comment">// ------------------------</span>
00809   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00810   oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceCWRes( const SPK_VA::valarray&lt;double&gt;&amp; cWResIn )"</span>    &lt;&lt; endl;
00811   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00812   oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00813   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, k=0; i&lt;n; k+=NRecords[i++] )"</span> &lt;&lt; endl;
00814   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00815   oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceCWRes( cWResIn[ SPK_VA::slice(k, NRecords[i], 1) ] );"</span> &lt;&lt; endl;
00816   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00817   oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00818   oDataSet_h &lt;&lt; endl;
00819 
00820   <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a13">getTarget</a>() == POP )
00821     {
00822       <span class="comment">// ------------------------</span>
00823       <span class="comment">// replaceEta()</span>
00824       <span class="comment">// ------------------------</span>
00825       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00826       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceEta( const SPK_VA::valarray&lt;double&gt;&amp; etaIn )"</span>  &lt;&lt; endl;
00827       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00828       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00829       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00830       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( etaIn.size() == n * nEta );"</span> &lt;&lt; endl;
00831       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00832       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00833       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceEta( etaIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00834       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00835       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00836       oDataSet_h &lt;&lt; endl;
00837 
00838       <span class="comment">// ------------------------</span>
00839       <span class="comment">// replaceEtaRes()</span>
00840       <span class="comment">// ------------------------</span>
00841       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00842       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; EtaResIn )"</span>  &lt;&lt; endl;
00843       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00844       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00845       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00846       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( EtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00847       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00848       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00849       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceEtaRes( EtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00850       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00851       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00852       oDataSet_h &lt;&lt; endl;
00853 
00854       <span class="comment">// ------------------------</span>
00855       <span class="comment">// replaceWEtaRes()</span>
00856       <span class="comment">// ------------------------</span>
00857       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00858       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; WEtaResIn )"</span> &lt;&lt; endl;
00859       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00860       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00861       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00862       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( WEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00863       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00864       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00865       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceWEtaRes( WEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00866       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00867       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00868       oDataSet_h &lt;&lt; endl;
00869 
00870       <span class="comment">// ------------------------</span>
00871       <span class="comment">// replaceIEtaRes()</span>
00872       <span class="comment">// ------------------------</span>
00873       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00874       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceIEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; iEtaResIn )"</span>  &lt;&lt; endl;
00875       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00876       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00877       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00878       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( iEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00879       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00880       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00881       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceIEtaRes( iEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00882       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00883       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00884       oDataSet_h &lt;&lt; endl;
00885 
00886       <span class="comment">// ------------------------</span>
00887       <span class="comment">// replaceIWEtaRes()</span>
00888       <span class="comment">// ------------------------</span>
00889       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00890       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceIWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; iWEtaResIn )"</span> &lt;&lt; endl;
00891       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00892       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00893       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00894       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( iWEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00895       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00896       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00897       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceIWEtaRes( iWEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00898       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00899       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00900       oDataSet_h &lt;&lt; endl;
00901 
00902       <span class="comment">// ------------------------</span>
00903       <span class="comment">// replacePEtaRes()</span>
00904       <span class="comment">// ------------------------</span>
00905       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00906       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; pEtaResIn )"</span>  &lt;&lt; endl;
00907       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00908       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00909       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00910       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( pEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00911       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00912       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00913       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePEtaRes( pEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00914       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00915       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00916       oDataSet_h &lt;&lt; endl;
00917 
00918       <span class="comment">// ------------------------</span>
00919       <span class="comment">// replacePWEtaRes()</span>
00920       <span class="comment">// ------------------------</span>
00921       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00922       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replacePWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; pWEtaResIn )"</span> &lt;&lt; endl;
00923       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00924       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00925       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00926       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( pWEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00927       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00928       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00929       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replacePWEtaRes( pWEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00930       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00931       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00932       oDataSet_h &lt;&lt; endl;
00933 
00934       <span class="comment">// ------------------------</span>
00935       <span class="comment">// replaceCEtaRes()</span>
00936       <span class="comment">// ------------------------</span>
00937       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00938       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceCEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; cEtaResIn )"</span>  &lt;&lt; endl;
00939       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00940       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00941       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00942       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( cEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00943       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00944       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00945       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceCEtaRes( cEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00946       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00947       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00948       oDataSet_h &lt;&lt; endl;
00949 
00950       <span class="comment">// ------------------------</span>
00951       <span class="comment">// replaceCWEtaRes()</span>
00952       <span class="comment">// ------------------------</span>
00953       oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00954       oDataSet_h &lt;&lt; <span class="stringliteral">"void DataSet&lt;spk_ValueType&gt;::replaceCWEtaRes( const SPK_VA::valarray&lt;double&gt;&amp; cWEtaResIn )"</span> &lt;&lt; endl;
00955       oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00956       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int n = data.size();"</span> &lt;&lt; endl;
00957       oDataSet_h &lt;&lt; <span class="stringliteral">"   const int nEta = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> &lt;&lt; <span class="stringliteral">"; // the length of eta"</span> &lt;&lt; endl;
00958       oDataSet_h &lt;&lt; <span class="stringliteral">"   assert( cWEtaResIn.size() == n * nEta );"</span> &lt;&lt; endl;
00959       oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
00960       oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
00961       oDataSet_h &lt;&lt; <span class="stringliteral">"      data[i]-&gt;replaceCWEtaRes( cWEtaResIn[ SPK_VA::slice(i*nEta, nEta, 1) ] );"</span> &lt;&lt; endl;
00962       oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
00963       oDataSet_h &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
00964       oDataSet_h &lt;&lt; endl;
00965     }
00966 
00967   <span class="comment">// ---------</span>
00968   <span class="comment">// Extractor</span>
00969   <span class="comment">// ---------</span>
00970   oDataSet_h &lt;&lt; <span class="stringliteral">"// Extracts the contents of this class object in the SpkResultML::presentation_data form."</span> &lt;&lt; endl;
00971   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
00972   oDataSet_h &lt;&lt; <span class="stringliteral">"std::ostream&amp; operator&lt;&lt;( std::ostream&amp; o, const DataSet&lt;spk_ValueType&gt;&amp; A )"</span> &lt;&lt; endl;
00973   oDataSet_h &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00974   oDataSet_h &lt;&lt; <span class="stringliteral">"   using std::endl;"</span> &lt;&lt; endl;
00975 
00976   <span class="comment">// Compute the number of items that are supposed to be printed out in &lt;presentation_data&gt;.</span>
00977   <span class="comment">// This includes User defined scalar variables, NONMEM (scalar/vector/matrix)</span>
00978   <span class="comment">// and RES/WRES.</span>
00979   <span class="comment">// </span>
00980   <span class="comment">// THETA/ETA/OMEGA/(EPS)/(SIGMA) are vectors or matrices.</span>
00981   <span class="comment">// &lt;presentation_data&gt; prints out elements of these objects one by one.</span>
00982   <span class="comment">// That is, if THETA had a length of 2, it prints out THETA(1) and THETA(2) individually.</span>
00983   <span class="comment">// The names such as "THETA" is already in the symbol table, so when we get the size of</span>
00984   <span class="comment">// SymbolTable object, it returns the number that already contains the count for "THETA".</span>
00985   <span class="comment">// So, we increment the country by (2-1)=1. </span>
00986   <span class="keyword">const</span> <span class="keywordtype">int</span> nItems = t-&gt;size();
00987   <span class="keywordtype">int</span> nColumns = nItems
00988     + <a class="code" href="classNonmemTranslator.html#r19">myThetaLen</a>-1
00989     + <a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a>-1 
00990     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r29">myEpsLen</a> - 1) : 0 ) <span class="comment">// for EPS</span>
00991     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for ETARES</span>
00992     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for WETARES</span>
00993     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for IETARES</span>
00994     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for IWETARES</span>
00995     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for PETARES</span>
00996     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for PWETARES</span>
00997     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for CETARES</span>
00998     + (<a class="code" href="classClientTranslator.html#a13">getTarget</a>()==POP? (<a class="code" href="classNonmemTranslator.html#r28">myEtaLen</a> - 1) : 0 ) <span class="comment">// for CWETARES</span>
00999     - (<a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::OMEGA)   == <a class="code" href="classSymbol.html#e0">Symbol::empty</a>()? 0 : 1 )
01000     - (<a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::SIGMA)   == <a class="code" href="classSymbol.html#e0">Symbol::empty</a>()? 0 : 1 );
01001  
01002   <span class="keywordflow">if</span>( myCompModel )
01003     {
01004       <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a>* s;
01005       <span class="keywordflow">if</span>( ( s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( nonmem::DADT ) ) != <a class="code" href="classSymbol.html#e0">Symbol::empty</a>() )
01006     {
01007       <span class="keywordflow">if</span>( s-&gt;object_type == Symbol::VECTOR )
01008         nColumns += <a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a4">getNCompartments</a>()-1;
01009     }
01010       <span class="keywordflow">if</span>( ( s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( nonmem::A ) ) != <a class="code" href="classSymbol.html#e0">Symbol::empty</a>() )
01011     {
01012       <span class="keywordflow">if</span>( s-&gt;object_type == Symbol::VECTOR )
01013         nColumns += <a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a4">getNCompartments</a>()-1;
01014     }
01015       <span class="keywordflow">if</span>( ( s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( nonmem::P ) ) != <a class="code" href="classSymbol.html#e0">Symbol::empty</a>() )
01016     {
01017       <span class="keywordflow">if</span>( s-&gt;object_type == Symbol::VECTOR )
01018         nColumns += <a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a5">getNParameters</a>()-1;
01019     }
01020       <span class="keywordflow">if</span>( ( s = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>( nonmem::T ) ) != <a class="code" href="classSymbol.html#e0">Symbol::empty</a>() )
01021     {
01022       nColumns--;
01023     }
01024     }
01025 
01026   map&lt;const string, Symbol&gt;::const_iterator pEntry = t-&gt;begin();
01027   <span class="keyword">const</span> vector&lt;string&gt;::const_iterator pLabelBegin = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a7">getLabels</a>()-&gt;begin();
01028   <span class="keyword">const</span> vector&lt;string&gt;::const_iterator pLabelEnd   = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a7">getLabels</a>()-&gt;end();
01029   vector&lt;string&gt; whatGoesIn;  <span class="comment">// will hold those labels in the order that actually go into the data section.</span>
01030   vector&lt;string&gt;::const_iterator pWhatGoesIn;
01031 
01032   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
01033   <span class="comment">// Open &lt;presentation_data&gt;</span>
01034   <span class="comment">//</span>
01035   oDataSet_h &lt;&lt; <span class="stringliteral">"   o &lt;&lt; \"&lt;\" &lt;&lt; \"presentation_data\" &lt;&lt; \" rows=\\\"\" &lt;&lt; A.NRecords.sum() &lt;&lt; \"\\\" \";"</span> &lt;&lt; endl;
01036   oDataSet_h &lt;&lt; <span class="stringliteral">"   o &lt;&lt; \"columns=\\\""</span> &lt;&lt; nColumns &lt;&lt; <span class="stringliteral">"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01037 
01038   <span class="comment">//-----------------------------------------------------------------------------</span>
01039   <span class="comment">// Begin printing out labels.</span>
01040   <span class="comment">//</span>
01041 <span class="comment">//  oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;data_labels&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01042   
01043   <span class="comment">// Put ID first in the sequence</span>
01044   whatGoesIn.push_back( pID-&gt;<a class="code" href="classSymbol.html#o0">name</a> );
01045 <span class="comment">//  oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"" &lt;&lt; pID-&gt;name &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01046   oDataSet_h &lt;&lt; <span class="stringliteral">"   o &lt;&lt; \"ID"</span>;
01047   
01048   <span class="comment">// ...aaand, following ID is, all the left hand side quantities in the model definition.</span>
01049   <span class="comment">// cntColumns is initialized to 1 because the ID column is already printed out.</span>
01050   <span class="keywordtype">int</span> cntColumns = 1;
01051   <span class="keywordflow">for</span>( cntColumns=1,  pEntry = t-&gt;begin(); pEntry!=t-&gt;end(); pEntry++ )
01052     {
01053       <span class="keywordflow">if</span>( pEntry-&gt;first != nonmem::ID )
01054     {
01055       <span class="comment">// Skip Omega and Sigma.</span>
01056           <span class="comment">// These values are not computed by Pred::eval().</span>
01057       <span class="keywordflow">if</span>(    pEntry-&gt;first != nonmem::OMEGA 
01058          &amp;&amp; pEntry-&gt;first != nonmem::SIGMA )
01059         {
01060           whatGoesIn.push_back( pEntry-&gt;second.name );
01061           
01062           <span class="comment">// theta: This is a vector.  So, all element values have to be printed out individually.</span>
01063           <span class="keywordflow">if</span>( pEntry-&gt;first == nonmem::THETA )
01064         {
01065           <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntTheta=0; cntTheta&lt;myThetaLen; cntTheta++ )
01066             {
01067                       oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01068 <span class="comment">//            oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01069               oDataSet_h &lt;&lt; pEntry-&gt;second.name &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; cntTheta+1 &lt;&lt; <span class="stringliteral">")"</span>;
01070 <span class="comment">//            oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01071               cntColumns++;
01072             }
01073         }
01074           <span class="comment">// eta, etares, wetares: These are vectors of length myEtaLen.</span>
01075               <span class="comment">// So, all elements values have to be printed out individually.</span>
01076           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pEntry-&gt;first == nonmem::ETA
01077                || pEntry-&gt;first == nonmem::ETARES 
01078                || pEntry-&gt;first == nonmem::WETARES
01079                || pEntry-&gt;first == nonmem::IETARES 
01080                || pEntry-&gt;first == nonmem::IWETARES
01081                || pEntry-&gt;first == nonmem::PETARES 
01082                || pEntry-&gt;first == nonmem::PWETARES
01083                || pEntry-&gt;first == nonmem::CETARES 
01084                || pEntry-&gt;first == nonmem::CWETARES )
01085         {
01086           <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntEta=0; cntEta&lt;myEtaLen; cntEta++ )
01087             {
01088                       oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01089 <span class="comment">//            oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01090               oDataSet_h &lt;&lt; pEntry-&gt;second.name &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; cntEta+1 &lt;&lt; <span class="stringliteral">")"</span>;
01091 <span class="comment">//            oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;              </span>
01092               cntColumns++;
01093             }
01094         }
01095           <span class="comment">// eps: This is a vector of length myEpsLen.</span>
01096               <span class="comment">// So, all elements values have to be printed out individually.</span>
01097           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pEntry-&gt;first == nonmem::EPS )
01098         {
01099           <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntEps=0; cntEps&lt;myEpsLen; cntEps++ )
01100             {
01101                       oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01102 <span class="comment">//            oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01103               oDataSet_h &lt;&lt; pEntry-&gt;second.name &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; cntEps+1 &lt;&lt; <span class="stringliteral">")"</span>;
01104 <span class="comment">//            oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01105               cntColumns++;
01106             }
01107         }
01108           <span class="comment">// DADT or A: This is a vector of length nCompartments</span>
01109           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (pEntry-&gt;first == nonmem::DADT || pEntry-&gt;first == nonmem::A )
01110                &amp;&amp; myCompModel ) 
01111         {
01112           <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cnt=0; cnt&lt;<a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a4">getNCompartments</a>(); cnt++ )
01113             {
01114                       oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01115 <span class="comment">//            oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01116               oDataSet_h &lt;&lt; pEntry-&gt;second.name &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; cnt+1 &lt;&lt; <span class="stringliteral">")"</span>;
01117 <span class="comment">//            oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;              </span>
01118               cntColumns++;
01119             }
01120         }
01121           <span class="comment">// P: This is a vector of length nParameters</span>
01122           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pEntry-&gt;first == nonmem::P &amp;&amp; myCompModel )
01123         {
01124           <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cnt=0; cnt&lt;<a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a5">getNParameters</a>(); cnt++ )
01125             {
01126                       oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01127 <span class="comment">//            oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01128               oDataSet_h &lt;&lt; pEntry-&gt;second.name &lt;&lt; <span class="stringliteral">"("</span> &lt;&lt; cnt+1 &lt;&lt; <span class="stringliteral">")"</span>;
01129 <span class="comment">//            oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;              </span>
01130               cntColumns++;
01131             }
01132         }
01133 
01134           <span class="comment">// T should be omitted from print out if it means the ODE's T.</span>
01135           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#r48">myCompModel</a> &amp;&amp; (pEntry-&gt;first == nonmem::T) ) 
01136         {
01137           <span class="comment">// ignore</span>
01138         }
01139 
01140           <span class="comment">// scalar variables (user-defined variables &amp; NONMEM reserved variables).</span>
01141           <span class="keywordflow">else</span>
01142         {
01143                   oDataSet_h &lt;&lt; <span class="stringliteral">","</span>;
01144 <span class="comment">//        oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;label name=\\\"";</span>
01145           oDataSet_h &lt;&lt; pEntry-&gt;second.name;
01146 <span class="comment">//        oDataSet_h &lt;&lt; "\\\"/&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01147           cntColumns++;
01148         }
01149         }
01150     }
01151     }
01152 
01153   <span class="comment">// Sanity check; is the actual number of labels (ie. columns) match the value given by the user earlier?</span>
01154 
01155   <span class="keywordflow">if</span>( cntColumns != nColumns )
01156     {
01157       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e3">SpkCompilerError::maxMessageLen</a>() ];
01158       snprintf( mess, 
01159         SpkCompilerError::maxMessageLen(),
01160         <span class="stringliteral">"The number of data items (%d) does not match the number of labels (%d)."</span>,
01161         cntColumns, nColumns );
01162       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( SpkCompilerError::ASPK_USER_ERR, mess, __LINE__, __FILE__ );
01163       <span class="keywordflow">throw</span> e;
01164     }
01165 
01166 <span class="comment">//  oDataSet_h &lt;&lt; "   o &lt;&lt; \"&lt;/data_labels&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01167   oDataSet_h &lt;&lt; <span class="stringliteral">"\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01168   <span class="comment">//</span>
01169   <span class="comment">// End of labels.</span>
01170   <span class="comment">//-----------------------------------------------------------------------------</span>
01171   
01172   <span class="comment">//-----------------------------------------------------------------------------</span>
01173   <span class="comment">// Begin printing out computed values.</span>
01174   <span class="comment">// </span>
01175   oDataSet_h &lt;&lt; <span class="stringliteral">"   for( int i=0, position=1; i&lt;A.getPopSize(); i++ )"</span> &lt;&lt; endl;
01176   oDataSet_h &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
01177   oDataSet_h &lt;&lt; <span class="stringliteral">"      for( int j=0; j&lt;A.NRecords[i]; j++, position++ )"</span> &lt;&lt; endl;
01178   oDataSet_h &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
01179 <span class="comment">//  oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;row position=\\\"\" &lt;&lt; position &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01180 
01181   <span class="keywordflow">for</span>( cntColumns=0, pWhatGoesIn = whatGoesIn.begin(); pWhatGoesIn!=whatGoesIn.end(); pWhatGoesIn++ )
01182     {
01183       <span class="keywordflow">if</span>( *pWhatGoesIn == nonmem::THETA )
01184     {
01185       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntTheta=0; cntTheta&lt;myThetaLen; cntTheta++ )
01186         {
01187               oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01188 <span class="comment">//        oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"";</span>
01189 <span class="comment">//        oDataSet_h &lt;&lt; *pWhatGoesIn &lt;&lt; "(" &lt;&lt; cntTheta+1 &lt;&lt; ")" &lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01190           oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]["</span> &lt;&lt; cntTheta &lt;&lt; <span class="stringliteral">"]"</span>;
01191 <span class="comment">//        oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01192           cntColumns++;
01193         }
01194     }
01195       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( *pWhatGoesIn == nonmem::ETA
01196            || *pWhatGoesIn == nonmem::ETARES
01197            || *pWhatGoesIn == nonmem::WETARES
01198            || *pWhatGoesIn == nonmem::IETARES
01199            || *pWhatGoesIn == nonmem::IWETARES
01200            || *pWhatGoesIn == nonmem::PETARES
01201            || *pWhatGoesIn == nonmem::PWETARES
01202            || *pWhatGoesIn == nonmem::CETARES
01203            || *pWhatGoesIn == nonmem::CWETARES )
01204     {
01205       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntEta=0; cntEta&lt;myEtaLen; cntEta++ )
01206         {
01207               oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01208 <span class="comment">//        oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"";</span>
01209 <span class="comment">//        oDataSet_h &lt;&lt; *pWhatGoesIn &lt;&lt; "(" &lt;&lt; cntEta+1 &lt;&lt; ")"&lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01210           oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]["</span> &lt;&lt; cntEta &lt;&lt; <span class="stringliteral">"]"</span>;
01211 <span class="comment">//        oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01212           cntColumns++;
01213         }
01214     }
01215       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( *pWhatGoesIn == nonmem::EPS &amp;&amp; <a class="code" href="classClientTranslator.html#a13">getTarget</a>() == POP )
01216     {
01217       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cntEps=0; cntEps&lt;myEpsLen; cntEps++ )
01218         {
01219               oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01220 <span class="comment">//        oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"";</span>
01221 <span class="comment">//        oDataSet_h &lt;&lt; *pWhatGoesIn &lt;&lt; "(" &lt;&lt; cntEps+1 &lt;&lt; ")"&lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01222           oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]["</span> &lt;&lt; cntEps &lt;&lt; <span class="stringliteral">"]"</span>;
01223 <span class="comment">//        oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01224           cntColumns++;
01225         }
01226     }
01227       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( *pWhatGoesIn == nonmem::OMEGA || *pWhatGoesIn == nonmem::SIGMA )
01228     {
01229       <span class="comment">// ignore</span>
01230     }
01231       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( *pWhatGoesIn == nonmem::DADT || *pWhatGoesIn == nonmem::A ) 
01232            &amp;&amp; myCompModel )
01233     {
01234       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cnt=0; cnt&lt;<a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a4">getNCompartments</a>(); cnt++ )
01235         {
01236               oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01237 <span class="comment">//        oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"";</span>
01238 <span class="comment">//        oDataSet_h &lt;&lt; *pWhatGoesIn &lt;&lt; "(" &lt;&lt; cnt+1 &lt;&lt; ")"&lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01239           oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]["</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">"]"</span>;
01240 <span class="comment">//        oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01241           cntColumns++;
01242         }
01243     }
01244       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( *pWhatGoesIn == nonmem::P &amp;&amp; myCompModel )
01245     {
01246       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cnt=0; cnt&lt;<a class="code" href="classNonmemTranslator.html#r48">myCompModel</a>-&gt;<a class="code" href="classCompModelInfo.html#a5">getNParameters</a>(); cnt++ )
01247         {
01248               oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01249 <span class="comment">//        oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"";</span>
01250 <span class="comment">//        oDataSet_h &lt;&lt; *pWhatGoesIn &lt;&lt; "(" &lt;&lt; cnt+1 &lt;&lt; ")"&lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01251           oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]["</span> &lt;&lt; cnt &lt;&lt; <span class="stringliteral">"]"</span>;
01252 <span class="comment">//        oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01253           cntColumns++;
01254         }
01255     }
01256       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#r48">myCompModel</a> &amp;&amp; (*pWhatGoesIn == nonmem::T) )
01257         {
01258           <span class="comment">// ignore</span>
01259         }
01260       <span class="keywordflow">else</span> 
01261     {
01262           string s(*pWhatGoesIn);
01263           <span class="keywordflow">if</span>(s.compare(0, 2, <span class="stringliteral">"ID"</span>) == 0) oDataSet_h &lt;&lt; <span class="stringliteral">"         o &lt;&lt; "</span>;
01264           <span class="keywordflow">else</span> oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; \",\" &lt;&lt; "</span>;
01265 <span class="comment">//    oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;value ref=\\\"" &lt;&lt; *pWhatGoesIn &lt;&lt; "\\\"" &lt;&lt; "&gt;\" &lt;&lt; ";</span>
01266       oDataSet_h &lt;&lt; <span class="stringliteral">"A.data[i]-&gt;"</span> &lt;&lt; *pWhatGoesIn &lt;&lt; <span class="stringliteral">"[j]"</span>;
01267 <span class="comment">//    oDataSet_h &lt;&lt; " &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01268       cntColumns++;
01269     }
01270     }
01271   <span class="keywordflow">if</span>( cntColumns != nColumns )
01272     {
01273       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e3">SpkCompilerError::maxMessageLen</a>() ];
01274       snprintf( mess, 
01275         SpkCompilerError::maxMessageLen(),
01276         <span class="stringliteral">"The number of data items (%d), does not the number of labels (%d)."</span>,
01277         cntColumns, nColumns );
01278       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( SpkCompilerError::ASPK_USER_ERR, mess, __LINE__, __FILE__ );
01279       <span class="keywordflow">throw</span> e;
01280     }
01281 <span class="comment">//  oDataSet_h &lt;&lt; "         o &lt;&lt; \"&lt;/row&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01282   oDataSet_h &lt;&lt; <span class="stringliteral">" &lt;&lt; endl;"</span> &lt;&lt; endl;
01283   oDataSet_h &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
01284   oDataSet_h &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
01285   <span class="comment">//</span>
01286   <span class="comment">// End of computed values.</span>
01287   <span class="comment">//-----------------------------------------------------------------------------</span>
01288   
01289   oDataSet_h &lt;&lt; <span class="stringliteral">"   o &lt;&lt; \"&lt;/\" &lt;&lt; \"presentation_data\" &lt;&lt; \"&gt;\";"</span> &lt;&lt; endl;
01290   <span class="comment">//</span>
01291   <span class="comment">// Close &lt;presentation_data&gt;</span>
01292   <span class="comment">//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
01293   oDataSet_h &lt;&lt; <span class="stringliteral">"};"</span> &lt;&lt; endl;
01294 
01295 
01296   oDataSet_h &lt;&lt; <span class="stringliteral">"template &lt;class spk_ValueType&gt;"</span> &lt;&lt; endl;
01297   oDataSet_h &lt;&lt; <span class="stringliteral">"std::ostream&amp; operator&lt;&lt; ( std::ostream&amp; o, const DataSet&lt;spk_ValueType&gt;&amp; A );"</span> &lt;&lt; endl;
01298   oDataSet_h &lt;&lt; <span class="stringliteral">"#endif"</span> &lt;&lt; endl;
01299   oDataSet_h.close();
01300 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jul 10 16:48:16 2007 for SPK Compiler API Documentation by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
