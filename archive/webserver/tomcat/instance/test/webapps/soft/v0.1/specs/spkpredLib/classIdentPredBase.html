<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Pred Library: IdentPredBase&lt; Value &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>IdentPredBase&lt; Value &gt; Class Template Reference</h1><!-- doxytag: class="IdentPredBase" --><!-- doxytag: inherits="OdePredBase" --><code>#include &lt;<a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a>&gt;</code>
<p>
<p>Inheritance diagram for IdentPredBase&lt; Value &gt;:
<p><center><img src="classIdentPredBase.png" usemap="#IdentPredBase< Value >_map" border="0" alt=""></center>
<map name="IdentPredBase< Value >_map">
<area href="classOdePredBase.html" alt="OdePredBase< Value >" shape="rect" coords="0,56,151,80">
<area href="classPredBase.html" alt="PredBase< Value >" shape="rect" coords="0,0,151,24">
</map>
<a href="classIdentPredBase-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;class Value&gt;<br>
 class IdentPredBase&lt; Value &gt;</h3>

This abstract base class is a specialization of <a class="el" href="classOdePredBase.html">OdePredBase</a> that provides additional interfaces and support functions to determine the identifiability of ordinary differential equation (ODE) based compartmental models. 
<p>

<p>
Definition at line <a class="el" href="IdentPredBase_8h-source.html#l00207">207</a> of file <a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentPredBase.html#7b0aca6b25ac6d90cd44f0b70a3f3969">IdentPredBase</a> (int nThetaIn, int nEtaIn, bool isPkBlockAFuncOfTIn, int nCompIn, int defaultDoseCompIn, int defaultObservCompIn, const SPK_VA::valarray&lt; bool &gt; &amp;compInitialOffIn, const SPK_VA::valarray&lt; bool &gt; &amp;compNoOffIn, const SPK_VA::valarray&lt; bool &gt; &amp;compNoDoseIn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor that must be called by constructors for concrete subclasses of this abstract base class.  <a href="#7b0aca6b25ac6d90cd44f0b70a3f3969"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentPredBase.html#2cb24975138106f564ba26df704f54fc">checkIndParamIdent</a> (int i, int level, int nTheta, int nEta, int thetaSeed, std::string &amp;identStatus)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempts to determine the identifiability of an individual's THETA parameter using the system-experiment model that is defined by the expressions from the PK, DES, and ERROR blocks and that is also defined by the data records from the data file.  <a href="#2cb24975138106f564ba26df704f54fc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIdentPredBase.html#479c39be02484aebe109c55ab4caa216">~IdentPredBase</a> ()</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="7b0aca6b25ac6d90cd44f0b70a3f3969"></a><!-- doxytag: member="IdentPredBase::IdentPredBase" ref="7b0aca6b25ac6d90cd44f0b70a3f3969" args="(int nThetaIn, int nEtaIn, bool isPkBlockAFuncOfTIn, int nCompIn, int defaultDoseCompIn, int defaultObservCompIn, const SPK_VA::valarray&lt; bool &gt; &amp;compInitialOffIn, const SPK_VA::valarray&lt; bool &gt; &amp;compNoOffIn, const SPK_VA::valarray&lt; bool &gt; &amp;compNoDoseIn)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Value&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIdentPredBase.html">IdentPredBase</a>&lt; Value &gt;::<a class="el" href="classIdentPredBase.html">IdentPredBase</a>           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nThetaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nEtaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>isPkBlockAFuncOfTIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nCompIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>defaultDoseCompIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>defaultObservCompIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>compInitialOffIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>compNoOffIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>compNoDoseIn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor that must be called by constructors for concrete subclasses of this abstract base class. 
<p>

<p>
Definition at line <a class="el" href="IdentPredBase_8h-source.html#l00224">224</a> of file <a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a>.
</div>
</div><p>
<a class="anchor" name="479c39be02484aebe109c55ab4caa216"></a><!-- doxytag: member="IdentPredBase::~IdentPredBase" ref="479c39be02484aebe109c55ab4caa216" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Value&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classIdentPredBase.html">IdentPredBase</a>&lt; Value &gt;::~<a class="el" href="classIdentPredBase.html">IdentPredBase</a>           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="IdentPredBase_8h-source.html#l01548">1548</a> of file <a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a>.
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="2cb24975138106f564ba26df704f54fc"></a><!-- doxytag: member="IdentPredBase::checkIndParamIdent" ref="2cb24975138106f564ba26df704f54fc" args="(int i, int level, int nTheta, int nEta, int thetaSeed, std::string &amp;identStatus)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Value&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classIdentPredBase.html">IdentPredBase</a>&lt; Value &gt;::checkIndParamIdent           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nEta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>thetaSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>identStatus</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Attempts to determine the identifiability of an individual's THETA parameter using the system-experiment model that is defined by the expressions from the PK, DES, and ERROR blocks and that is also defined by the data records from the data file. 
<p>
See Audoly et al. (2001) for details on the identifiability algorithm.<p>
First, this function examines all of the data records to determine the unique observation types and the compartments that receive doses. The identifiability calculation will be performed using the data values and covariates for the last data record for the individual.<p>
Next, this function attempts to calculate the Groebner basis or bases that correspond to the system-experiment model differential polyomial regular chain sysExpModelRegChainIn. To be specific, this function attempts to calculate the Groebner bases for the exhaustive summary polynomials that come from the input/output relations' coefficients, which are evaluated at a random value for the vector that will be determined to be identifiable or not, THETA.<p>
Finally, this function attempts to solve each set of Groebner basis equations, which are a nonlinear system of polynomials.<p>
Reference:<p>
S. Audoly, G. Bella, L. D'Angio, M. P. Saccomani, and C. Cobelli, "Global Identifiability of Nonlinear Models of Biological Systems," IEEE Transactions on Biomedical Engineering, Vol. 48, pp. 55 - 65, January 2001.<p>
F. Boulier, "The bad library (version 1.7.2)", pp. 2-6, 2004.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>If index for the individual for which to perform the identifiability calculation.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>If level = 0, then no intermediate information from the identifiability calculation will be printed to standard output. If level = 1, then the intermediate information will be printed.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nTheta</em>&nbsp;</td><td>The number of elements in the THETA vector, which are the parameters that will be checked to be identifiable or not.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nEta</em>&nbsp;</td><td>The number of elements in the ETA vector.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>thetaSeed</em>&nbsp;</td><td>The value to use to seed the random number generator used to generate the random value for THETA.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>identStatus</em>&nbsp;</td><td>On output from this function this string will contain a description of the status of the identifiability calculation, e.g. "Globally (Uniquely) Identifiable", "Locally (Nonuniquely ) Identifiable", "Nonidentifiable (Infinite Solutions)", "Nonidentifiable (No Solutions)", or "Identifiability could not be determined"</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd></dd></dl>
Returns the total number of solutions of the nonlinear system of equations that make up all of the Groebner basis equations.<p>
If the number of solutions is equal to 0, then the identifiability of the individual's THETA parameter could not be determined.<p>
If the number of solutions is equal to 1, then the individual's THETA parameter is globally (uniquely) identifiable.<p>
If the number of solutions is greater than 1, then the individual's THETA parameter is locally (nonuniquely) identifiable.<p>
If the number of solutions is equal to -1, then the individual's THETA parameter has an infinite number of solutions and is nonidentifiable.<p>
If the number of solutions is equal to -2, then the individual's THETA parameter had multiple Groebner bases. 
<p>
Definition at line <a class="el" href="IdentPredBase_8h-source.html#l00374">374</a> of file <a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a>.
<p>
References <a class="el" href="calcGroebnerBasis_8c-source.html#l00282">calcGroebnerBasis()</a>, <a class="el" href="OdePredBase_8h-source.html#l01521">OdePredBase&lt; Value &gt;::compIndex()</a>, <a class="el" href="classOdePredBase.html#62e153374b5e5e2ecc1df312dcb12231">OdePredBase&lt; Value &gt;::evalDes()</a>, <a class="el" href="classOdePredBase.html#0de0d9b2e3dc96d02e5b42107cf5783c">OdePredBase&lt; Value &gt;::evalError()</a>, <a class="el" href="classOdePredBase.html#60d5a715d34fde883d719b82b44bf6a8">OdePredBase&lt; Value &gt;::evalPk()</a>, <a class="el" href="OdePredBase_8h-source.html#l01238">OdePredBase&lt; Value &gt;::getCMT()</a>, <a class="el" href="OdePredBase_8h-source.html#l01309">OdePredBase&lt; Value &gt;::getCompAmount()</a>, <a class="el" href="OdePredBase_8h-source.html#l01306">OdePredBase&lt; Value &gt;::getCompBioavailFrac()</a>, <a class="el" href="OdePredBase_8h-source.html#l01303">OdePredBase&lt; Value &gt;::getCompScaleParam()</a>, <a class="el" href="OdePredBase_8h-source.html#l01284">OdePredBase&lt; Value &gt;::getDefaultDoseComp()</a>, <a class="el" href="OdePredBase_8h-source.html#l01285">OdePredBase&lt; Value &gt;::getDefaultObservComp()</a>, <a class="el" href="OdePredBase_8h-source.html#l01237">OdePredBase&lt; Value &gt;::getEVID()</a>, <a class="el" href="OdePredBase_8h-source.html#l01207">OdePredBase&lt; Value &gt;::getF()</a>, <a class="el" href="classPredBase.html#7e43c57a6931f323936b20f9317ee894">PredBase&lt; Value &gt;::getNObservs()</a>, <a class="el" href="PredBase_8h-source.html#l00688">PredBase&lt; Value &gt;::getNRecords()</a>, <a class="el" href="OdePredBase_8h-source.html#l01208">OdePredBase&lt; Value &gt;::getY()</a>, <a class="el" href="OdePredBase_8h-source.html#l00274">OdePredBase&lt; Value &gt;::initUserEnv()</a>, <a class="el" href="OdePredBase_8h-source.html#l00298">OdePredBase&lt; Value &gt;::saveUserEnv()</a>, and <a class="el" href="OdePredBase_8h-source.html#l01342">OdePredBase&lt; Value &gt;::setCompAmount()</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="IdentPredBase_8h-source.html">IdentPredBase.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Sep 10 10:13:35 2007 for SPK Pred Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
