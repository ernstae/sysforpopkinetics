<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Pred Library: IndPredModel Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>IndPredModel Class Reference</h1><!-- doxytag: class="IndPredModel" --><!-- doxytag: inherits="IndPredModelBase&lt; double &gt;" --><code>#include &lt;<a class="el" href="IndPredModel_8h-source.html">IndPredModel.h</a>&gt;</code>
<p>
<p>Inheritance diagram for IndPredModel:
<p><center><img src="classIndPredModel.png" usemap="#IndPredModel_map" border="0" alt=""></center>
<map name="IndPredModel_map">
<area href="classIndPredModelBase.html" alt="IndPredModelBase< double >" shape="rect" coords="0,56,181,80">
<area href="classSpkModel.html" alt="SpkModel" shape="rect" coords="0,0,181,24">
</map>
<a href="classIndPredModel-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
This <a class="el" href="classSpkModel.html">SpkModel</a> subclass evaluates individual level models that correspond to the expressions in an NM-TRAN $PRED block. 
<p>
The following sections of this description describe the models used at the individual level by SPK and NONMEM.<p>
<b> SPK Model for an Individual's Data</b><p>
SPK's model for the <img class="formulaInl" alt="$j^{\mbox{th}}$" src="form_16.png"> value of an individual's data is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ y_{(j)} = f_{(j)}(b) + e_{(j)} , \]" src="form_17.png">
<p>
 where <p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_{(j,k)}(b) = \mbox{cov}[e_{(j)},e_{(k)}] , \]" src="form_18.png">
<p>
 and <img class="formulaInl" alt="$b$" src="form_19.png"> is the individual's vector of parameters. If the MAP Bayesian objective function is used, then <p class="formulaDsp">
<img class="formulaDsp" alt="\[ D_{(p,q)} = \mbox{cov}[b_{(p)},b_{(q)}] , \]" src="form_20.png">
<p>
 is the covariance of the individual's parameters.<p>
The output of SPK's individual level estimation is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b^{\mbox{Out}} , \]" src="form_21.png">
<p>
 which is an estimate for the optimal value for the individual's parameters.<p>
<b>NONMEM Model for an Individual's Data</b><p>
NONMEM's model (NONMEM User's Guide - Part V, NONMEM Project Group, pp. 23-31, 1994) for the <img class="formulaInl" alt="$j^{\mbox{th}}$" src="form_16.png"> value of an individual's data is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ y_{(j)} = f(x_{j}, \theta) + \sum_{m=1}^{n_{\Omega}} h_{(m)}(x_{j}, \theta) \eta_{(m)} . \]" src="form_22.png">
<p>
 where <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Omega_{(m,n)} = \mbox{cov}[\eta_{(m)},\eta_{(n)}] , \]" src="form_23.png">
<p>
 <img class="formulaInl" alt="$\theta$" src="form_24.png"> and <img class="formulaInl" alt="$\Omega$" src="form_25.png"> are a vector and matrix of the individual's parameters, <img class="formulaInl" alt="$x_{j}$" src="form_26.png"> is a vector of known quantities for the individual such as times and covariates, and <img class="formulaInl" alt="$n_{\Omega}$" src="form_27.png"> is the number of elements along the diagonal of <img class="formulaInl" alt="$\Omega$" src="form_25.png">. NONMEM does not support the MAP Bayesian objective function at the individual level.<p>
The output of NONMEM's individual level estimation is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{ \theta^{\mbox{Out}}, \Omega^{\mbox{Out}} \right\} , \]" src="form_28.png">
<p>
 which are estimates for the optimal values for the individual's parameters.<p>
<b>Comparison of the Models for an Individual's Data</b><p>
The SPK individual parameter <img class="formulaInl" alt="$b$" src="form_19.png"> is defined as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b = \left[ \begin{array}{c} \theta \\ \mbox{omegaPar} \end{array} \right] , \]" src="form_29.png">
<p>
 where omegaPar is a vector of covariance matrix parameters that correspond to the minimal representation for <img class="formulaInl" alt="$\Omega$" src="form_25.png">.<p>
In these two formulations, <img class="formulaInl" alt="$b$" src="form_19.png"> and <img class="formulaInl" alt="$\eta$" src="form_30.png"> are not equivalent, and there is no relationship between the covariance matrices <img class="formulaInl" alt="$D$" src="form_31.png"> and <img class="formulaInl" alt="$\Omega$" src="form_25.png">.<p>
Although <img class="formulaInl" alt="$e$" src="form_32.png"> and <img class="formulaInl" alt="$\eta$" src="form_30.png"> are also not equivalent, the covariance matrices <img class="formulaInl" alt="$R(b)$" src="form_33.png"> and <img class="formulaInl" alt="$\Omega$" src="form_25.png"> are related as described in the following section, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ R_{(j,k)}(b) = \sum_{m=1}^{n_{\Omega}} \sum_{n=1}^{n_{\Omega}} \left[ h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta \right) \right] \Omega_{(m,n)} \left[ h_{(n)}\left( \rule{0.0in}{0.15in} f(x_{k}, \theta), x_{k}, \theta \right) \right] . \]" src="form_34.png">
<p>
<p>
<b>First-order Approximation for the Intraindividual Error Model during Individual Level Estimation</b><p>
Because NM-TRAN makes a first-order approximation for the intraindividual error model during population level estimation (NONMEM User's Guide - Part V, NONMEM Project Group, p. 81, 1994) the corresponding SPK models do the same.<p>
To be specific, let the model for the <img class="formulaInl" alt="$j^{\mbox{th}}$" src="form_16.png"> value of an individual's data be expressed as the following functional: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ y_{(j)} = y_{(j)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta, \eta \right) . \]" src="form_35.png">
<p>
 where <img class="formulaInl" alt="$f(x_j, \theta)$" src="form_36.png"> is the mean or expected value for the data, <img class="formulaInl" alt="$x_j$" src="form_37.png"> is a vector of known quantities for the individual such as times and covariates, <img class="formulaInl" alt="$\theta$" src="form_24.png"> is a vector of fixed effects parameters, and <img class="formulaInl" alt="$\eta$" src="form_30.png"> is a vector of random variables that appears in NONMEM'S intraindividual error model.<p>
During individual level estimation this functional is approximated by <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} \lefteqn{ \widetilde{y}_{(j)} \left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta, \eta \right) } \nonumber \\ &amp; &amp; = y_{(j)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta, \eta \right) \left| \! \begin{array}{l} \\ {\scriptstyle \eta = 0} \end{array} \right. + \sum_{m=1}^{n_{\Omega}} \left[ \partial_{\eta}^{(m)} y_{(j)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta, \eta \right) \left| \! \begin{array}{l} \\ {\scriptstyle \eta = 0} \end{array} \right. \right] \eta_{(m)} . \end{eqnarray}" src="form_38.png">
<p>
 Define the derivative of the functional evaluated at <img class="formulaInl" alt="$\eta = 0$" src="form_39.png"> as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta \right) = \partial_{\eta}^{(m)} y_{(j)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta, \eta \right) \left| \! \begin{array}{l} \\ {\scriptstyle \eta = 0} \end{array} \right. . \]" src="form_40.png">
<p>
 Then, the covariance of the <img class="formulaInl" alt="$j^{\mbox{th}}$" src="form_16.png"> and <img class="formulaInl" alt="$k^{\mbox{th}}$" src="form_41.png"> values of an individual's data is given by <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} \mbox{cov} [ \tilde{y}_j , \tilde{y}_{(k)} ] &amp; = &amp; \mbox{cov} \left[ \sum_{m=1}^{n_{\Omega}} h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta \right) \eta_{(m)}, \sum_{n=1}^{n_{\Omega}} h_{(n)}\left( \rule{0.0in}{0.15in} f(x_{k}, \theta), x_{k}, \theta \right) \eta_{(n)} \right] \\ &amp; = &amp; \sum_{m=1}^{n_{\Omega}} \sum_{n=1}^{n_{\Omega}} \left[ h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta \right) \right] \mbox{cov} [ \eta_{(m)} , \eta_{(n)} ] \left[ h_{(n)}\left( \rule{0.0in}{0.15in} f(x_{k}, \theta), x_{k}, \theta \right) \right] \\ &amp; = &amp; \sum_{m=1}^{n_{\Omega}} \sum_{n=1}^{n_{\Omega}} \left[ h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_j, \theta \right) \right] \Omega_{(m,n)} \left[ h_{(n)}\left( \rule{0.0in}{0.15in} f(x_{k}, \theta), x_{k}, \theta \right) \right] \end{eqnarray}" src="form_42.png">
<p>
 This corresponds to <img class="formulaInl" alt="$R_{(j,k)}$" src="form_43.png"> in SPK notation.<p>
If the intraindividual error model can be expressed in traditional NONMEM form, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ y_{(j)} = f(x_j, \theta) + \sum_{m=1}^{n_{\Omega}} h_{(m)}\left( \rule{0.0in}{0.15in} f(x_j, \theta), x_{k}, \theta \right) \eta_{(m)} , \]" src="form_44.png">
<p>
 then <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \widetilde{y}_{(j)} = y_{(j)} , \]" src="form_45.png">
<p>
 and there is no difference between the approximate and exact intraindividual error models.<p>
If the intraindividual error model is not linear in <img class="formulaInl" alt="$\eta$" src="form_30.png">, however, the two forms are not equal. For example, in the case of an exponential error model with a single <img class="formulaInl" alt="$\eta$" src="form_30.png"> component, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ y_{(j)} = f(x_j, \theta) \exp[ \eta_{(1)} ] , \]" src="form_46.png">
<p>
 which implies that <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} \widetilde{y}_{(j)} &amp; = &amp; f(x_j, \theta) + f(x_j, \theta) \eta_{(1)} \\ &amp; \neq &amp; y_{(j)} , \end{eqnarray}" src="form_47.png">
<p>
 and the intraindividual error models are therefore different.<p>
Note that as a result of this first-order approximation an exponential model is equivalent to a constant coefficient of variation (CCV) model during individual level estimation. 
<p>

<p>
Definition at line <a class="el" href="IndPredModel_8h-source.html#l00285">285</a> of file <a class="el" href="IndPredModel_8h-source.html">IndPredModel.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#328a43b29a69189b993efbc9c7e452b0">IndPredModel</a> (<a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;predEvaluatorIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, <a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a> omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for individual level Pred models.  <a href="#328a43b29a69189b993efbc9c7e452b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#b566583a6b86a308b1d535e936f80cfe">IndPredModel</a> (<a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;predEvaluatorIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, <a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a> omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn, const SPK_VA::valarray&lt; bool &gt; &amp;omegaMinRepFixedIn)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for individual level Pred models.  <a href="#b566583a6b86a308b1d535e936f80cfe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#b092496798af35971e72e52da175682d">IndPredModel</a> (<a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;predEvaluatorIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, <a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, <a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a> omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn, const SPK_VA::valarray&lt; bool &gt; &amp;omegaMinRepFixedIn, const SPK_VA::valarray&lt; <a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a> &gt; &amp;omegaBlockStruct, const SPK_VA::valarray&lt; int &gt; &amp;omegaBlockDims, const SPK_VA::valarray&lt; bool &gt; &amp;omegaBlockSameAsPrev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor for individual level Pred models.  <a href="#b092496798af35971e72e52da175682d"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#a99ec2fe8f2ad881a550514b05425c50">doDataMean_indPar</a> (SPK_VA::valarray&lt; double &gt; &amp;ret) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets ret equal to the current value for the derivative with respect to the individual parameter of the mean of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b f_i(b_i) , \]" src="form_11.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter.  <a href="#a99ec2fe8f2ad881a550514b05425c50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#774e264df257608b5a26180a5d5eb22c">doDataVariance_indPar</a> (SPK_VA::valarray&lt; double &gt; &amp;ret) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets ret equal to the current value for the derivative with respect to the individual parameter of the variance of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b R_i(b_i) = \partial_b \mbox{rvec} \left[ R_i(b_i) \right] , \]" src="form_14.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter.  <a href="#774e264df257608b5a26180a5d5eb22c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIndPredModel.html#b83bd72b648c2e8bab79ac34fa442a71">doDataVarianceInv_indPar</a> (SPK_VA::valarray&lt; double &gt; &amp;ret) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets ret equal to the current value for the derivative with respect to the individual parameter of the inverse of the variance of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b R^{-1}_i(b_i) = \partial_b \mbox{rvec} \left[ R^{-1}_i(b_i) \right] , \]" src="form_15.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter.  <a href="#b83bd72b648c2e8bab79ac34fa442a71"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="328a43b29a69189b993efbc9c7e452b0"></a><!-- doxytag: member="IndPredModel::IndPredModel" ref="328a43b29a69189b993efbc9c7e452b0" args="(PredBase&lt; double &gt; &amp;predEvaluatorIn, PredBase&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, PredBase&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, covStruct omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IndPredModel::IndPredModel           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nThetaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaLowIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaUpIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaCurrIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nEtaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a>&nbsp;</td>
          <td class="paramname"> <em>omegaStructIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaMinRepIn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor for individual level Pred models. 
<p>
After this constructor has completed the current individual parameter will be <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_i = \left[ \begin{array}{c} \mbox{thetaCurrIn} \\ \mbox{omegaParCurr} \end{array} \right] , \]" src="form_10.png">
<p>
 where omegaParCurr is the covariance matrix parameter that corresponds to the minimal representation for omega that is contained in omegaMinRepIn. 
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00095">95</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="IndPredModel_8cpp-source.html#l00095">IndPredModel()</a>.
<p>
Referenced by <a class="el" href="IndPredModel_8cpp-source.html#l00095">IndPredModel()</a>.
</div>
</div><p>
<a class="anchor" name="b566583a6b86a308b1d535e936f80cfe"></a><!-- doxytag: member="IndPredModel::IndPredModel" ref="b566583a6b86a308b1d535e936f80cfe" args="(PredBase&lt; double &gt; &amp;predEvaluatorIn, PredBase&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, PredBase&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, covStruct omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn, const SPK_VA::valarray&lt; bool &gt; &amp;omegaMinRepFixedIn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IndPredModel::IndPredModel           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nThetaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaLowIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaUpIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaCurrIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nEtaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a>&nbsp;</td>
          <td class="paramname"> <em>omegaStructIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaMinRepIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaMinRepFixedIn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor for individual level Pred models. 
<p>
After this constructor has completed the current individual parameter will be <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_i = \left[ \begin{array}{c} \mbox{thetaCurrIn} \\ \mbox{omegaParCurr} \end{array} \right] , \]" src="form_10.png">
<p>
 where omegaParCurr is the covariance matrix parameter that corresponds to the minimal representation for omega that is contained in omegaMinRepIn. 
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00147">147</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="IndPredModel_8cpp-source.html#l00095">IndPredModel()</a>.
</div>
</div><p>
<a class="anchor" name="b092496798af35971e72e52da175682d"></a><!-- doxytag: member="IndPredModel::IndPredModel" ref="b092496798af35971e72e52da175682d" args="(PredBase&lt; double &gt; &amp;predEvaluatorIn, PredBase&lt; CppAD::AD&lt; double &gt; &gt; &amp;predEvaluatorADIn, PredBase&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;predEvaluatorADADIn, int nThetaIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaLowIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaUpIn, const SPK_VA::valarray&lt; double &gt; &amp;thetaCurrIn, int nEtaIn, covStruct omegaStructIn, const SPK_VA::valarray&lt; double &gt; &amp;omegaMinRepIn, const SPK_VA::valarray&lt; bool &gt; &amp;omegaMinRepFixedIn, const SPK_VA::valarray&lt; covStruct &gt; &amp;omegaBlockStruct, const SPK_VA::valarray&lt; int &gt; &amp;omegaBlockDims, const SPK_VA::valarray&lt; bool &gt; &amp;omegaBlockSameAsPrev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IndPredModel::IndPredModel           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPredBase.html">PredBase</a>&lt; CppAD::AD&lt; CppAD::AD&lt; double &gt; &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>predEvaluatorADADIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nThetaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaLowIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaUpIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>thetaCurrIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nEtaIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a>&nbsp;</td>
          <td class="paramname"> <em>omegaStructIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaMinRepIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaMinRepFixedIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; <a class="el" href="Cov_8h.html#f485fe4798cd43e24d06424eafab7926">covStruct</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaBlockStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaBlockDims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; bool &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>omegaBlockSameAsPrev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor for individual level Pred models. 
<p>
After this constructor has completed the current individual parameter will be <p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_i = \left[ \begin{array}{c} \mbox{thetaCurrIn} \\ \mbox{omegaParCurr} \end{array} \right] , \]" src="form_10.png">
<p>
 where omegaParCurr is the covariance matrix parameter that corresponds to the minimal representation for omega that is contained in omegaMinRepIn. 
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00200">200</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="IndPredModel_8cpp-source.html#l00095">IndPredModel()</a>.
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a99ec2fe8f2ad881a550514b05425c50"></a><!-- doxytag: member="IndPredModel::doDataMean_indPar" ref="a99ec2fe8f2ad881a550514b05425c50" args="(SPK_VA::valarray&lt; double &gt; &amp;ret) const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IndPredModel::doDataMean_indPar           </td>
          <td>(</td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ret</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets ret equal to the current value for the derivative with respect to the individual parameter of the mean of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b f_i(b_i) , \]" src="form_11.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter. 
<p>
This function returns a value of true if this derivative has at least one nonzero element. 
<p>
Reimplemented from <a class="el" href="classIndPredModelBase.html#4f48bd264f50124d2981e9784b30a11c">IndPredModelBase&lt; double &gt;</a>.
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00255">255</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="IndPredModelBase_8h-source.html#l00400">IndPredModelBase&lt; double &gt;::dataMean_indParCurr</a>, <a class="el" href="classIndPredModelBase.html#65312e8e5fd9cb50d935887f72291a01">IndPredModelBase&lt; double &gt;::evalFAndH_theta()</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00486">IndPredModelBase&lt; double &gt;::f_thetaCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00407">IndPredModelBase&lt; double &gt;::isDataMean_indParCurrOk</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00342">IndPredModelBase&lt; double &gt;::nIndPar</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00464">IndPredModelBase&lt; double &gt;::nObsRecordCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00344">IndPredModelBase&lt; double &gt;::nTheta</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00349">IndPredModelBase&lt; double &gt;::thetaOffsetInIndPar</a>, and <a class="el" href="IndPredModelBase_8h-source.html#l00416">IndPredModelBase&lt; double &gt;::usedCachedDataMean_indPar</a>.
</div>
</div><p>
<a class="anchor" name="774e264df257608b5a26180a5d5eb22c"></a><!-- doxytag: member="IndPredModel::doDataVariance_indPar" ref="774e264df257608b5a26180a5d5eb22c" args="(SPK_VA::valarray&lt; double &gt; &amp;ret) const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IndPredModel::doDataVariance_indPar           </td>
          <td>(</td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ret</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets ret equal to the current value for the derivative with respect to the individual parameter of the variance of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b R_i(b_i) = \partial_b \mbox{rvec} \left[ R_i(b_i) \right] , \]" src="form_14.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter. 
<p>
This function returns a value of true if this derivative has at least one nonzero element. 
<p>
Reimplemented from <a class="el" href="classIndPredModelBase.html#4906777b94c6324e55df463771c91e89">IndPredModelBase&lt; double &gt;</a>.
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00401">401</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="classCov.html#83760edb3730b9af77609c1b832b53a0">Cov&lt; Scalar &gt;::cov()</a>, <a class="el" href="classCov.html#6b759cd0c6909630f02fb0e3732c7861">Cov&lt; Scalar &gt;::cov_par()</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00402">IndPredModelBase&lt; double &gt;::dataVariance_indParCurr</a>, <a class="el" href="classIndPredModelBase.html#65312e8e5fd9cb50d935887f72291a01">IndPredModelBase&lt; double &gt;::evalFAndH_theta()</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00488">IndPredModelBase&lt; double &gt;::h_thetaCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00487">IndPredModelBase&lt; double &gt;::hCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00409">IndPredModelBase&lt; double &gt;::isDataVariance_indParCurrOk</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00345">IndPredModelBase&lt; double &gt;::nEta</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00342">IndPredModelBase&lt; double &gt;::nIndPar</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00464">IndPredModelBase&lt; double &gt;::nObsRecordCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00347">IndPredModelBase&lt; double &gt;::nOmegaPar</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00344">IndPredModelBase&lt; double &gt;::nTheta</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00397">IndPredModelBase&lt; double &gt;::omega_omegaParCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00396">IndPredModelBase&lt; double &gt;::omegaCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00350">IndPredModelBase&lt; double &gt;::omegaParOffsetInIndPar</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00392">IndPredModelBase&lt; double &gt;::pOmegaCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00349">IndPredModelBase&lt; double &gt;::thetaOffsetInIndPar</a>, and <a class="el" href="IndPredModelBase_8h-source.html#l00418">IndPredModelBase&lt; double &gt;::usedCachedDataVariance_indPar</a>.
<p>
Referenced by <a class="el" href="IndPredModel_8cpp-source.html#l00664">doDataVarianceInv_indPar()</a>.
</div>
</div><p>
<a class="anchor" name="b83bd72b648c2e8bab79ac34fa442a71"></a><!-- doxytag: member="IndPredModel::doDataVarianceInv_indPar" ref="b83bd72b648c2e8bab79ac34fa442a71" args="(SPK_VA::valarray&lt; double &gt; &amp;ret) const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IndPredModel::doDataVarianceInv_indPar           </td>
          <td>(</td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ret</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets ret equal to the current value for the derivative with respect to the individual parameter of the inverse of the variance of the current individual's data, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_b R^{-1}_i(b_i) = \partial_b \mbox{rvec} \left[ R^{-1}_i(b_i) \right] , \]" src="form_15.png">
<p>
 where <img class="formulaInl" alt="$ i $" src="form_12.png"> = index for the current individual and <img class="formulaInl" alt="$ b_i $" src="form_13.png"> = current value for the individual parameter. 
<p>
This function returns a value of true if this derivative has at least one nonzero element. 
<p>
Reimplemented from <a class="el" href="classIndPredModelBase.html#e46f7d4cb089136d69356f2a94c9fc0f">IndPredModelBase&lt; double &gt;</a>.
<p>
Definition at line <a class="el" href="IndPredModel_8cpp-source.html#l00664">664</a> of file <a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a>.
<p>
References <a class="el" href="IndPredModelBase_8h-source.html#l00402">IndPredModelBase&lt; double &gt;::dataVariance_indParCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00401">IndPredModelBase&lt; double &gt;::dataVarianceCurr</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00404">IndPredModelBase&lt; double &gt;::dataVarianceInv_indParCurr</a>, <a class="el" href="classIndPredModelBase.html#89fbb51b1fa1e0c909b1b1240ebbfaae">IndPredModelBase&lt; double &gt;::doDataVariance()</a>, <a class="el" href="IndPredModel_8cpp-source.html#l00401">doDataVariance_indPar()</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00408">IndPredModelBase&lt; double &gt;::isDataVarianceCurrOk</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00411">IndPredModelBase&lt; double &gt;::isDataVarianceInv_indParCurrOk</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00342">IndPredModelBase&lt; double &gt;::nIndPar</a>, <a class="el" href="IndPredModelBase_8h-source.html#l00464">IndPredModelBase&lt; double &gt;::nObsRecordCurr</a>, and <a class="el" href="IndPredModelBase_8h-source.html#l00420">IndPredModelBase&lt; double &gt;::usedCachedDataVarianceInv_indPar</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="IndPredModel_8h-source.html">IndPredModel.h</a><li><a class="el" href="IndPredModel_8cpp-source.html">IndPredModel.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Sep 10 10:13:35 2007 for SPK Pred Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
