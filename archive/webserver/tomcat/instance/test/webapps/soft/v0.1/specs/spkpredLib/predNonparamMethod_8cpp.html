<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Pred Library: predNonparamMethod.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>predNonparamMethod.cpp File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Implements <a class="el" href="predNonparamMethod_8cpp.html#2c2e2f916b8e9ae3b13166bf28b54a2f">predNonparamMethod()</a> function. 
<p>

<p>
Definition in file <a class="el" href="predNonparamMethod_8cpp-source.html">predNonparamMethod.cpp</a>.
<p>
<code>#include &quot;<a class="el" href="IndPredModel_8h-source.html">IndPredModel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="PopPredModel_8h-source.html">PopPredModel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="predNonparamMethod_8h-source.html">predNonparamMethod.h</a>&quot;</code><br>
<code>#include &lt;spk/add.h&gt;</code><br>
<code>#include &lt;spk/divByScalar.h&gt;</code><br>
<code>#include &lt;spk/getCol.h&gt;</code><br>
<code>#include &lt;spk/getSubblock.h&gt;</code><br>
<code>#include &lt;spk/mulByScalar.h&gt;</code><br>
<code>#include &lt;spk/multiply.h&gt;</code><br>
<code>#include &lt;spk/Objective.h&gt;</code><br>
<code>#include &lt;spk/Optimizer.h&gt;</code><br>
<code>#include &lt;spk/replaceJth.h&gt;</code><br>
<code>#include &lt;spk/SpkValarray.h&gt;</code><br>
<code>#include &lt;spk/spk_non_par.h&gt;</code><br>
<code>#include &lt;spk/subtract.h&gt;</code><br>
<code>#include &lt;spk/transpose.h&gt;</code><br>

<p>
<a href="predNonparamMethod_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="predNonparamMethod_8cpp.html#2c2e2f916b8e9ae3b13166bf28b54a2f">predNonparamMethod</a> (<a class="el" href="classPopPredModel.html">PopPredModel</a> &amp;popModel, <a class="el" href="classIndPredModel.html">IndPredModel</a> &amp;indModelWithPopData, <a class="el" href="classIndPredModelBase.html">IndPredModelBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;indModelWithPopDataAD, const SPK_VA::valarray&lt; int &gt; &amp;nMeasurementsAll, const SPK_VA::valarray&lt; double &gt; &amp;measurementsAll, Optimizer &amp;popOptInfo, Optimizer &amp;indOptInfo, const SPK_VA::valarray&lt; double &gt; &amp;indParLow, const SPK_VA::valarray&lt; double &gt; &amp;indParUp, const SPK_VA::valarray&lt; double &gt; &amp;indMeasurePointAllIn, double *pPopObjOut, SPK_VA::valarray&lt; double &gt; *pIndMeasurePointAllOut, SPK_VA::valarray&lt; double &gt; *pIndWeightOut, SPK_VA::valarray&lt; double &gt; *pIndProbDensityAllOut, SPK_VA::valarray&lt; double &gt; *pIndParPostMeanAllOut)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This Pred library specific nonparametric method wrapper determines the population means and covariances for individual parameters by finding the optimal atomic measure points corresponding to the solution of the nonparametric objective function optimization problem.  <a href="#2c2e2f916b8e9ae3b13166bf28b54a2f"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="2c2e2f916b8e9ae3b13166bf28b54a2f"></a><!-- doxytag: member="predNonparamMethod.cpp::predNonparamMethod" ref="2c2e2f916b8e9ae3b13166bf28b54a2f" args="(PopPredModel &amp;popModel, IndPredModel &amp;indModelWithPopData, IndPredModelBase&lt; CppAD::AD&lt; double &gt; &gt; &amp;indModelWithPopDataAD, const SPK_VA::valarray&lt; int &gt; &amp;nMeasurementsAll, const SPK_VA::valarray&lt; double &gt; &amp;measurementsAll, Optimizer &amp;popOptInfo, Optimizer &amp;indOptInfo, const SPK_VA::valarray&lt; double &gt; &amp;indParLow, const SPK_VA::valarray&lt; double &gt; &amp;indParUp, const SPK_VA::valarray&lt; double &gt; &amp;indMeasurePointAllIn, double *pPopObjOut, SPK_VA::valarray&lt; double &gt; *pIndMeasurePointAllOut, SPK_VA::valarray&lt; double &gt; *pIndWeightOut, SPK_VA::valarray&lt; double &gt; *pIndProbDensityAllOut, SPK_VA::valarray&lt; double &gt; *pIndParPostMeanAllOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void predNonparamMethod           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPopPredModel.html">PopPredModel</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>popModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIndPredModel.html">IndPredModel</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>indModelWithPopData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIndPredModelBase.html">IndPredModelBase</a>&lt; CppAD::AD&lt; double &gt; &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>indModelWithPopDataAD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>nMeasurementsAll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>measurementsAll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optimizer &amp;&nbsp;</td>
          <td class="paramname"> <em>popOptInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optimizer &amp;&nbsp;</td>
          <td class="paramname"> <em>indOptInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>indParLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>indParUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>indMeasurePointAllIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>pPopObjOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; *&nbsp;</td>
          <td class="paramname"> <em>pIndMeasurePointAllOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; *&nbsp;</td>
          <td class="paramname"> <em>pIndWeightOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; *&nbsp;</td>
          <td class="paramname"> <em>pIndProbDensityAllOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; *&nbsp;</td>
          <td class="paramname"> <em>pIndParPostMeanAllOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This Pred library specific nonparametric method wrapper determines the population means and covariances for individual parameters by finding the optimal atomic measure points corresponding to the solution of the nonparametric objective function optimization problem. 
<p>
This function performs a nonparametric method analysis using the individual model, indModelWithPopData, which should contain the same data and model as the population model, popModel.<p>
At the end, the population parameters for the population model are set equal to the values determined by the nonparametric method.<p>
To be specific, at the end of this nonparametric method analysis, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ theta^{\mbox{(Pop)}} = \overline{ theta^{\mbox{(Ind)}} } = \mbox{E}\left[ theta^{\mbox{(Ind)}} \right] = \sum_{j = 1}^{nMeasurePoint} \lambda_j * theta_j^{\mbox{(Ind)}} , \]" src="form_142.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Pop)}} = \mbox{Cov}\left[ theta^{\mbox{(Ind)}} \right] = \sum_{j = 1}^{nMeasurePoint} \lambda_j * \left[ theta_j^{\mbox{(Ind)}} - \overline{ theta^{\mbox{(Ind)}} } \right] \left[ theta_j^{\mbox{(Ind)}} - \overline{ theta^{\mbox{(Ind)}} } \right]^T , \]" src="form_143.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Sigma^{\mbox{(Pop)}} = \overline{ Omega^{\mbox{(Ind)}} } = \mbox{E}\left[ Omega^{\mbox{(Ind)}} \right] = \sum_{j = 1}^{nMeasurePoint} \lambda_j * Omega_j^{\mbox{(Ind)}} , \]" src="form_144.png">
<p>
 where <img class="formulaInl" alt="$ nMeasurePoint $" src="form_145.png"> is the number of optimal atomic measure points determined by the nonparametric method, and the sum of the <img class="formulaInl" alt="$ \lambda_j $" src="form_146.png"> values is equal to one. Note that the above sums are over the optimal set of atomic measure points and not over the individuals in the population. The values for <img class="formulaInl" alt="$ theta_j^{\mbox{(Ind)}} $" src="form_147.png"> and <img class="formulaInl" alt="$ Omega_j^{\mbox{(Ind)}} $" src="form_148.png"> are calculated at the j-th atomic measure point <img class="formulaInl" alt="$ b_j $" src="form_149.png"> using the individual level model.<p>
This function, therefore, requires that the following be true: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nTheta^{\mbox{(Pop)}} = nTheta^{\mbox{(Ind)}} , \]" src="form_150.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nEta^{\mbox{(Pop)}} = nTheta^{\mbox{(Ind)}} , \]" src="form_151.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nEps^{\mbox{(Pop)}} = nEta^{\mbox{(Ind)}} , \]" src="form_152.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ SigmaStruct^{\mbox{(Pop)}} = OmegaStruct^{\mbox{(Ind)}} , \]" src="form_153.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Pop)}} = nEta^{\mbox{(Pop)}} \times nEta^{\mbox{(Pop)}} , \]" src="form_154.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Sigma^{\mbox{(Pop)}} = nEps^{\mbox{(Pop)}} \times nEps^{\mbox{(Pop)}} , \]" src="form_155.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Ind)}} = nEta^{\mbox{(Ind)}} \times nEta^{\mbox{(Ind)}} . \]" src="form_156.png">
<p>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>indMeasurePointAllIn</em>&nbsp;</td><td>This SPK_VA::valarray&lt;double&gt; object specifies the matrix of initial atomic measure points for the nonparametric method. Its size must be equal to the initial number of atomic points in the non-parametric measure, <img class="formulaInl" alt="$ nMeasurePoint $" src="form_145.png">, times the number of individual parameters <img class="formulaInl" alt="$ nB $" src="form_157.png">. The j-th column of the matrix will contain a column vector that is the initial value for the j-th atomic measure point, <img class="formulaInl" alt="$ b_j $" src="form_149.png">. Its number of columns must be greater than or equal to the number of individuals <img class="formulaInl" alt="$ nInd $" src="form_158.png">.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pIndMeasurePointAllOut</em>&nbsp;</td><td>If pIndMeasurePointAllOut is not NULL, then the SPK_VA::valarray&lt;double&gt; object pointed to by pIndMeasurePointAllOut must be declared in the function that calls this function, but its input size does not matter. If pIndMeasurePointAllOut is not NULL and this function completed the nonparametric method successfully, then the object pointed to by pIndMeasurePointAllOut will contain the matrix of optimal atomic measure points that were determined by the nonparametric method. Its size will be equal to the final number of atomic points in the non-parametric measure, <img class="formulaInl" alt="$ nMeasurePoint $" src="form_145.png">, times the number of individual parameters <img class="formulaInl" alt="$ nB $" src="form_157.png">. The j-th column of the matrix will contain a column vector that is the atomic measure point for the j-th atomic point, <img class="formulaInl" alt="$ b_j $" src="form_149.png">. Otherwise, this function will not attempt to change the contents of the object pointed to by pIndMeasurePointAllOut.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pIndWeightOut</em>&nbsp;</td><td>If pIndWeightOut is not NULL, then the SPK_VA::valarray&lt;double&gt; object pointed to by pIndWeightOut must be declared in the function that calls this function, but its input size does not matter. If pIndWeightOut is not NULL and this function completed the nonparametric method successfully, then the object pointed to by pIndWeightOut will contain the vector of weights associated with the optimal atomic measure points that were determined by the nonparametric method. Its size will be equal to the final number of atomic points in the non-parametric measure, <img class="formulaInl" alt="$ nMeasurePoint $" src="form_145.png">. The j-th element of the matrix will contain the weight for the j-th atomic measure point, <img class="formulaInl" alt="$ b_j $" src="form_149.png">. Otherwise, this function will not attempt to change the contents of the object pointed to by pIndWeightOut.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pIndProbDensityAllOut</em>&nbsp;</td><td>If pIndProbDensityAllOut is not NULL, then the SPK_VA::valarray&lt;double&gt; object pointed to by pIndProbDensityAllOut must be declared in the function that calls this function, but its input size does not matter. If pIndProbDensityAllOut is not NULL and this function completed the nonparametric method successfully, then the object pointed to by pIndProbDensityAllOut will contain the matrix of probability densities that were determined by the nonparametric method. The (i,j)-th element of the matrix will contain the probability density <img class="formulaInl" alt="$ p(y_i | b_j ) $" src="form_159.png"> for <img class="formulaInl" alt="$ y_i $" src="form_160.png"> given the individual parameter <img class="formulaInl" alt="$ b $" src="form_161.png"> is equal to the j-th atomic point, <img class="formulaInl" alt="$ b_j $" src="form_149.png">. Otherwise, this function will not attempt to change the contents of the object pointed to by pIndProbDensityAllOut.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pIndParPostMeanAllOut</em>&nbsp;</td><td>If pIndParPostMeanAllOut is not NULL, then the SPK_VA::valarray&lt;double&gt; object pointed to by pIndParPostMeanAllOut must be declared in the function that calls this function, and its size must be equal to the number of individuals <img class="formulaInl" alt="$ nInd $" src="form_158.png"> times the number of individual parameters <img class="formulaInl" alt="$ nB $" src="form_157.png">. If pIndParPostMeanAllOut is not NULL and this function completed the nonparametric method successfully, then the object pointed to by pIndParPostMeanAllOut will contain the matrix of posterior means of the individual parameters for each of the individuals that were determined by the nonparametric method. The i-th column of the matrix will contain a column vector that is the posterior mean for the i-th individual, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{b_i} = \mbox{E}[b | y_i ] = \frac{ \sum_{j=1}^{nMeasurePoint} \lambda_j * p(y_i | b_j ) * b_j } {\sum_{j=1}^{nMeasurePoint} \lambda_j * p(y_i | b_j) } . \]" src="form_162.png">
<p>
 Otherwise, this function will not attempt to change the contents of the object pointed to by pIndParPostMeanAllOut. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="predNonparamMethod_8cpp-source.html#l00196">196</a> of file <a class="el" href="predNonparamMethod_8cpp-source.html">predNonparamMethod.cpp</a>.
<p>
References <a class="el" href="PopPredModelBase_8cpp-source.html#l03983">PopPredModelBase&lt; Scalar &gt;::getEps()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l03965">PopPredModelBase&lt; Scalar &gt;::getEta()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02337">IndPredModelBase&lt; Scalar &gt;::getEta()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02301">IndPredModelBase&lt; Scalar &gt;::getIndPar()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02188">IndPredModelBase&lt; Scalar &gt;::getIndParLimits()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02285">IndPredModelBase&lt; Scalar &gt;::getNIndPar()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02355">IndPredModelBase&lt; Scalar &gt;::getOmega()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l03947">PopPredModelBase&lt; Scalar &gt;::getTheta()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02319">IndPredModelBase&lt; Scalar &gt;::getTheta()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l01365">PopPredModelBase&lt; Scalar &gt;::setOmega()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l01386">PopPredModelBase&lt; Scalar &gt;::setSigma()</a>, and <a class="el" href="PopPredModelBase_8cpp-source.html#l01348">PopPredModelBase&lt; Scalar &gt;::setTheta()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Mon Sep 10 10:13:35 2007 for SPK Pred Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
