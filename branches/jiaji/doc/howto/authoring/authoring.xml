<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
                  "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd"
[ <!ENTITY uw "University of Washington">
  <!ENTITY dept "Department of Bioengineering">
  <!ENTITY whitechuck '<systemitem class="systemname">whitechuck</systemitem>'>
]>
<article><title>Authoring RFPK Software Documents</title>  
 <articleinfo>
    <revhistory> 
      <revision>
	<revnumber>1.0</revnumber>
	<date>May 16, 2003</date> 
	<authorinitials>afw</authorinitials>
	<revremark>Initial version.</revremark>
      </revision>
      <revision>
	<revnumber>1.01</revnumber>
	<date>January 4, 2004</date>
	<authorinitials>afw</authorinitials>
	<revremark>Relative to RHEL 3.</revremark> 
      </revision>
      <revision>
	<revnumber>1.02</revnumber>
	<date>January 4, 2004</date>
	<authorinitials>afw</authorinitials>
	<revremark>SGML_CATALOG_FILES must be set for xhtml editing.</revremark>
      </revision>
    </revhistory>
  <abstract>
      <para>
	Docbook XML is the preferred format for RFPK Software
	documents, for reasons of efficiency, standardization,
	maintainability and ease of publishing.  This tutorial
	explains how to get set up to use Docbook, how to 
	to create new documents, how to edit documents
	with Emacs, how to make diagrams with Dia, how to check
	spelling, how to publish 
	completed documents to the Software Team web page, how to
	archive document versions in CVS, and how to interface with
	Microsoft Word.
      </para>
  </abstract>
 </articleinfo>
  <sect1>
    <title>Introduction</title>
    <para>
      RFPK software documents fall into two categories:
      <itemizedlist>
	<listitem>
	  <para>
	    <emphasis>Documents generated by development tools.</emphasis>
	    Prime examples are the documents created by 
	    Doxygen and JavaDoc.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis>Documents authored by Software Team members.</emphasis>
	    Such documents may include material prepared with the help of
	    tools, such as Dia, the diagramming tool,
	    but they are not generated automatically.
	  </para>
	</listitem>
      </itemizedlist>
      This <emphasis>howto</emphasis> is concerned exclusively with the
      latter case.
    </para>
    <para>
      As a rule, all authored software documents should be written in one
      or another of the following XML markup languages:
      <itemizedlist>
	<listitem>
	  <para>
	    Docbook
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Xhtml
	  </para>
	</listitem>
      </itemizedlist>
    </para>
    <para>
      Docbook is designed for technical
      articles and books.  The language contains a
      large collection of elements useful in technical documents.
      Elements are defined in a Document Type Definition (DTD), which 
      itself is an XML document.  The DTD makes it possible to validate
      a document, insuring that only valid elements are used and that the
      correct hierarchy of elements is observed.  From a valid Docbook
      document, output in a number of formats can be automatically generated,
      include <emphasis>html</emphasis>, <emphasis>pdf</emphasis>
      and <emphasis>rtf</emphasis>.
    </para>
    <para>
      Xhtml is used to create Web documents that are neither books
      nor articles. Xhtml is very similar to Html,
      for which it is a replacement.  Over the years, the definition of
      Html has become murky, as various browser vendors have added their
      own proprietary features.  Xhtml, by contrast, is defined by a 
      DTD.  Unlike a Docbook document,
      an Xhtml document does not have to be processed before it
      is placed on the web.
    </para>
    <para>
      The existence of DTDs for both Docbook and Xhtml make it possible to
      configure Emacs as a powerful language-specific
      XML editor.  A Docbook or Xhtml document contains in its preamble
      a reference to its DTD file.  When Emacs opens a document, it
      first reads and parses the DTD.  From that point onward, Emacs
      knows which elements are valid at each point in the document. It can
      provide you with a list of valid elements, automatically insert
      markup tags, nicely indent elements and content, and perform
      many other XML-specific and DTD-specific services.
    </para>
    <para>
      Authored RFPK software documents fall into several categories:
      <itemizedlist>
	<listitem>
	  <para>
	    <emphasis>Howto.</emphasis> 
	    The current document is a typical
	    example. A howto is a tutorial which
	    explains some practical method or process.  
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis>White Paper.</emphasis>
	    A white paper is typically more general and high-level than
	    a howto.  A white paper can explain the theory behind a
	    process or group of processes.  It can present the rationale
	    for an important decision.  It can suggest or define a course
	    of action.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    <emphasis>Decision Research.</emphasis>
	    Developing software involves making many decisions where
	    one alternative is chosen from among several possibilities.
	    A decision research document summarizes supporting evidence
	    for a development decision, including prototyping, benchmarking,
	    and summarizing best practices or opinions of respected
	    experts.
	  </para>
	</listitem>
      </itemizedlist>
    </para>
    <para>
      To improve the efficiency of creating and publishing authored 
      software documents and to foster standardization, a set of 
      processes have been developed for each of the document types
      listed above.  Specific details of these processes will be
      described in this howto.
    </para>
    <para>
      RPFK software documents are primarily published to the 
      Software Team web page.  The page of links to these documents
      is written in Xhtml.  Each time a document is published
      for the first time, it is necessary to edit the Xhtml
      file.  The process for doing this is also described, below.
    </para>
    <para>
      Sometimes, the whole or parts of an RFPK software document
      must be included in a Microsoft Office document. Grant
      proposals are a good example.  This howto also describes
      the process for making a software document accessible
      to Microsoft Office.
    </para>
    <para>
      All RFPK software documents are under CVS version control.
      The process for maintaining this control is also described
      in this document.
    </para>
    <para>
      In the sections that follow, we will demonstrate the process of
      authoring a document, from initial creation, to publishing on
      the Software Team web site.  A hypothetical example is used,
      which is a howto about the way the Software Team uses the
      Perl language for processing XML.  Our example could have been
      a white paper or a decision research paper just as well.  The 
      process would be the same in each case.
    </para>
  </sect1>
  <sect1>
    <title>Configuring Your Workstation</title>
    <para>
      Your workstation will need a bit of configuration in order
      to use the tools and framework described in this paper. 
    </para>
    <sect2>
      <title>Prerequisites</title>
      <para>
	It is assumed that the operating system for your workstation
	is Redhat Enterprise Linux, version 3.  You must have the following
	packages installed to process Docbook texts:
	<simplelist type='vert' columns='1'>
	  <member>
	    docbook-style-dsssl
	  </member>
	  <member>
	    docbook-dtds
	  </member>
	  <member>
	    docbook-utils-pdf
	  </member>
	  <member>
	    docbook-style-xsl
	  </member>
	  <member>
	    docbook-utils
	  </member>
	</simplelist>
      </para>
      <para>
	These packages should already be installed in your workstation.
	To determine whether or not they are, use the command
	<command>rpm -qa | grep -i docbook</command>, in order to get
	a list of all installed packages that have docbook in their
	names.  If any are missing, you should download them from the
	<ulink url="http://www.redhat.com/software/rhn/">
	  RedHat Network
	</ulink> 
	web site. 
      </para>
    </sect2>
    <sect2>
      <title>Emacs Configuration File</title>
      <para>
	When Emacs starts up, it reads configuration information from
	a file, named <filename>.emacs</filename> or 
	<filename>_emacs</filename>, that it finds in the user's
	home directory.  If you have not already done so, you can
	download the configuration information that you need from 
	&whitechuck;, and concatenate it to your current 
	<filename>.emacs</filename> file.
      </para>
      <para>
	As an ordinary user:
	<screen>
cd
scp whitechuck:/opt/download/dot.emacs .
cat dot.emacs >> .emacs
rm dot.emacs
	</screen>
      </para>
    </sect2>
    <sect2>
      <title>XHMTL Configuration</title>
      <para>
	In order to use Emacs to edit Xhtml files, you will need to 
	install a package and one additional file.
      </para>
      <para>
	Starting as an ordinary user and then switching to the
	super user:
	<screen>
cd
scp whitechuck:/opt/download/xhtml1.soc .
su 
mv xhtml1.soc /usr/share/sgml/xhtml1/xhtml1-20020801/DTD
	</screen>
      </para>
    </sect2>
    <sect2>
      <title>SGML_CATALOG_FILES Environment Variable</title>
      <para>
	In order to parse xml files, emacs must have access to their
	document type definition (DTD) files. To discover their location,
	emacs consults catalog files.  The contents of the 
	<varname>SGML_CATALOG_FILES</varname> environment variable is a
	list of pathnames of catalog files to be considered.
      </para>
      <para>
	Edit your <filename>~/.bash_profile</filename> to define this 
	variable, giving it the pathname of the catalog for xhtml:
	<screen>
SGML_CATALOG_FILES=/usr/share/sgml/xhtml1/xhtml1-20020801/DTD/xhtml1.soc
	</screen>
      </para>
      <para>
	The DTDs for parsing docbook are in the rpm package <filename>docbook-dtds</filename>.
	This package also contains a hierarchy of catalog files for each of
	the major versions of docbook that are supported.
      </para>
      <para>
	The base catalogs
	are in the directory <filename>/etc/sgml/</filename>.
	List this directory:
	<screen>
ls /etc/sgml/
	</screen>
	Add a line to your <filename>~/.bash_profile</filename> 
	to append to <varname>SGML_CATALOG_FILES</varname> the pathname
	of the catalog for each
	version of docbook being used at RFPK, then export the variable:
	<screen>
SGML_CATALOG_FILES=$SGML_CATALOG_FILES:/etc/sgml/xml-docbook-4.2-1.0-25.cat
SGML_CATALOG_FILES=$SGML_CATALOG_FILES:/etc/sgml/xml-docbook-4.3-1.0-25.cat
export SGML_CATALOG_FILES
	</screen>
      </para>
      <para>
	<emphasis>Note:</emphasis> the above contents of for
	<varname>SGML_CATALOG_FILES</varname> is just an example.  Each time
	a new version of <filename>docbook_dtds</filename> is released, the
	pathnames of the catalogs is apt to change and, consequently, you
	will have to reedit the environment variable in your
	<filename>~/.bash_profile/.</filename>
      </para>
    </sect2>
    <sect2>
      <title>SSH Configuration</title>
      <para>
	RFPK software documents are all built in a directory structure
	that is contained in the CVS repository <filename>r2</filename>.
	To create a new document, you <command>cd</command> to the 
	appropriate directory for the type article you are about to
	write and then execute a shell script called 
	<command>newdoc.sh</command>.  The script will create a directory
	for the document containing, among other files, a 
	<filename>Makefile</filename>.  If you execute the command
	<command>make install</command> in that directory, the
	secure file transfer utility <command>scp</command> will be used
	to publish your document on the web by copying a
	<filename>.html</filename> file, a <filename>.pdf</filename> file
	and a <filename>.rtf</filename> file to the SPK webserver.
	For this to work smoothly, you need to configure ssh so that
	connections can be established between your workstation and the
	webserver without having to provide a password.  Information on
	how to do this can be found in the 
	<ulink url="../ssh/ssh.html#workstation-conf">
	  SSH Configuration Howto
	</ulink>.
      </para>
    </sect2>
  </sect1>
  <sect1>
    <title>Starting a New Document</title>
    <para>
      All work on RFPK software documents should be performed in 
      the CVS workspace on your workstation.  If you do not have a CVS
      workspace, consult the RFPK
      <ulink url="../cvs/cvs.html">
	CVS Howto
      </ulink>
      for details.
    </para>
    <sect2>
      <title>The CVS Workspace</title>
      <para>
	Within your CVS workspace, the directory hierarchy which we are 
	interested in looks like this:
	<screen>
r2
    doc
	  decision
	  guide
	  howto
	  schedule
	  specs
	  stylesheet
	  whitepaper
    web
	</screen>
      </para>
      <para>
	Various directories are dedicated to the following:
	<glosslist>
	  <glossentry>
	    <glossterm>doc/decision</glossterm>
	    <glossdef>
	      <para>
		Decision research papers.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>doc/guide</glossterm>
	    <glossdef>
	      <para>
		Guides concerning software development processes.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>doc/howto</glossterm>
	    <glossdef>
	      <para>
		Howto tutorials.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>doc/schedule</glossterm>
	    <glossdef>
	      <para>
		Schedule of milestones.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>/doc/specs</glossterm>
	    <glossdef>
	      <para>
		Spk specifications.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>doc/stylesheet</glossterm>
	    <glossdef>
	      <para>
		The locally modifiable stylesheet. Changes to the
		<filename>local.dsl</filename> file will affect the appearance
		of all RFPK software documents.
	      </para>
	      <para>
		Do not modify <filename>local.dsl</filename> unless you
		know what you are doing and have reached a consensus
		in the Software Team.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>doc/whitepaper</glossterm>
	    <glossdef>
	      <para>
		White papers.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>web</glossterm>
	    <glossdef>
	      <para>
		Html tree for the Software Team web page.
	      </para>
	    </glossdef>
	  </glossentry>
	</glosslist>
      </para>
    </sect2>
    <sect2>
      <title>Creating an Empty Document</title>
      <para>
	First you need to come up with a title for your new document,
	and then distill that into an identifier that expresses the
	subject of the paper.  In our example, the title will be
	<emphasis>Perl Processing of XML</emphasis> and the subject
	will be <emphasis>perl-xml</emphasis>.
      </para>
      <para>
	Go to the directory designated for the type of document that you
	are about to produce and execute the 
	<command>newdoc.sh</command> shell script to create the
	directory and directory contents that you need:
	<screen>
cd howto
sh newdoc.sh perl-xml
cd perl-xml	  
	</screen>
      </para>
      <para>
	You will find that the new directory contains two files:
	<screen>
doc
    howto
	  perl-xml
	      perl-xml.xml
	      Makefile
	</screen>
      </para>
      <para>
	The file <filename>perl-xml.xml</filename> is the skeleton of
	your new document.  It looks like this:
	<screen>
&lt;?xml version="1.0"?>
&lt;!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
	  "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd"[
  &lt;!ENTITY uw "University of Washington">
  &lt;!ENTITY dept "Department of Bioengineering">
]>
&lt;article>&lt;title>perl-xml&lt;/title>
 &lt;articleinfo>
    &lt;revhistory>
      &lt;revision>
	&lt;revnumber>1.0&lt;/revnumber>
	&lt;date>July 4, 1776&lt;/date>
	&lt;authorinitials>???&lt;/authorinitials>
	&lt;revremark>Initial version.&lt;/revremark>
      &lt;/revision>
    &lt;/revhistory>
  &lt;abstract>
      &lt;para>
      &lt;/para>
  &lt;/abstract>
 &lt;/articleinfo>
  &lt;sect1>
    &lt;title>&lt;/title>
    &lt;para>
    &lt;/para>
  &lt;/sect1>
&lt;/article>
	</screen>
      </para>
    </sect2>
    <sect2>
      <title>First Modifications</title>
      <para>
	When you open this file with Emacs, a status message should appear
	in the mini-buffer at the bottom of the frame, telling you that 
	Emacs is parsing the DTD.  You should then see the following menus added
	to the menu bar at the top of the frame:
	<guimenu>SGML</guimenu>,
	<guimenu>Modify</guimenu>,
	<guimenu>Move</guimenu>,
	<guimenu>Markup</guimenu>,
	<guimenu>View</guimenu> and
	<guimenu>DTD</guimenu>.
      </para>
      <para>	
	The first thing you will want to do is edit a few lines which
	have been given default values in the starting template.
      </para>
      <para>
	Replace
	<screen>
&lt;article>&lt;title>perl-xml&lt;/title>
	</screen>
	with the full title
	<screen>
&lt;article>&lt;title>Perl Processing of XML&lt;/title>
	</screen>
      </para>
      <para>
	Modify
	<screen>
&lt;date>July 4, 1776&lt;/date>
	</screen>
	to show your expected date of publication.
      </para>
      <para>
	Modify
	<screen>
&lt;authorinitials>???&lt;/authorinitials>
	</screen>
	to show your own initials.
      </para>
      <para>
	Provide the section-one title
	<screen>
&lt;title>&lt;/title>
	</screen>
	with a non-empty title.
      </para>
    </sect2>
    <sect2>
      <title>Viewing Your First Steps</title>
      <para>
	Now you should verify that everything is configured properly,
	and that your initial changes were successful.
	<orderedlist>
	  <listitem>
	    <para>
	      Process the file
	      <screen>
<guimenu>Tools</guimenu> => <guimenuitem>Compile</guimenuitem>
	      </screen>
	      You will see in the mini-buffer the message
	      <screen>
Compile command: make -k
	      </screen>
	      Press the <keycap>Enter</keycap> key and the Docbook infrastructure
	      will produce three output files:
	      <filename>perl-xml.html</filename>,
	      <filename>perl-xml.pdf</filename>,
	      <filename>perl-xml.rtf</filename>.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Open the newly created <filename>perl-xml.html</filename> file
	      with your browser.  (You will need to enter the absolute path name
	      in the URL window at the top of your browser window.)
	    </para>
	    <para>
	      While writing in Docbook, it is very convenient to leave the
	      browser pointed to your document.  You should reprocess your
	      file often, to make sure that you have not made changes that
	      violate the Docbook structure.  If you alter the command in
	      the minibuffer to be <command>make html</command>, you will
	      only produce a .html file, which will save time.  Then you
	      can click the <guibutton>Reload</guibutton> button in the
	      browser to view your modified output.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      You can also view your .pdf output with Acroread and your
	      .rtf output with Open Office. It will slow down your 
	      document development if you check all formats every time
	      you make a few additions.  Checking .html with a browser
	      is the most efficient way to work.
	    </para>
	  </listitem>
	</orderedlist>
      </para>
    </sect2>
  </sect1>
  <sect1>
    <title>Building Your Document</title>
    <para>
      Now that you have the skeleton of a document, the real fun begins. The
      best way to proceed is iteratively.  Add a few paragraphs or other 
      elements to your paper, process it, and view it with the browser.  Repeat,
      until done.
    </para>
    <sect2>
      <title>Sources of Information about Docbook</title>
      <para>
	A Docbook article or book is constructed as a hierarchy of
	elements.  The best source of information about these elements
	is the book
	<ulink url=
	  "../../../../soft/books/html/tdg/en/html/docbook.html">
	  Docbook the Definitive Guide
	</ulink>, by Norman Walsh and Leonard Muellner. 
      </para>
      <para>
	Docbook contains a lot of elements.  It is unlikely that you will need more than
	a few dozen of these.  A good way to learn what you actually do need is to look
	at the XML source of existing RFPK software documents. 
	You will find copies of all of them in your CVS workspace.
      </para>
    </sect2>
    <sect2>
      <title>Using Emacs</title>
      <para>
	You will find Emacs to be a very powerful tool for building 
	XML documents.
	Use the 
	<guimenu>Markup</guimenu> menu to insert elements.  Emacs will only
	let you insert elements that are valid at the point that you are
	editing. That way your document will stay valid as it grows. Having
	Emacs generate tag pairs really speeds things up.  If you already have
	a good idea of what element you want, you can use the (C-c C-e) 
	keystroke sequence for even greater efficiency.  Just type a few 
	leading characters, hit <keycap>Enter</keycap>, and Emacs will 
	automatically complete the tag name and insert the tag pair.
      </para>
    </sect2>
    <sect2>
      <title>Checking Spelling, with Emacs and Ispell</title>
      <para>
	Emacs is interfaced to the Unix Ispell utility to
	provide spell checking for your document.  The following
	menu sequence will initiate spell checking of your entire
	document.
	<screen>
	  <guimenu>Tools</guimenu> => <guimenu>Spell Checking</guimenu> => <guimenuitem>Spell Check Buffer</guimenuitem>
	</screen>
      </para>
      <para>
	Emacs will high-light the first word-like token in your text
	that Ispell is not sure of.  A window presenting choices will
	open at the top of the screen, and the mini-buffer at the 
	bottom of the screen will contain help information.
      </para>
      <para>
	Often the high-lighted token is not mis-spelled.  It is simply not 
	in Ispell's dictionary.  Here are some of your choices, when this
	occurs:
	<glosslist>
	  <glossentry>
	    <glossterm>Digit</glossterm>
	    <glossdef>
	      <para>
		Enter the digit, digits, or other symbol which corresponds to 
		one of the choices at the top of the frame.  The corresponding
		word will replace the high-lighted word.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm><keycap>Space</keycap></glossterm>
	    <glossdef>
	      <para>
		Accept the word this time.  Each time the word appears
		in the remainder of your paper, it will be high-lighted
		again.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>a</glossterm>
	    <glossdef>
	      <para>
		Accept the word for this entire editing session.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>A</glossterm>
	    <glossdef>
	      <para>
		Accept this word, and add it to a special dictionary
		concatenated to the end of the document. It 
		will be considered correct for the life of the
		document.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>i</glossterm>
	    <glossdef>
	      <para>
		Accept this word, and add it to your personal 
		dictionary.
	      </para>
	    </glossdef>
	  </glossentry>
	  <glossentry>
	    <glossterm>x</glossterm>
	    <glossdef>
	      <para>
		Exit from the spell checker.  Return to the 
		originally editing point in your document.
	      </para>
	    </glossdef>
	  </glossentry>
	</glosslist>
      </para>
      <para>	
	There are a lot of additional commands.  Check them out in 
	the <guimenu>Spell Checking</guimenu> menu. 
      </para>
    </sect2>
    <sect2>
      <title>XML General Entities</title>
      <para>
	General entities are both a necessary and a useful part of XML.  
	They can be thought of as a kind of simple replacement macro.
	You place the markup for the entity in your document and
	it is replaced with other text and markup.  
      </para>
      <sect3>
	<title>Predefined Entities</title>
	<para>
	  The following five symbols have special meaning in XML, because
	  they are part of the markup syntax:
	  <simplelist type="vert" columns="5" >
	    <member>&amp;</member>
	    <member>&apos;</member>
	    <member>&gt;</member>
	    <member>&lt;</member>
	    <member>&quot;</member>
	  </simplelist>
	  There are five predefined entities, corresponding to these symbols.
	  When you place the markup for one of these symbols in your 
	  document, you avoid confusing the XML parser, and the symbol
	  itself appears in your output.
	  <glosslist>
	    <glossentry>
	      <glossterm>&amp;amp;</glossterm>
	      <glossdef>
		<para>
		  Ampersand (&amp;)
		</para>
	      </glossdef>
	    </glossentry>
	    <glossentry>
	      <glossterm>&amp;apos;</glossterm>
	      <glossdef>
		<para>
		  Single quotation mark; apostrophe (&apos;)
		</para>
	      </glossdef>
	    </glossentry>
	    <glossentry>
	      <glossterm>&amp;gt;</glossterm>
	      <glossdef>
		<para>
		  Greater-than sign (&gt;)
		</para>
	      </glossdef>
	    </glossentry>
	    <glossentry>
	      <glossterm>&amp;lt;</glossterm>
	      <glossdef>
		<para>
		  Less-than sign (&amp;)
		</para>
	      </glossdef>
	    </glossentry>
	    <glossentry>
	      <glossterm>&amp;quot;</glossterm>
	      <glossdef>
		<para>
		  Double quotation mark (&quot;)
		</para>
	      </glossdef>
	    </glossentry>
	  </glosslist>
	</para>
	<para>
	  You must always use &amp;lt; and the &amp;amp;.  The others are optional
	  in most contexts.  Just keep in mind, that if a parser complains
	  about one of these symbols, you will have to replace it with
	  its entity markup.
	</para>
      </sect3>
      <sect3>
	<title>User Defined Entities</title>
	<para>
	  You can define your own entities.  Consider the preamble to 
	  the template that you used to start your document:
	  <screen>
&lt;?xml version="1.0"?>
&lt;!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
	    "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd"[
  &lt;!ENTITY uw "University of Washington">
  &lt;!ENTITY dept "Department of Bioengineering">
]>
	  </screen>
	</para>
	<para>
	  The space between the two square brackets, [ and ], 
	  is reserved for user additions to the DTD.  Inside of
	  those brackets, two general entities are defined:
	  <emphasis>uw</emphasis> and <emphasis>dept</emphasis>.
	  Here is an example of markup using them,
	  <screen>
RFPK, a project in the &amp;dept; of the &amp;uw;.
	  </screen>
	  and here is the output generated:
	  <screen>
RFPK, a project in the &dept; of the &uw;.
	  </screen>
	</para>
	<para>
	  Using these two entities could save time and effort, if 
	  the two phrases appeared often within your document. 
	  User defined entities can be more than a convenience,
	  however. Consider for example, the server named
	  &whitechuck;.  The name comes from that of a river
	  in Western Washington.  If you simply place that name in your
	  documents and they are published to the Web, your site
	  might draw traffic from people interested in hiking
	  or white water kayaking.  This was not your intention,
	  and it is a waste of both resources and other other
	  people's time.  It would be better to 
	  <emphasis>semantically mark</emphasis> the name
	  &whitechuck; to indicate that it refers to a computer
	  rather than anything else.  
	</para>
	<para>
	  The semantic markup to designate &whitechuck; as a
	  computer system looks like this:
	  <screen>
&lt;systemitem class="systemname">whitechuck&lt;/systemitem>
	  </screen>
	</para>
	<para>
	  Not only is this a lot to write, but you want to be
	  sure that you refer to &whitechuck; the same way
	  every time.  Here is where a user defined entity 
	  can provide standardization in addition to
	  convenience.  The entity would look like this (shown
	  in the context of the document type declaration):
	  <screen>
&lt;!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
	    "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd"[
    &lt;!ENTITY whitechuck '&lt;systemitem class="systemname">whitechuck&lt;/systemitem>'>
]>
	  </screen>
	  <emphasis>
	    Note the single quotes around the replacement text, 
	    which allow double quotes to be used for the
	    class attribute value.
	  </emphasis>
	</para>
	<para>
	  Once the &whitechuck; entity has been defined, it is easy
	  to include it in the document.  For example, you might
	  write the following:
	  <screen>
Copy the file to &amp;whitechuck;.  Every time a Web user references
the home page on &amp;whitechuck;, the file will be executed. If
&amp;whitechuck; is down, blah, blah, blah.
	  </screen>
	</para>
      </sect3>
    </sect2>
  </sect1>
  <sect1>
    <title>Adding Diagrams to Your Document</title>
    <para>
      In principal, any sort of graphics image can be added to a 
      Docbook document.  This includes diagrams, photographs,
      and any sort of bitmap.  It is easy for the author to do
      this.  The hard work falls upon the infrastructure to
      scale the image appropriately for both the Web formats
      (html) and printed page formats (pdf, rtf).  At present
      this does not always work. 
    </para>
    <para>
      With the infrastructure currently used by the
      Software Team, one reliable way to include diagrams in
      documents is to create them with Dia, an Open 
      Source diagramming tool that bears some resemblance
      to Visio. Although part of Gnu Office, Dia is not included
      in the RedHat Enterprise Linux Distribution, hence it must
      be installed separately.
    </para>
    <sect2>
      <title id="install_dia">Installing Dia</title>
      <para>
	An rpm file for Dia is in the <filename>/opt/download</filename>
	directory on <emphasis>whitechuck</emphasis>. In a terminal
	window, as an ordinary user:
	<screen>
scp 'whitechuck:/opt/download/dia*rpm' .
su
rpm -Uhv dia*rpm
rm dia*rpm
cd /usr/lib
	</screen>
      </para>
    </sect2>
    <sect2>
      <title>Using Dia</title>
      <para>
	Dia can be started with the 
	<guimenu>Main</guimenu> =>
	<guimenu>Graphics</guimenu> =>
	<guimenuitem>Dia</guimenuitem>
	menu sequence.
	You can also launch it from a shell window in your document
	directory with the command <command>dia &amp;</command>.
      </para>
      <para>
	Dia is a mostly self-explanatory Gui application. A 
	description of the interface is beyond the scope of this
	document.  We do need to discuss the saving of files,
	however.  
	<itemizedlist>
	  <listitem>
	    <para>
	      <emphasis>
		Saving the diagram for addition to the CVS repository.
	      </emphasis>
	      <orderedlist>
		<listitem>
		  <para>
		    Locate the mouse pointer anywhere within your diagram,
		    then use the following mouse and menu
		    sequence to save the diagram:
		    <guimenu>right-click</guimenu> =>
		    <guimenu>File</guimenu>
		    <guimenuitem>Save As</guimenuitem>
		  </para>
		</listitem>
		<listitem>
		  <para>
		    In the window that pops up, un-check the
		    <guilabel>Compress diagram files</guilabel> check
		    box.
		  </para>
		</listitem>
		<listitem>
		  <para>
		    In the <guilabel>Selection</guilabel> box, type
		    in a name for this figure, and then click
		    <guibutton>OK</guibutton>.
		  </para>
		</listitem>
	      </orderedlist>
	      The file will be saved as XML.  Because XML is a
	      text format, it can be readily maintained in CVS.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      <emphasis>Saving output for inclusion in your document.</emphasis>
	      <orderedlist>
		<listitem>
		  <para>
		    Locate the mouse pointer anywhere within your diagram,
		    then use the following mouse and menu sequence to 
		    produce output for inclusion in your document:
		    <guimenu>right-click</guimenu> =>
		    <guimenu>File</guimenu>
		    <guimenuitem>Export</guimenuitem>
		  </para>
		</listitem>
		<listitem>
		  <para>
		    In the <guilabel>Determine File Type</guilabel> selection
		    list of the window that pops up, choose
		    <guimenuitem>Portable Network Graphics (*.png)</guimenuitem>.
		  </para>
		</listitem>
		<listitem>
		  <para>
		    In the <guilabel>Selection</guilabel> box, the file name
		    should be the same one under which you saved the
		    diagram.  If not, change it so that the two names match,
		    then click <guibutton>OK</guibutton>.
		  </para>
		</listitem>
	      </orderedlist>
	    </para>
	  </listitem>
	</itemizedlist>
      </para>
      <para>
	A good way to add a diagram to your document is to use the
	<emphasis>figure</emphasis> Docbook element.  Here is an
	example:
	<screen>
&lt;figure>
&lt;title>Three Tiered Architecture&lt;/title>
&lt;graphic scale="60" fileref="arch.png"/>
&lt;/figure>
	</screen>
	The "scale" attribute requests the formatter to include the 
	diagram at 60% of its original size.  With your diagrams,
	you will need to experiment with this number, until things
	look right.
      </para>

    </sect2>
  </sect1>
  <sect1>
    <title>Publishing Your Document</title>
    <para>
      To publish your document to the Software Team web site,
      you need to do two things:
      <orderedlist>
	<listitem>
	  <para>
	    Install the output files on the web server.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Add links to the web page.
	  </para>
	</listitem>
      </orderedlist>
    </para>
    <sect2>
      <title>Installing to the Web Server</title>
      <para>
	Before installing to the Web Server, you should be
	sure that your document is complete.  When you are
	satisfied with it, generate the output one last 
	time, then install.  In the document directory:
	<screen>
make clean
make
make install
	</screen>
      </para>
      <para>
	You can invoke the <command>make</command> commands
	listed above either from the command line 
	from inside Emacs, via the
	<guimenu>Tools</guimenu> => <guimenuitem>Compile</guimenuitem>
	menu selection.  
      </para>
      <para>
	The .html file, the .pdf file and all .png files 
	will be copied to the appropriate directory on
	&whitechuck; by <command>make install</command>.
      </para>
    </sect2>
    <sect2>
      <title>Adding Links to the Web Page</title>
      <para>
	In the directory <filename>r2/web</filename>
	of your CVS workspace, edit the file
	<filename>index.html</filename> with emacs.
	Find the links to other documents of the same
	type as your document, clone one of them,
	then change the references to designate your
	document name.
      </para>
    </sect2>
  </sect1>
  <sect1>
    <title>Adding Your Document to the CVS Repository</title>
    <para>
      The final step in creating a new document should be the
      placing of it in the CVS repository.  In this example,
      once again, we assume that your document name is
      <filename>perl-xml</filename>.  
    </para>
    <para>
      Starting in the your document directory
      (<filename>perl-xml</filename>):
      <screen>
	cd ..
	cvs add perl-xml
	cd perl-xml
	cvs add perl-xml.xml
	cvs add Makefile
	cvs add *.png         # if you have an .png image files
      </screen>
    </para>
    <para>
      At this point, everything has been added to your local
      workspace, but the changes have not yet been made to
      the repository on &whitechuck;.  To accomplish that:
      <screen>
	cd ..
	cvs commit
      </screen>
    </para>
  </sect1>
  <sect1>
    <title>Compatibility with Microsoft Office</title>
    <para>
      In the directory for your document, <command>make install</command>
      copies the .html and .pdf output files to the Software Team
      web page.  It does not, however, do anything with the .rtf output
      file.  The purpose of that file is to facilitate the inclusion
      of your document, either whole or in part, in a Microsoft Office
      document.
    </para>
    <para>
      You do not need to do anything with the .rtf file until it 
      is needed for a Microsoft Office document.  At that time
      you will need to transfer the .rtf output, along with any associated
      image files, to a workstation running Microsoft Office.  You
      can do this in a number of ways: attaching the files to email, 
      transferring them on a floppy disk, sending them via the
      <command>ssh</command>,
      etc.
      In Microsoft Office, just open the .rtf file. Office should
      be able to integrate your image files.  You may, however,
      need to use Office to manipulate the scaling of the images.
      Finally, save the file as a Microsoft-standard .doc file.
    </para>
  </sect1>
</article>

<!--  LocalWords:  minibuffer systemitem systemname xml DOCTYPE DocBook uw RFPK
 -->
<!--  LocalWords:  whitechuck articleinfo revhistory revnumber authorinitials
 -->
<!--  LocalWords:  revremark itemizedlist listitem Doxygen JavaDoc Dia howto
 -->
<!--  LocalWords:  Docbook Xhtml DTD html pdf rtf DTDs RPFK CVS Redhat vert url
 -->
<!--  LocalWords:  simplelist docbook RedHat ulink XHMTL stylesheet whitepaper
 -->
<!--  LocalWords:  glosslist glossentry glossterm glossdef perl guimenu keycap
 -->
<!--  LocalWords:  orderedlist guimenuitem guibutton Acroread Visio guilabel
 -->
<!--  LocalWords:  png fileref
 -->
