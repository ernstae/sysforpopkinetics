<?xml version="1.0"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
[
  <!ENTITY uw "University of Washington">
  <!ENTITY dept "Department of Bioengineering">
]>
<article><title>Backup to Whitechuck</title>
 <articleinfo>
    <revhistory>
      <revision>
	<revnumber>1.0</revnumber>
	<date>April 22, 2003</date>
	<authorinitials>afw</authorinitials>
	<revremark>Initial version.</revremark>
      </revision>
    </revhistory>
  <abstract>
    <para>
	The installation of a simple method to back up 
	workstations to a remote server (the host whitechuck)
	is described.
    </para>
  </abstract>
 </articleinfo>
  <sect1>
    <title>Prerequisites</title>
    <para>
      Before attempting this installation, you should already have
      followed the installation processes in the following RFPK
      HOWTO documents:
      <itemizedlist>
	<listitem>
	  <para>
	    SSH Configuration HOWTO
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Electronic Notification HOWTO
	  </para>
	</listitem>
      </itemizedlist>
    </para>
  </sect1>
  <sect1>
    <title>Install the Shell Scripts</title>
    <para>
      In a shell window, issue the following commands:
      <screen format="linespecific">
cd
mkdir bin
cd bin
scp whitechuck:/opt/download/shell.tgz .
tar xvzf shell.tgz
rm shell.tgz
      </screen>
    </para>
  </sect1>
  <sect1>
    <title>Set Up get-agent-data To Run at Startup</title>
    <para>
      One of the scripts that you installed in the previous section
      must be run by the Gnome desktop at startup, after the running
      of <command moreinfo="none">ssh-add</command>.  The script,
      named <command moreinfo="none">get-agent-data</command>, 
      writes variable assignment statements (in shell script language) for
      the environment variables that have just been set by 
      <command moreinfo="none">ssh-agent</command> to a file, so that
      they can later be read by other shell scripts running under the
      cron batch scheduler.  
    </para>
    <para>
      Perform the following menu sequence:
	<screen format="linespecific">
	  <guimenu moreinfo="none">Main</guimenu> => <guimenu moreinfo="none">Extras</guimenu> => <guimenu moreinfo="none">Preferences</guimenu> => <guimenuitem moreinfo="none">Sessions</guimenuitem> => left-click
	</screen>
	This will open the <interface moreinfo="none">Sessions</interface>
	window.  Press the 
	<guibutton moreinfo="none">Startup Programs</guibutton> button
	followed by
	the <guibutton moreinfo="none">Add</guibutton> button.  Then
	set the following variables:
	<screen format="linespecific">
Startup Command: /home/<emphasis>username</emphasis>/bin/shell/get-agent-data
Priority: 75
	</screen>
      where <emphasis>username</emphasis> is your username.
      Close the window by pressing the
      <guibutton moreinfo="none">OK</guibutton> button.
    </para>
  </sect1>
  <sect1>
    <title>Edit Your Crontab</title>
    <para>
      The <command moreinfo="none">crontab -e</command> command will
      open up an editor window, so that you can edit your 
      <filename moreinfo="none">crontab</filename> file.  The default
      editor is <command moreinfo="none">vi</command>.  If you prefer
      <command moreinfo="none">emacs</command>, add the following
      two lines to your
      <filename moreinfo="none">~/.bash_profile</filename> file
      <screen format="linespecific">
EDITOR=emacs
export EDITOR
      </screen>
      and then restart your desktop.
    </para>
    <para>
      Execute the following command:
      <screen format="linespecific">
crontab -e
      </screen>
      and an <command moreinfo="none">emacs</command> window should
      appear, displaying the <filename moreinfo="none">crontab</filename>
      file, ready for editing.
    </para>
    <para>
      Add the following line:
      <screen format="linespecific">
30 2 * * 2-6 ~/bin/shell/backup-home-full
      </screen>
      close the file, 
      and your home directory will be backed up to
      <systemitem moreinfo="none" class="systemname">whitechuck</systemitem>
      at 2:30 AM of each morning that follows a weekday.
    </para>
  </sect1>
  <sect1>
    <title>Check Your Work</title>
    <para>
      If everything goes well, you should be able to log into
      <systemitem moreinfo="none" class="systemname">whitechuck</systemitem>
      the next morning and see the new file in the directory
      <filename moreinfo="none">~/backup</filename>.
      If errors occur, they will be sent to the mail box on your
      workstation, which you can read using
      <command moreinfo="none">pine</command>.
    </para>
  </sect1>
</article>

<!--  LocalWords:  HOWTO cd mkdir scp xvzf tgz cron Crontab crontab
 -->
