<html><head>
<title>Computing Statistics of Derived Parameter Estimates</title>
<meta name="description" id="description" content="Computing Statistics of Derived Parameter Estimates">
<meta name="keywords" id="keywords" content=" derparstatistics derived parameter covariance standard error correlation matrix ">
<style type='text/css'>
BODY { color : black }
BODY { background-color : white }
</style>
<script type='text/javascript' language='JavaScript' src='_derparstatistics_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="http://depts.washington.edu/rfpk" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>main</option>
<option>statistical</option>
<option>derParStatistics</option>
</select>
</td>
<td><a href="statisticsinactiveelem.htm" target="_top">Prev</a>
</td><td><a href="derparstatisticsfixedelem.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_down2(this)'>
<option>main-&gt;</option>
<option>Notes</option>
<option>SpkModel</option>
<option>individual</option>
<option>population</option>
<option>statistical</option>
<option>simulation</option>
<option>general</option>
<option>glossary</option>
</select>
</td>
<td>
<select onchange='choose_down1(this)'>
<option>statistical-&gt;</option>
<option>statistics</option>
<option>statisticsInactiveElem</option>
<option>derParStatistics</option>
<option>derParStatisticsFixedElem</option>
<option>calcMean</option>
<option>residuals</option>
<option>wres</option>
</select>
</td>
<td>derParStatistics</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Description</option>
<option>Return Value</option>
<option>Arguments</option>
</select>
</td>
</tr></table><br>




<center><b><big><big>Computing Statistics of Derived Parameter Estimates</big></big></b></center>
<table><tr><td align='left'  valign='top'>
<b>Prototype:</b> </td><td align='left'  valign='top'>

<code><font color="blue"><span style='white-space: nowrap'>void&nbsp;derParStatistics(<br>
&nbsp;&nbsp;const&nbsp;SPK_VA::valarray&lt;double&gt;&amp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>xCov</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;const&nbsp;SPK_VA::valarray&lt;double&gt;&amp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>z</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;const&nbsp;SPK_VA::valarray&lt;double&gt;&amp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>z_x</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>nDegFreedom</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;SPK_VA::valarray&lt;double&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>zCovOut</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;SPK_VA::valarray&lt;double&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>zSEOut</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;SPK_VA::valarray&lt;double&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>zCorOut</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;SPK_VA::valarray&lt;double&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>zCVOut</span></i><code><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;SPK_VA::valarray&lt;double&gt;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font></code><i><span style='white-space: nowrap'>zCIOut</span></i><code><font color="blue"><span style='white-space: nowrap'>&nbsp;);<br>
</span></font></code></td></tr>
</table>
<center><i>Copyright (C) 2002, University of Washington, Resource Facility for Population Kinetics. All Rights Reserved.

</i>
</center><code><span style='white-space: nowrap'><br>
</span></code><b><big><a name="Description" id="Description">Description</a></big></b>
<br>
This function calculates statistics for a parameter vector z(x) that
is derived from another parameter vector x with a known covariance
matrix.
The statistics for z(x) that can be calculated are its standard error
vector, correlation matrix, coefficient of variation vector, and
confidence interval vector.
<code><span style='white-space: nowrap'><br>
<br>
</span></code>The covariance matrix for the derived parameter is calculated as
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;<i>T</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>Cov</i>[&nbsp;<i>z</i>(<i>x</i>)&nbsp;]&nbsp;&nbsp;=&nbsp;&nbsp;|&nbsp;&nbsp;<i>d</i>&nbsp;&nbsp;&nbsp;<i>z</i>(<i>x</i>)&nbsp;&nbsp;|&nbsp;&nbsp;<i>Cov</i>[&nbsp;<i>x</i>&nbsp;]&nbsp;&nbsp;|&nbsp;&nbsp;<i>d</i>&nbsp;&nbsp;&nbsp;<i>z</i>(<i>x</i>)&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<i>x</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;<i>x</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<br>
<br>
</span></code>The standard error vector is calculated by taking the square roots 
of the diagonal elements of this covariance matrix.
The correlation matrix is calculated by dividing each element of 
the covariance matrix by the standard errors that correspond to its 
row and column.
The coefficients of variation are calculated as
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>CV</i>&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;<i>SE</i>&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;|&nbsp;<i>z</i>(<i>x</i>)&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;*&nbsp;100&nbsp;&nbsp;&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)<br>
<br>
</span></code>where CV is the coefficient of variation and SE is the standard error.  
The 95% confidence intervals are calculated as
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<i>z</i>(<i>x</i>)&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;<i>t</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;<i>SE</i>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;<i>z</i>(<i>x</i>)&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;&nbsp;<i>t</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;<i>SE</i>&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.025,&nbsp;<i>degFree</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.025,&nbsp;<i>degFree</i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<i>i</i>)<br>
<br>
</span></code>where
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<i>t</i><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.025,&nbsp;<i>degFree</i><br>
<br>
</span></code>is the critical value for the <code><span style='white-space: nowrap'><i>t</i></span></code> distribution with 
<code><span style='white-space: nowrap'><i>degFree</i></span></code> number of degrees of freedom for which the 
area under the <code><span style='white-space: nowrap'><i>t</i></span></code> curve is <code><span style='white-space: nowrap'>1&nbsp;-&nbsp;0.025</span></code>.
<code><span style='white-space: nowrap'><br>
<br>
</span></code>This function assumes that x and z(x) have the same number of
elements, n.

<br>
<br>
<b><big><a name="Return Value" id="Return Value">Return Value</a></big></b>
<br>
Upon a successful completion, the function sets the given output
value place holders to point to the result values.
  
<code><span style='white-space: nowrap'><br>
<br>
</span></code>If an error is detected or failure occurs during the evaluation, an
SpkException object will be thrown.  
The state after an exception is thrown is defined in 
<a href="glossary.htm#Exception Handling Policy" target="_top"><span style='white-space: nowrap'>Exception&nbsp;Handling&nbsp;Policy</span></a>
.

<br>
<br>
<b><big><a name="Arguments" id="Arguments">Arguments</a></big></b>

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>xCov</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>is an n * n dimensional vector that contains the covariance matrix for
x in column major order.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>z</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>is the n dimensional parameter vector z(x) that is derived from the
parameter vector x.  
Note that the number of elements in z specifies n.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>z_x</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>is an n * n dimensional vector that contains the derivative with
respect to x of the derived variable z(x) in column major order.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>nDegFreedom</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>is the number of degrees of freedom that is used to compute the
confidence intervals.  It should be set equal to m - n, where m is the
number of fitted data points.  The value must be greater than zero,
although it will not be referenced at all if zCIOut is set to NULL.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>zCovOut</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>will point to an n * n dimensional vector containing the covariance
matrix for the derived parameter Cov[z(x)] in column major order if
the pointer points to an n * n valarray.
If it points to NULL, it will remain unchanged.
If it points to a valarray sized other than n * n, the resulting
behavior is undetermined.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>zSEOut</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>will point to an n dimensional vector containing the standard errors
for z(x) if the pointer points to an n dimensional valarray.  
If it points to NULL, it will remain unchanged.
If it points to a valarray sized other than n, the resulting behavior
is undetermined.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>zCorOut</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>will point to an n * n dimensional vector containing the correlation
matrix for the derived parameter Cor[z(x)] in column major order if
the pointer points to an n * n valarray.
If it points to NULL, it will remain unchanged.
If it points to a valarray sized other than n * n, the resulting
behavior is undetermined.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>zCVOut</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>will point to an n dimensional vector containing the coefficients of variation
for z(x) if the pointer points to an n dimensional valarray.  
If it points to NULL, it will remain unchanged.
If it points to a valarray sized other than n, the resulting behavior
is undetermined.

<code><font color="blue"><span style='white-space: nowrap'><br>
<br>
</span></font></code><i><span style='white-space: nowrap'>zCIOut</span></i><code><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>will point to an n * 2 dimensional vector containing the 95%
confidence intervals if the pointer points to an n * 2 dimensional
valarray.
The first n elements are the lower bounds for the intervals, 
while the last n elements are the upper bounds.
If it points to NULL, it will remain unchanged.
If it points to a valarray sized other than n * 2, the resulting
behavior is undetermined.


<hr>Input File: ../../spk/derParStatistics.cpp

</body>
</html>
