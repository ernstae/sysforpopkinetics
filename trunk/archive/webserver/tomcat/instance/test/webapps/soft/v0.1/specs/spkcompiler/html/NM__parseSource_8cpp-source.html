<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Compiler API Documentation: NM_parseSource.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>NM_parseSource.cpp</h1><a href="NM__parseSource_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="NonmemTranslator_8h.html">NonmemTranslator.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "../SpkCompilerException.h"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include "explang.h"</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;xercesc/dom/DOMDocument.hpp&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;xercesc/dom/DOM.hpp&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;xercesc/util/XMLString.hpp&gt;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">using namespace </span>std;
<a name="l00016"></a>00016 <span class="keyword">using namespace </span>xercesc;
<a name="l00017"></a>00017 
<a name="l00019"></a>00019 <span class="comment">//</span>
<a name="l00020"></a>00020 <span class="comment">//  parseSource()</span>
<a name="l00021"></a>00021 <span class="comment">//  Analizes source.xml further in details.</span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 <span class="comment">//  Pre-conditions</span>
<a name="l00024"></a>00024 <span class="comment">//</span>
<a name="l00025"></a>00025 <span class="comment">//  * ClientTranslator::ourTarget is set to either POP or IND</span>
<a name="l00026"></a>00026 <span class="comment">//  * ClientTranslator::ourPopSize is set to the number of subjects.</span>
<a name="l00027"></a>00027 <span class="comment">// </span>
<a name="l00028"></a>00028 <span class="comment">//  Post-conditions</span>
<a name="l00029"></a>00029 <span class="comment">//</span>
<a name="l00031"></a><a class="code" href="classNonmemTranslator.html#86dbbd2988dc5670ccf3b279efe72ace">00031</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNonmemTranslator.html#86dbbd2988dc5670ccf3b279efe72ace">NonmemTranslator::parseSource</a>()
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00034"></a>00034   <span class="comment">// &lt;nonmem&gt;</span>
<a name="l00035"></a>00035   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00036"></a>00036   DOMElement  * spksouce = <a class="code" href="classClientTranslator.html#74f1c44721c69186839466a0bf6d7ca7">getSourceTree</a>()-&gt;getDocumentElement();
<a name="l00037"></a>00037   DOMNodeList * nonmems  = spksouce-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#d7ce16af14616b5c8ad7684d697c0305">X_NONMEM</a> );
<a name="l00038"></a>00038   <span class="keywordflow">if</span>( !nonmems-&gt;getLength() &gt; 0 )
<a name="l00039"></a>00039     {
<a name="l00040"></a>00040       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00041"></a>00041       snprintf( mess, 
<a name="l00042"></a>00042         SpkCompilerError::maxMessageLen(),
<a name="l00043"></a>00043         <span class="stringliteral">"Missing &lt;%s&gt; element."</span>, <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#54be49071d6e791d8722b2e63e4f2aa6">C_NONMEM</a> );
<a name="l00044"></a>00044       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e ( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00045"></a>00045       <span class="keywordflow">throw</span> e;
<a name="l00046"></a>00046     }
<a name="l00047"></a>00047   DOMElement * nonmem = dynamic_cast&lt;DOMElement*&gt;( nonmems-&gt;item(0) );
<a name="l00048"></a>00048 
<a name="l00049"></a>00049   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00050"></a>00050   <span class="comment">// &lt;constraint&gt;</span>
<a name="l00051"></a>00051   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00052"></a>00052   DOMNodeList * constraints = nonmem-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#869574ab70621181fb8b852a63c21db1">X_CONSTRAINT</a> );
<a name="l00053"></a>00053   <span class="keywordflow">if</span>( constraints-&gt;getLength() != 1 )
<a name="l00054"></a>00054     {
<a name="l00055"></a>00055       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>()];
<a name="l00056"></a>00056       snprintf( mess, 
<a name="l00057"></a>00057         SpkCompilerError::maxMessageLen(),
<a name="l00058"></a>00058         <span class="stringliteral">"Missing &lt;%s&gt; element."</span>, <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#bf3c1608ceeede2dae4302d970ec7d60">C_CONSTRAINT</a> );
<a name="l00059"></a>00059       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00060"></a>00060       <span class="keywordflow">throw</span> e;
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062   DOMElement * constraint = dynamic_cast&lt;DOMElement*&gt;( constraints-&gt;item(0) );
<a name="l00063"></a>00063   <span class="keywordflow">if</span>(  !constraint-&gt;hasChildNodes() )
<a name="l00064"></a>00064     {
<a name="l00065"></a>00065       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>()];
<a name="l00066"></a>00066       snprintf( mess, 
<a name="l00067"></a>00067         SpkCompilerError::maxMessageLen(),
<a name="l00068"></a>00068         <span class="stringliteral">"Missing &lt;%s&gt; or &lt;%s&gt; element."</span>, 
<a name="l00069"></a>00069         <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#370ab38bae5e5776ea4b4d61d6235eeb">C_POP_ANALYSIS</a>, 
<a name="l00070"></a>00070         <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#106fd821a9944e96b1e6448f896ec486">C_IND_ANALYSIS</a> );
<a name="l00071"></a>00071       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00072"></a>00072       <span class="keywordflow">throw</span> e;
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   DOMElement * analysis;
<a name="l00076"></a>00076   <span class="keywordtype">bool</span> isAnalysisDone = <span class="keyword">false</span>;
<a name="l00077"></a>00077   <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>() == POP )
<a name="l00078"></a>00078     {
<a name="l00079"></a>00079       DOMNodeList * pop_analysises = constraint-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#255c671050c75ead84726f565cb2f710">X_POP_ANALYSIS</a> );
<a name="l00080"></a>00080       analysis = dynamic_cast&lt;DOMElement*&gt;( pop_analysises-&gt;item(0) );
<a name="l00081"></a>00081       <a class="code" href="classNonmemTranslator.html#ba787383e8b62fccded44d798268460b">parsePopAnalysis</a>( analysis );
<a name="l00082"></a>00082     }
<a name="l00083"></a>00083   <span class="keywordflow">else</span> <span class="comment">//if( getTarget() == IND )</span>
<a name="l00084"></a>00084     {
<a name="l00085"></a>00085       DOMNodeList * ind_analysises = constraint-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#7c7a759f7aff2bab3865251955a9e0c5">X_IND_ANALYSIS</a> );
<a name="l00086"></a>00086       analysis = dynamic_cast&lt;DOMElement*&gt;( ind_analysises-&gt;item(0) );
<a name="l00087"></a>00087       <a class="code" href="classNonmemTranslator.html#a3aa6d3ab37603d86c6aa803dd12f843">parseIndAnalysis</a>( analysis );
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089   isAnalysisDone = <span class="keyword">true</span>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00092"></a>00092   <span class="comment">// &lt;model&gt;</span>
<a name="l00093"></a>00093   <span class="comment">// NOTE: &lt;pred&gt; and the combination of {&lt;pk&gt;, &lt;diffeqn&gt;, &lt;error&gt;} are allowed.</span>
<a name="l00094"></a>00094   <span class="comment">//       Default to &lt;pred&gt;.</span>
<a name="l00095"></a>00095   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00096"></a>00096   <span class="keywordtype">bool</span> myIsModelDone = <span class="keyword">false</span>;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a> = <a class="code" href="classNonmemTranslator.html#ff9ad63dcd0691a29b971d7d18c055dc">detModelType</a>();
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="comment">// PRED - computed within Pred::eval() or OdePred::eval()</span>
<a name="l00101"></a>00101   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#0377a5246bbc600486af5813fda70ccb">nonmem::PRED</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="comment">// RES - computed within Pred::eval() or OdePred::eval()</span>
<a name="l00104"></a>00104   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#48c558aad652df7e706b0269cbdc3513">nonmem::RES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00105"></a>00105 
<a name="l00106"></a>00106   <span class="comment">// WRES</span>
<a name="l00107"></a>00107   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#c6e1666cb7319c2c466596d6e40a1471">nonmem::WRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="comment">// IPRED</span>
<a name="l00110"></a>00110   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#96a10a13f2b088606fe87741758fefb8">nonmem::IPRED</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <span class="comment">// IRES</span>
<a name="l00113"></a>00113   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#44a679e0729b60997bab5d831545df06">nonmem::IRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="comment">// IWRES</span>
<a name="l00116"></a>00116   <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#8243887c8db150ec45b9f9821659f504">nonmem::IWRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>() == POP )
<a name="l00119"></a>00119     {
<a name="l00120"></a>00120       <span class="comment">// ETARES</span>
<a name="l00121"></a>00121       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#af822703526984d7d8fee092eda87d4a">nonmem::ETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00122"></a>00122 
<a name="l00123"></a>00123       <span class="comment">// WETARES</span>
<a name="l00124"></a>00124       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#dc80b763783bfea25b38426cb055e4eb">nonmem::WETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00125"></a>00125 
<a name="l00126"></a>00126       <span class="comment">// IETARES</span>
<a name="l00127"></a>00127       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#147cc04bf29fe56af10425341aeba4ee">nonmem::IETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00128"></a>00128 
<a name="l00129"></a>00129       <span class="comment">// IWETARES</span>
<a name="l00130"></a>00130       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#63216aa2d4e31c62a78c0d0c5ecf06a5">nonmem::IWETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00131"></a>00131 
<a name="l00132"></a>00132       <span class="comment">// PPRED</span>
<a name="l00133"></a>00133       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#efa608206973542b3ca75e2bb1d6efa8">nonmem::PPRED</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00134"></a>00134 
<a name="l00135"></a>00135       <span class="comment">// PRES</span>
<a name="l00136"></a>00136       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#eed78b9bfc30419b5d7d3c940306b4a3">nonmem::PRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00137"></a>00137       
<a name="l00138"></a>00138       <span class="comment">// PWRES</span>
<a name="l00139"></a>00139       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#3f0fc66ebbd853f0fa35cf5b98da4e73">nonmem::PWRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00140"></a>00140 
<a name="l00141"></a>00141       <span class="comment">// PETARES</span>
<a name="l00142"></a>00142       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#ec4f2e5b8df24dd38ef35582956dd383">nonmem::PETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00143"></a>00143 
<a name="l00144"></a>00144       <span class="comment">// PWETARES</span>
<a name="l00145"></a>00145       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#4abf8f9483eef6efc461fd245150d42c">nonmem::PWETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00146"></a>00146 
<a name="l00147"></a>00147       <span class="comment">// CPRED</span>
<a name="l00148"></a>00148       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#44728ab88d6bd8cde4b7df1dd18897d5">nonmem::CPRED</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00149"></a>00149       
<a name="l00150"></a>00150       <span class="comment">// CRES</span>
<a name="l00151"></a>00151       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#cf2e87d710826af6df3169bfcf14e14c">nonmem::CRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00152"></a>00152       
<a name="l00153"></a>00153       <span class="comment">// CWRES</span>
<a name="l00154"></a>00154       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#89dd60fe356b962648c994d776bc4ca7">nonmem::CWRES</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00155"></a>00155 
<a name="l00156"></a>00156       <span class="comment">// CETARES</span>
<a name="l00157"></a>00157       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#a15e81a46badff6659915c615188e4dc">nonmem::CETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00158"></a>00158 
<a name="l00159"></a>00159       <span class="comment">// CWETARES</span>
<a name="l00160"></a>00160       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#92df3611182c5f15c3527a2cdf32026d">insertVector</a>( <a class="code" href="namespacenonmem.html#e0b088b5669d63605d3bec210adc63d9">nonmem::CWETARES</a>, <a class="code" href="classNonmemTranslator.html#8b6e4197798b806cfbee7d1a398d2ea0">myEtaLen</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00161"></a>00161     } 
<a name="l00162"></a>00162   DOMNodeList * models = nonmem-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#8425180fb2175bf2189a0b2eb1339ba7">X_MODEL</a> );
<a name="l00163"></a>00163   <span class="keywordflow">if</span>( models-&gt;getLength() != 1 )
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00166"></a>00166       snprintf( mess, 
<a name="l00167"></a>00167         SpkCompilerError::maxMessageLen(),
<a name="l00168"></a>00168         <span class="stringliteral">"Missing &lt;%s&gt; element."</span>, <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#fbcbcbe32c399d2ef40b9c07847a948a">C_MODEL</a> );
<a name="l00169"></a>00169       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00170"></a>00170       <span class="keywordflow">throw</span> e;
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   DOMElement  * model = dynamic_cast&lt;DOMElement*&gt;( models-&gt;item(0) );
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> advan, trans;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="comment">//</span>
<a name="l00178"></a>00178   <span class="comment">// All ADVANs fit to the compartmental modeling framework.</span>
<a name="l00179"></a>00179   <span class="comment">//</span>
<a name="l00180"></a>00180   <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a> != <a class="code" href="classNonmemTranslator.html#6f7b7f9526426cd62cee1682e008681ec68441caf432a1e6a609d1bd76ac0c47">PRED</a> )
<a name="l00181"></a>00181     {
<a name="l00182"></a>00182       XMLString::textToBin( model-&gt;getAttribute( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#83811456797e6aa72934ae1ff95936f7">X_ADVAN</a> ), advan );
<a name="l00183"></a>00183       assert( advan &gt; 0 );
<a name="l00184"></a>00184 
<a name="l00185"></a>00185       assert( <a class="code" href="classNonmemTranslator.html#4588565c98c96f4fec7eb00856374000">myTrans</a> == TRANS1 );  <span class="comment">// default TRANS value</span>
<a name="l00186"></a>00186       <span class="keywordflow">if</span>( model-&gt;hasAttribute( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#df936619d42e3b7ce67668c81dc2f180">X_TRANS</a> ) )
<a name="l00187"></a>00187     {
<a name="l00188"></a>00188       XMLString::textToBin( model-&gt;getAttribute( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#df936619d42e3b7ce67668c81dc2f180">X_TRANS</a> ), trans );
<a name="l00189"></a>00189       <a class="code" href="classNonmemTranslator.html#4588565c98c96f4fec7eb00856374000">myTrans</a> = static_cast&lt;TRANS&gt;( trans );
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191       <a class="code" href="classNonmemTranslator.html#0aaeae239e3b33280b52f2f40b44f10c">parseAdvan</a>( <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a>, <a class="code" href="classNonmemTranslator.html#4588565c98c96f4fec7eb00856374000">myTrans</a>, model );
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193   <span class="keywordflow">else</span>
<a name="l00194"></a>00194     {
<a name="l00195"></a>00195       DOMNodeList * preds   = model-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#b01b6c2cd6a50dab6322d2b5a1ac587d">X_PRED</a> );
<a name="l00196"></a>00196       <span class="keywordflow">if</span>( preds-&gt;getLength() &lt; 1 )
<a name="l00197"></a>00197     {
<a name="l00198"></a>00198       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00199"></a>00199       snprintf( mess, 
<a name="l00200"></a>00200             SpkCompilerError::maxMessageLen(),
<a name="l00201"></a>00201             <span class="stringliteral">"Missing &lt;pred&gt;!"</span> );
<a name="l00202"></a>00202       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>,
<a name="l00203"></a>00203                   mess, __LINE__, __FILE__ );
<a name="l00204"></a>00204       <span class="keywordflow">throw</span> e;
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206       DOMElement  * pred = dynamic_cast&lt;DOMElement*&gt;( preds-&gt;item(0) );
<a name="l00207"></a>00207       <a class="code" href="classNonmemTranslator.html#e5fd1344150f67a9a03bcc1f0092d47a">parsePred</a>( pred ); 
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   myIsModelDone = <span class="keyword">true</span>;
<a name="l00211"></a>00211  
<a name="l00212"></a>00212   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00213"></a>00213   <span class="comment">// &lt;monte_carlo&gt;</span>
<a name="l00214"></a>00214   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00215"></a>00215   DOMNodeList * monte_carlos = nonmem-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#676146972fedfbfe341d23b4558f2330">X_MONTE_CARLO</a> );
<a name="l00216"></a>00216   DOMElement * monte_carlo;
<a name="l00217"></a>00217   <span class="keywordflow">if</span>( monte_carlos-&gt;getLength() &gt; 0 )
<a name="l00218"></a>00218     {
<a name="l00219"></a>00219       <a class="code" href="classNonmemTranslator.html#abddf1d2ac0639d554afbe7f2d4e5e37">myIsMonte</a> = <span class="keyword">true</span>;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222       <span class="comment">//</span>
<a name="l00223"></a>00223       <span class="comment">// REVISIT - Sachiko - 09/09/2004</span>
<a name="l00224"></a>00224       <span class="comment">// estimation and MC are mutually exclusive.  Currently (as of 9/9/04)</span>
<a name="l00225"></a>00225       <span class="comment">// MDA allows both to be true, so for now set myIsEstimate=false.</span>
<a name="l00226"></a>00226       <span class="comment">//</span>
<a name="l00227"></a>00227       <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#bf24330fc235029ee0bb68a09b451018">myIsEstimate</a> )
<a name="l00228"></a>00228     myIsEstimate = <span class="keyword">false</span>;
<a name="l00229"></a>00229       <span class="comment">//</span>
<a name="l00230"></a>00230       <span class="comment">// if( myIsEstimate )</span>
<a name="l00231"></a>00231       <span class="comment">// {</span>
<a name="l00232"></a>00232       <span class="comment">//    char mess[ SpkCompilerError::maxMessageLen() ];</span>
<a name="l00233"></a>00233       <span class="comment">//    snprintf( mess, </span>
<a name="l00234"></a>00234       <span class="comment">//              SpkCompilerError::maxMessageLen(),</span>
<a name="l00235"></a>00235       <span class="comment">//              "The parameter estimation and the post-interation requests are mutually exclusive." );</span>
<a name="l00236"></a>00236       <span class="comment">//    SpkCompilerException e( SpkCompilerError::ASPK_SOURCEML_ERR,</span>
<a name="l00237"></a>00237       <span class="comment">//        mess, __LINE__, __FILE__ );</span>
<a name="l00238"></a>00238       <span class="comment">//    throw e;</span>
<a name="l00239"></a>00239       <span class="comment">// }</span>
<a name="l00240"></a>00240 
<a name="l00241"></a>00241       <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>() != POP )
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00244"></a>00244       snprintf( mess, 
<a name="l00245"></a>00245             <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>(),
<a name="l00246"></a>00246             <span class="stringliteral">"Integral methods are only valid for the population analysis results."</span>);
<a name="l00247"></a>00247       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>,
<a name="l00248"></a>00248                   mess, __LINE__, __FILE__ );
<a name="l00249"></a>00249       <span class="keywordflow">throw</span> e;
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251       monte_carlo = dynamic_cast&lt;DOMElement*&gt;( monte_carlos-&gt;item(0) );
<a name="l00252"></a>00252       <a class="code" href="classNonmemTranslator.html#093be8694bd24867b5dc63197fc5b0a1">parseMonte</a>( monte_carlo );
<a name="l00253"></a>00253     }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00256"></a>00256   <span class="comment">//&lt;presentation&gt;</span>
<a name="l00257"></a>00257   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00258"></a>00258   <span class="comment">//PRED parsing and &lt;xxx_analysis&gt; parsing must have been completed so</span>
<a name="l00259"></a>00259   <span class="comment">//that the symbol table contains entries for the user defined</span>
<a name="l00260"></a>00260   <span class="comment">//variables and THETA/OMEGA/SIGMA/ETA.</span>
<a name="l00261"></a>00261   <span class="keywordflow">if</span>( !myIsModelDone )
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00264"></a>00264       snprintf( mess, 
<a name="l00265"></a>00265         <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>(),
<a name="l00266"></a>00266         <span class="stringliteral">"&lt;%s&gt; must be parsed before parsing &lt;%s&gt;."</span>, 
<a name="l00267"></a>00267         <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#a88708b05b50cbda34f0f19c1432f454">C_PRED</a>, <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#d3842b51e37e80f97886c0b4d59c4a78">C_PRESENTATION</a>);
<a name="l00268"></a>00268       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00269"></a>00269       <span class="keywordflow">throw</span> e;
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271   <span class="keywordflow">if</span>( !isAnalysisDone )
<a name="l00272"></a>00272     {
<a name="l00273"></a>00273       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00274"></a>00274       snprintf( mess, 
<a name="l00275"></a>00275         <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>(),
<a name="l00276"></a>00276         <span class="stringliteral">"&lt;%s&gt; must be parsed before parsing &lt;%s&gt;"</span>, 
<a name="l00277"></a>00277         (<a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>()==POP? <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#370ab38bae5e5776ea4b4d61d6235eeb">C_POP_ANALYSIS</a> : <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#106fd821a9944e96b1e6448f896ec486">C_IND_ANALYSIS</a> ), 
<a name="l00278"></a>00278         <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#d3842b51e37e80f97886c0b4d59c4a78">C_PRESENTATION</a> );
<a name="l00279"></a>00279       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00280"></a>00280       <span class="keywordflow">throw</span> e;
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282   
<a name="l00283"></a>00283   DOMNodeList * presentations = nonmem-&gt;getElementsByTagName( <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#5e5165847cbdd3c43b0a7972e3f7102c">X_PRESENTATION</a> );
<a name="l00284"></a>00284   <span class="keywordflow">if</span>( presentations-&gt;getLength() &gt; 1 )
<a name="l00285"></a>00285     {
<a name="l00286"></a>00286       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00287"></a>00287       snprintf( mess, 
<a name="l00288"></a>00288         SpkCompilerError::maxMessageLen(),
<a name="l00289"></a>00289         <span class="stringliteral">"Multiple &lt;%s&gt; elements are found."</span>, <a class="code" href="classNonmemTranslator.html#b512bc7fc7a667800c68892fe94cc8a7">XML</a>.<a class="code" href="structXmlConstants.html#d3842b51e37e80f97886c0b4d59c4a78">C_PRESENTATION</a> ); 
<a name="l00290"></a>00290       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00291"></a>00291       <span class="keywordflow">throw</span> e;
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   DOMElement * presentation = dynamic_cast&lt;DOMElement*&gt;( presentations-&gt;item(0) );
<a name="l00295"></a>00295 
<a name="l00296"></a>00296   <a class="code" href="classNonmemTranslator.html#08e14de678343e48d0d069df01ff397b">myRecordNums</a>.resize( <a class="code" href="classClientTranslator.html#eb1050bcc780e36f40865b5d87d33c18">getPopSize</a>() );
<a name="l00297"></a>00297   <a class="code" href="classSymbol.html">Symbol</a> * <span class="keywordtype">id</span> = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#982ead81dfe1fe47c8bba6b1125c6629">nonmem::ID</a> );
<a name="l00298"></a>00298   <span class="keywordflow">if</span>( <span class="keywordtype">id</span> == NULL || <span class="keywordtype">id</span> == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00299"></a>00299     {
<a name="l00300"></a>00300       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00301"></a>00301       snprintf( mess, 
<a name="l00302"></a>00302         <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>(),
<a name="l00303"></a>00303         <span class="stringliteral">"\"%s\" data item seems missing from the data set."</span>, 
<a name="l00304"></a>00304         <a class="code" href="namespacenonmem.html#982ead81dfe1fe47c8bba6b1125c6629">nonmem::ID</a>.c_str() ); 
<a name="l00305"></a>00305       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess, __LINE__, __FILE__ );
<a name="l00306"></a>00306       <span class="keywordflow">throw</span> e;
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309   <span class="comment">// Determine the number of data records for each subject.</span>
<a name="l00310"></a>00310   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classClientTranslator.html#eb1050bcc780e36f40865b5d87d33c18">getPopSize</a>(); i++ )
<a name="l00311"></a>00311     {
<a name="l00312"></a>00312       <a class="code" href="classNonmemTranslator.html#08e14de678343e48d0d069df01ff397b">myRecordNums</a>[i] = id-&gt;<a class="code" href="classSymbol.html#f5681f78deca89b5f75767cb0a757372">initial</a>[i].size();
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00316"></a>00316   <span class="comment">//</span>
<a name="l00317"></a>00317   <span class="comment">// Check predefined words and register in the symbol table if appropriate</span>
<a name="l00318"></a>00318   <span class="comment">// before generating C++ source code files.</span>
<a name="l00319"></a>00319   <span class="comment">//</span>
<a name="l00320"></a>00320   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00321"></a>00321   assert( isAnalysisDone );
<a name="l00322"></a>00322   <a class="code" href="classSymbol.html">Symbol</a> * p;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00325"></a>00325   <span class="comment">// Ones that are definitely going in.</span>
<a name="l00326"></a>00326   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   <span class="comment">// ORGDV is a placeholder for the original data set.</span>
<a name="l00329"></a>00329   <span class="comment">// The original data set should be copied into this placeholder</span>
<a name="l00330"></a>00330   <span class="comment">// in case a new data set is simulated and replaces the oridinary DV field.</span>
<a name="l00331"></a>00331   <span class="keywordflow">if</span>( ( p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#65b48b202526846af9d78b2ce6ca08a6">nonmem::ORGDV</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00332"></a>00332     {  
<a name="l00333"></a>00333       <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#8a596527945c2d2c29c14cc387f3826c">insertScalar</a>( <a class="code" href="namespacenonmem.html#65b48b202526846af9d78b2ce6ca08a6">nonmem::ORGDV</a>, <a class="code" href="classSymbol.html#a962f23fa9d44a5cca685745dd09df60147d6d21f166d10086910fbe42821a38">Symbol::SYSTEM</a>, <a class="code" href="classSymbol.html#8bdf0fab3d4db200bb23e9f12e0f75b2d888661233e59fedbdeda31e9cb62bb8">Symbol::READONLY</a> );
<a name="l00334"></a>00334       assert( <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( nonmem::ORGDV ) != <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() );
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336   <span class="keywordflow">else</span>
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00339"></a>00339                   <span class="stringliteral">"ORGDV should NOT have been defined yet!"</span>,
<a name="l00340"></a>00340                   __LINE__,
<a name="l00341"></a>00341                   __FILE__ );
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 
<a name="l00345"></a>00345   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00346"></a>00346   <span class="comment">// Ones that may have been appeared </span>
<a name="l00347"></a>00347   <span class="comment">// in the model definition.</span>
<a name="l00348"></a>00348   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00349"></a>00349   <span class="comment">// CMT</span>
<a name="l00350"></a>00350   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#187c2146945563e9f0cbefa204a1752e">nonmem::CMT</a> ))  != <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00351"></a>00351     <a class="code" href="classNonmemTranslator.html#3dea103d4dfbe398fb7138c78608b265">myIsMissingCmt</a> = <span class="keyword">false</span>;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353   <span class="comment">// PCMT</span>
<a name="l00354"></a>00354   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#b4237aa4e2409ed423279c9f61d494c7">nonmem::PCMT</a> )) != <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00355"></a>00355     <a class="code" href="classNonmemTranslator.html#4b9d600c67532312edc5d3bdf6af4d35">myIsMissingPcmt</a> = <span class="keyword">false</span>;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357   <span class="comment">// RATE</span>
<a name="l00358"></a>00358   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#8e08d0db77f5cb3e84b31349a52cad83">nonmem::RATE</a> )) != <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00359"></a>00359     <a class="code" href="classNonmemTranslator.html#540745b8778fb6f3acdcaedfbdb8315f">myIsMissingRate</a> = <span class="keyword">false</span>;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a> != <a class="code" href="classNonmemTranslator.html#6f7b7f9526426cd62cee1682e008681ec68441caf432a1e6a609d1bd76ac0c47">PRED</a> )
<a name="l00362"></a>00362     {
<a name="l00363"></a>00363       <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#f9023cdad4b295009dcea4bf51b11e3f">nonmem::MDV</a> ))  == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>,
<a name="l00366"></a>00366                       <span class="stringliteral">"MDV data item is missing"</span>,
<a name="l00367"></a>00367                       __LINE__, __FILE__ );
<a name="l00368"></a>00368     }
<a name="l00369"></a>00369       <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#7ad9360c37d1486cf1307c15dfb6f392">nonmem::AMT</a> ))  == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00370"></a>00370     {
<a name="l00371"></a>00371       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>,
<a name="l00372"></a>00372                       <span class="stringliteral">"AMT data item is missing"</span>,
<a name="l00373"></a>00373                       __LINE__, __FILE__ );
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375       <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#6b441267ee823ed8438f6d116e53f98b">nonmem::EVID</a> ))  == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>,
<a name="l00378"></a>00378                       <span class="stringliteral">"EVID data item is missing"</span>,
<a name="l00379"></a>00379                       __LINE__, __FILE__ );
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00387"></a>00387   <span class="comment">// Ones that should have been </span>
<a name="l00388"></a>00388   <span class="comment">// registered by now. </span>
<a name="l00389"></a>00389   <span class="comment">// Thus, not going in!</span>
<a name="l00390"></a>00390   <span class="comment">//+++++++++++++++++++++++++++++++++++++</span>
<a name="l00391"></a>00391 
<a name="l00392"></a>00392   <span class="comment">// ID is required in a data set.</span>
<a name="l00393"></a>00393   <span class="comment">// The field should have been inserted even if</span>
<a name="l00394"></a>00394   <span class="comment">// the original data set lacked it.</span>
<a name="l00395"></a>00395   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#982ead81dfe1fe47c8bba6b1125c6629">nonmem::ID</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00396"></a>00396     {
<a name="l00397"></a>00397       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00398"></a>00398                   <span class="stringliteral">"ID should have been defined by now!"</span>,
<a name="l00399"></a>00399                   __LINE__,
<a name="l00400"></a>00400                   __FILE__ );
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403   <span class="comment">// DV is always required in a data set and</span>
<a name="l00404"></a>00404   <span class="comment">// should have appeared in the model definition as well.</span>
<a name="l00405"></a>00405   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#6bbf6c00d23df5d58deef080666b399d">nonmem::DV</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00406"></a>00406     {
<a name="l00407"></a>00407       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00408"></a>00408                   <span class="stringliteral">"DV should have been defined by now!"</span>,
<a name="l00409"></a>00409                   __LINE__,
<a name="l00410"></a>00410                   __FILE__ );
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412 
<a name="l00413"></a>00413   <span class="comment">// REVISIT by Sachiko - 08/08/2005</span>
<a name="l00414"></a>00414   <span class="comment">// F is required by the current implementation of SPK, </span>
<a name="l00415"></a>00415   <span class="comment">// although it is not by NONMEM.</span>
<a name="l00416"></a>00416   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#b62e768802606d60f93ca02d22539a2d">nonmem::F</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00417"></a>00417     {
<a name="l00418"></a>00418       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935d4e4b1ec6c464e05ae32a4d749471492e">SpkCompilerError::ASPK_USER_ERR</a>, 
<a name="l00419"></a>00419                   <span class="stringliteral">"F was missing in the user's model!"</span>,
<a name="l00420"></a>00420                   __LINE__,
<a name="l00421"></a>00421                   __FILE__ );
<a name="l00422"></a>00422     }
<a name="l00423"></a>00423   
<a name="l00424"></a>00424   <span class="comment">// F should have appeared in the model definition.</span>
<a name="l00425"></a>00425   <span class="comment">// If not, it's a user input error.</span>
<a name="l00426"></a>00426   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#17332ad734534c1a68985bc591281740">nonmem::Y</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00427"></a>00427     {
<a name="l00428"></a>00428       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935d4e4b1ec6c464e05ae32a4d749471492e">SpkCompilerError::ASPK_USER_ERR</a>, 
<a name="l00429"></a>00429                   <span class="stringliteral">"Y was missing in the user's model!"</span>,
<a name="l00430"></a>00430                   __LINE__,
<a name="l00431"></a>00431                   __FILE__ );
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 
<a name="l00435"></a>00435   <span class="comment">// THETA is always required.</span>
<a name="l00436"></a>00436   <span class="comment">// It should have been registered while parsing &lt;pop_analysis&gt; or &lt;ind_analysis&gt;.</span>
<a name="l00437"></a>00437   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#f376d6a7dc93523e35f3d7e7027e5b7f">nonmem::THETA</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00440"></a>00440                   <span class="stringliteral">"THETA should have been defined by now!"</span>,
<a name="l00441"></a>00441                   __LINE__,
<a name="l00442"></a>00442                   __FILE__ );
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   <span class="comment">// OMEGA is always required.</span>
<a name="l00446"></a>00446   <span class="comment">// It should have been registered while parsing &lt;pop_analysis&gt; or &lt;ind_analysis&gt;.</span>
<a name="l00447"></a>00447   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#dc78e81822f87c4152b4407ba272d4fa">nonmem::OMEGA</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00448"></a>00448     {
<a name="l00449"></a>00449       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00450"></a>00450                   <span class="stringliteral">"OMEGA should have been defined by now!"</span>,
<a name="l00451"></a>00451                   __LINE__,
<a name="l00452"></a>00452                   __FILE__ );
<a name="l00453"></a>00453     }
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   <span class="comment">// ETA is always required.</span>
<a name="l00456"></a>00456   <span class="comment">// It should have been registered while parsing &lt;pop_analysis&gt; or &lt;ind_analysis&gt;.</span>
<a name="l00457"></a>00457   <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#80691b6b72c768b429a58e5d177a06d5">nonmem::ETA</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00458"></a>00458     {
<a name="l00459"></a>00459       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00460"></a>00460                   <span class="stringliteral">"ETA should have been defined by now!"</span>,
<a name="l00461"></a>00461                   __LINE__,
<a name="l00462"></a>00462                   __FILE__ );
<a name="l00463"></a>00463     }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465   <span class="comment">// Predefined words required only for POPULATION analysis.</span>
<a name="l00466"></a>00466   <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>() == POP )
<a name="l00467"></a>00467     {
<a name="l00468"></a>00468       <span class="comment">// SIGMA</span>
<a name="l00469"></a>00469       <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#e546667f89d4aea4ad0fb36ee0bf48e8">nonmem::SIGMA</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00470"></a>00470     {
<a name="l00471"></a>00471       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00472"></a>00472                       <span class="stringliteral">"SIGMA should have been defined by now!"</span>,
<a name="l00473"></a>00473                       __LINE__,
<a name="l00474"></a>00474                       __FILE__ );
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476       <span class="comment">// EPS</span>
<a name="l00477"></a>00477       <span class="keywordflow">if</span>( (p = <a class="code" href="classNonmemTranslator.html#7cdb34ced820cc22c242e85e710aa076">table</a>-&gt;<a class="code" href="classSymbolTable.html#6b681d2875323db888e53065ed87ca5c">find</a>( <a class="code" href="namespacenonmem.html#8c661e13aa33617aa39f83430e850b3c">nonmem::EPS</a> )) == <a class="code" href="classSymbol.html#30d8ad41e349fd05ca5e2fc128f7b6d3">Symbol::empty</a>() )
<a name="l00478"></a>00478     {
<a name="l00479"></a>00479       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00480"></a>00480                       <span class="stringliteral">"EPS should have been defined by now!"</span>,
<a name="l00481"></a>00481                       __LINE__,
<a name="l00482"></a>00482                       __FILE__ );
<a name="l00483"></a>00483     }
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00487"></a>00487   <span class="comment">//</span>
<a name="l00488"></a>00488   <span class="comment">// Generate source code files</span>
<a name="l00489"></a>00489   <span class="comment">//</span>
<a name="l00490"></a>00490   <span class="comment">//---------------------------------------------------------------------------------------</span>
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="comment">//*************************************</span>
<a name="l00493"></a>00493   <span class="comment">// Generate the headers and definition </span>
<a name="l00494"></a>00494   <span class="comment">// files for IndData class and</span>
<a name="l00495"></a>00495   <span class="comment">// DataSet class.</span>
<a name="l00496"></a>00496   <span class="comment">//</span>
<a name="l00497"></a>00497   <span class="comment">// The symbol table (ie. the order of </span>
<a name="l00498"></a>00498   <span class="comment">// data labels in the list) must not </span>
<a name="l00499"></a>00499   <span class="comment">// change between the following two</span>
<a name="l00500"></a>00500   <span class="comment">// calls</span>
<a name="l00501"></a>00501   <span class="comment">//*************************************</span>
<a name="l00502"></a>00502   <a class="code" href="classNonmemTranslator.html#25255729e1be577a0d26a0f0eeb0b12e">generateDataSet</a>();
<a name="l00503"></a>00503   <a class="code" href="classNonmemTranslator.html#6f04cd97c5ca32a87930c15aea6319bc">generateIndData</a>();
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="comment">//*************************************</span>
<a name="l00507"></a>00507   <span class="comment">// Generate model-related source.</span>
<a name="l00508"></a>00508   <span class="comment">//*************************************</span>
<a name="l00509"></a>00509   <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a> == <a class="code" href="classNonmemTranslator.html#6f7b7f9526426cd62cee1682e008681ec68441caf432a1e6a609d1bd76ac0c47">PRED</a> )
<a name="l00510"></a>00510     {
<a name="l00511"></a>00511       <a class="code" href="classNonmemTranslator.html#16f64eeed9eaeb4ca16a95b4e0726f36">generatePred</a>( <a class="code" href="classNonmemTranslator.html#e2d3f8b57e5f883def54aa7a76ef45fe">fPredEqn_cpp</a> );
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#cab9032bd76ec69a4aae3a4d1e82e34e">myModelSpec</a> == <a class="code" href="classNonmemTranslator.html#6f7b7f9526426cd62cee1682e008681e9492ad42106f73e0820022928fb899e9">ADVAN6</a> )
<a name="l00514"></a>00514     {
<a name="l00515"></a>00515       <a class="code" href="classNonmemTranslator.html#c58082892d78c87f6f9ee5959a59c101">generateOdePred</a>( <a class="code" href="classNonmemTranslator.html#fc46ecdc569eb5e7048356d3a372d184">fPkEqn_cpp</a>, <a class="code" href="classNonmemTranslator.html#661e005953f42529edbf5ae285cee379">fDiffEqn_cpp</a>, <a class="code" href="classNonmemTranslator.html#1cb8000599764b4d6db744b448655c05">fErrorEqn_cpp</a>, <a class="code" href="classNonmemTranslator.html#cfe4c972f103ac613ff5b35ac1712eda">myIsIdent</a> );
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517   <span class="keywordflow">else</span>
<a name="l00518"></a>00518     {
<a name="l00519"></a>00519       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>() ];
<a name="l00520"></a>00520       snprintf( mess, 
<a name="l00521"></a>00521         <a class="code" href="classSpkCompilerError.html#e122376e543be6c83edef715c92599e1">SpkCompilerError::maxMessageLen</a>(),
<a name="l00522"></a>00522         <span class="stringliteral">"Invalid model specification!."</span> );
<a name="l00523"></a>00523       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935dbf7918d9e64556832eca4c5d3aa904da">SpkCompilerError::ASPK_SOURCEML_ERR</a>, mess,
<a name="l00524"></a>00524                   __LINE__, __FILE__ );
<a name="l00525"></a>00525       <span class="keywordflow">throw</span> e;
<a name="l00526"></a>00526     }
<a name="l00527"></a>00527   
<a name="l00528"></a>00528   <span class="comment">//*************************************</span>
<a name="l00529"></a>00529   <span class="comment">// Generate namespace files.</span>
<a name="l00530"></a>00530   <span class="comment">//*************************************</span>
<a name="l00531"></a>00531   <a class="code" href="classNonmemTranslator.html#5303194e7b1d96dcc9e8af1b2871accd">generateNonmemParsNamespace</a>();
<a name="l00532"></a>00532   <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#abddf1d2ac0639d554afbe7f2d4e5e37">myIsMonte</a> )
<a name="l00533"></a>00533     <a class="code" href="classNonmemTranslator.html#e73f08c04023bbce248549c6eb86e387">generateMonteParsNamespace</a>();
<a name="l00534"></a>00534   
<a name="l00535"></a>00535   <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#cfe4c972f103ac613ff5b35ac1712eda">myIsIdent</a> )
<a name="l00536"></a>00536     {
<a name="l00537"></a>00537 <span class="comment">// [Revisit - Identifiability Files Should not be Included in the Release - Mitch]</span>
<a name="l00538"></a>00538 <span class="comment">//      generateIdentDriver();</span>
<a name="l00539"></a>00539 <span class="comment">// [Revisit - Identifiability Files Should not be Included in the Release - Mitch]</span>
<a name="l00540"></a>00540       <span class="keywordflow">throw</span> <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a>( <a class="code" href="classSpkCompilerError.html#2743acfc3b04803a497c786509f4935daff632dac54a3e48a2c0c7130a02f937">SpkCompilerError::ASPK_PROGRAMMER_ERR</a>, 
<a name="l00541"></a>00541         <span class="stringliteral">"The identifiability capabilities have been removed from SPK."</span>,
<a name="l00542"></a>00542         __LINE__,
<a name="l00543"></a>00543         __FILE__ );
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classNonmemTranslator.html#bf24330fc235029ee0bb68a09b451018">myIsEstimate</a> || <a class="code" href="classNonmemTranslator.html#6fe301cdc5ba39210efbb8f0d411c575">myIsSimulate</a> )
<a name="l00546"></a>00546     {
<a name="l00547"></a>00547       <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#b142f89211bb884ba4d63ffb66ce4255">getTarget</a>() == POP )
<a name="l00548"></a>00548         <a class="code" href="classNonmemTranslator.html#91cc1c84cbdd247adb95ab23f6d601ad">generatePopDriver</a>();
<a name="l00549"></a>00549       <span class="keywordflow">else</span> 
<a name="l00550"></a>00550         <a class="code" href="classNonmemTranslator.html#3b4b5a870b4c58e3fa5d6bd0c9bc7e2b">generateIndDriver</a>();
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552   <span class="comment">//*************************************</span>
<a name="l00553"></a>00553   <span class="comment">// Generate Makefile.</span>
<a name="l00554"></a>00554   <span class="comment">//*************************************</span>
<a name="l00555"></a>00555   <a class="code" href="classNonmemTranslator.html#dbc2ced025be543a2adfc97144ec7859">generateMakefile</a>();
<a name="l00556"></a>00556 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue May 20 15:28:23 2008 for SPK Compiler API Documentation by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
