<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Pred Library: predTwoStageMethod.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>predTwoStageMethod.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Declares <a class="el" href="predTwoStageMethod_8cpp.html#53987add4873a22071539c5646cd93fd">predTwoStageMethod()</a> function. 
<p>

<p>
Definition in file <a class="el" href="predTwoStageMethod_8h-source.html">predTwoStageMethod.h</a>.
<p>
<code>#include &quot;<a class="el" href="Cov_8h-source.html">Cov.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="IndPredModel_8h-source.html">IndPredModel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="PopPredModel_8h-source.html">PopPredModel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="PredBase_8h-source.html">PredBase.h</a>&quot;</code><br>
<code>#include &lt;spk/Objective.h&gt;</code><br>
<code>#include &lt;spk/Optimizer.h&gt;</code><br>
<code>#include &lt;spk/SpkValarray.h&gt;</code><br>

<p>
<a href="predTwoStageMethod_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="predTwoStageMethod_8h.html#a892955304db70c4bdc6bcbdc2151e69">predTwoStageMethod</a> (<a class="el" href="classPopPredModel.html">PopPredModel</a> &amp;popModel, <a class="el" href="classIndPredModel.html">IndPredModel</a> &amp;indModelWithPopModelData, enum Objective method, const SPK_VA::valarray&lt; int &gt; &amp;nMeasurementsAll, const SPK_VA::valarray&lt; double &gt; &amp;measurementsAll, Optimizer &amp;popOptInfo, Optimizer &amp;indOptInfo, SPK_VA::valarray&lt; double &gt; *pIndParAllOut)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This Pred library specific two-stage method wrapper determines population means and covariances for individual parameters by performing one of the two-stage methods.  <a href="#a892955304db70c4bdc6bcbdc2151e69"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a892955304db70c4bdc6bcbdc2151e69"></a><!-- doxytag: member="predTwoStageMethod.h::predTwoStageMethod" ref="a892955304db70c4bdc6bcbdc2151e69" args="(PopPredModel &amp;popModel, IndPredModel &amp;indModelWithPopModelData, enum Objective method, const SPK_VA::valarray&lt; int &gt; &amp;nMeasurementsAll, const SPK_VA::valarray&lt; double &gt; &amp;measurementsAll, Optimizer &amp;popOptInfo, Optimizer &amp;indOptInfo, SPK_VA::valarray&lt; double &gt; *pIndParAllOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void predTwoStageMethod           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPopPredModel.html">PopPredModel</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>popModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIndPredModel.html">IndPredModel</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>indModelWithPopData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum Objective&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; int &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>nMeasurementsAll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SPK_VA::valarray&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>measurementsAll</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optimizer &amp;&nbsp;</td>
          <td class="paramname"> <em>popOptInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optimizer &amp;&nbsp;</td>
          <td class="paramname"> <em>indOptInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SPK_VA::valarray&lt; double &gt; *&nbsp;</td>
          <td class="paramname"> <em>pIndParAllOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This Pred library specific two-stage method wrapper determines population means and covariances for individual parameters by performing one of the two-stage methods. 
<p>
This function performs a two-stage method analysis using the individual model, indModelWithPopData, which should contain the same data and model as the population model, popModel.<p>
At the end, the population parameters for the population model are set equal to the values determined by the two-stage method.<p>
To be specific, at the end of these methods, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ theta^{\mbox{(Pop)}} = \overline{ theta^{\mbox{(Ind)}} } = \mbox{E}\left[ theta^{\mbox{(Ind)}} \right] = \frac{1}{nInd} \sum_{i = 1}^{nInd} theta_i^{\mbox{(Ind)}} , \]" src="form_163.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Pop)}} = \mbox{Cov}\left[ theta^{\mbox{(Ind)}} \right] , \]" src="form_164.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Sigma^{\mbox{(Pop)}} = \overline{ Omega^{\mbox{(Ind)}} } = \mbox{E}\left[ Omega^{\mbox{(Ind)}} \right] = \frac{1}{nInd} \sum_{i = 1}^{nInd} Omega_i^{\mbox{(Ind)}} . \]" src="form_165.png">
<p>
 This function, therefore, requires that the following be true: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nTheta^{\mbox{(Pop)}} = nTheta^{\mbox{(Ind)}} , \]" src="form_150.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nEta^{\mbox{(Pop)}} = nTheta^{\mbox{(Ind)}} , \]" src="form_151.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ nEps^{\mbox{(Pop)}} = nEta^{\mbox{(Ind)}} , \]" src="form_152.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ SigmaStruct^{\mbox{(Pop)}} = OmegaStruct^{\mbox{(Ind)}} , \]" src="form_153.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Pop)}} = nEta^{\mbox{(Pop)}} \times nEta^{\mbox{(Pop)}} , \]" src="form_154.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Sigma^{\mbox{(Pop)}} = nEps^{\mbox{(Pop)}} \times nEps^{\mbox{(Pop)}} , \]" src="form_155.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Omega^{\mbox{(Ind)}} = nEta^{\mbox{(Ind)}} \times nEta^{\mbox{(Ind)}} . \]" src="form_156.png">
<p>
<p>
This function allows the following Two-Stage methods to be used:<p>
<ul>
<li>STANDARD_TWO_STAGE = Standard Two-Stage (STS) method,</li><li>ITERATIVE_TWO_STAGE = Iterative Two-Stage (ITS) method,</li><li>GLOBAL_TWO_STAGE = Global Two-Stage (GTS) method.</li></ul>
<p>
For the Standard Two-Stage methods (STS), the population mean of the individuals' parameter estimates is calculated as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{ b } = \mbox{E}\left[ b \right] = \frac{1}{nInd} \sum_{i = 1}^{nInd} \hat{b_i} , \]" src="form_166.png">
<p>
 and the population covariance of the individuals' estimates is calculated as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mbox{Cov}\left[ b \right] = \frac{1}{nInd} \sum_{i = 1}^{nInd} \left[ \hat{b_i} - \overline{ b } \right] \left[ \hat{b_i} - \overline{ b } \right]^T , \]" src="form_167.png">
<p>
 where the <img class="formulaInl" alt="$ \hat{b_i} $" src="form_168.png"> are the optimal individual parameter values for each of the individuals that were determined by the two-stage method<p>
For the Iterative and Global Two-Stage methods (ITS and GTS), the population mean and the population covariance of the individuals' estimates are calculated using the algorithms described in Schumitzky (1995).<p>
Reference:<p>
A. Schumitzky, EM algorithms and two stage methods in phamacokinetic population analysis. in "Advanced Methods of Pharmacokinetic and Pharmacodynamic Systems Analysis", edited by D. Z. D'Argenio. New York: Plenum, 1995, p. 145-160.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pIndParAllOut</em>&nbsp;</td><td>If pIndParAllOut is not NULL, then the SPK_VA::valarray&lt;double&gt; object pointed to by pIndParAllOut must be declared in the function that calls this function, and its size must be equal to the number of individuals <img class="formulaInl" alt="$ nInd $" src="form_158.png"> times the number of individual parameters <img class="formulaInl" alt="$ nB $" src="form_157.png">. If pIndParAllOut is not NULL and this function completed the two-stage method successfully, then the object pointed to by pIndParAllOut will contain the matrix of optimal individual parameter values for each of the individuals that were determined by the two-stage method. Each column of the matrix will contain one of the column vectors <img class="formulaInl" alt="$ \hat{b_i} $" src="form_168.png">. Otherwise, this function will not attempt to change the contents of the object pointed to by pIndParAllOut. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="predTwoStageMethod_8cpp-source.html#l00151">151</a> of file <a class="el" href="predTwoStageMethod_8cpp-source.html">predTwoStageMethod.cpp</a>.
<p>
References <a class="el" href="PopPredModelBase_8cpp-source.html#l03983">PopPredModelBase&lt; Scalar &gt;::getEps()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02337">IndPredModelBase&lt; Scalar &gt;::getEta()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l03965">PopPredModelBase&lt; Scalar &gt;::getEta()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02301">IndPredModelBase&lt; Scalar &gt;::getIndPar()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02188">IndPredModelBase&lt; Scalar &gt;::getIndParLimits()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02247">IndPredModelBase&lt; Scalar &gt;::getIndParStep()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02285">IndPredModelBase&lt; Scalar &gt;::getNIndPar()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02355">IndPredModelBase&lt; Scalar &gt;::getOmega()</a>, <a class="el" href="IndPredModelBase_8cpp-source.html#l02319">IndPredModelBase&lt; Scalar &gt;::getTheta()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l03947">PopPredModelBase&lt; Scalar &gt;::getTheta()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l01365">PopPredModelBase&lt; Scalar &gt;::setOmega()</a>, <a class="el" href="PopPredModelBase_8cpp-source.html#l01386">PopPredModelBase&lt; Scalar &gt;::setSigma()</a>, and <a class="el" href="PopPredModelBase_8cpp-source.html#l01348">PopPredModelBase&lt; Scalar &gt;::setTheta()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Mon Sep 10 10:13:35 2007 for SPK Pred Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
