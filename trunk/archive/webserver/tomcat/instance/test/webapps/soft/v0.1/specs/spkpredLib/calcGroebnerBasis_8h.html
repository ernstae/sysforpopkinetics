<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Pred Library: calcGroebnerBasis.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>calcGroebnerBasis.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Declares <a class="el" href="calcGroebnerBasis_8c.html#508059810f709aae7aa7a862284cb2ab">calcGroebnerBasis()</a> function. 
<p>

<p>
Definition in file <a class="el" href="calcGroebnerBasis_8h-source.html">calcGroebnerBasis.h</a>.
<p>

<p>
<a href="calcGroebnerBasis_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="calcGroebnerBasis_8h.html#508059810f709aae7aa7a862284cb2ab">calcGroebnerBasis</a> (int level, int nTheta, int thetaSeed, int nIdentComp, int nObservType, int nDoseType, const char *sysExpModelRegChainIn, const char *naturalOrderingIn, const char *charSetOrderingIn, int **nGroebnerBasisPolyEachOut, int *nGroebnerBasisPolyTotalOut, char ***groebnerBasisPolyAllOut)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attempts to calculate the Groebner basis or bases that correspond to the system-experiment model differential polyomial regular chain sysExpModelRegChainIn.  <a href="#508059810f709aae7aa7a862284cb2ab"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="508059810f709aae7aa7a862284cb2ab"></a><!-- doxytag: member="calcGroebnerBasis.h::calcGroebnerBasis" ref="508059810f709aae7aa7a862284cb2ab" args="(int level, int nTheta, int thetaSeed, int nIdentComp, int nObservType, int nDoseType, const char *sysExpModelRegChainIn, const char *naturalOrderingIn, const char *charSetOrderingIn, int **nGroebnerBasisPolyEachOut, int *nGroebnerBasisPolyTotalOut, char ***groebnerBasisPolyAllOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calcGroebnerBasis           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>thetaSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nIdentComp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nObservType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nDoseType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>sysExpModelRegChainIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>naturalOrderingIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>charSetOrderingIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&nbsp;</td>
          <td class="paramname"> <em>nGroebnerBasisPolyEachOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nGroebnerBasisPolyTotalOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char ***&nbsp;</td>
          <td class="paramname"> <em>groebnerBasisPolyAllOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Attempts to calculate the Groebner basis or bases that correspond to the system-experiment model differential polyomial regular chain sysExpModelRegChainIn. 
<p>
Note that there can be multiple Groebner bases found.<p>
To be specific, this function attempts to calculate the Groebner bases for the exhaustive summary polynomials that come from the input/output relations' coefficients, which are evaluated at a random value for the vector that will be determined to be identifiable or not, THETA. See Audoly et al. (2001) for details on the identifiability algorithm.<p>
Note that if the Groebner bases are calculated successfully, then memory will be allocated by this function for an array of C strings containing each of the polynomials in each of the bases. When these polynomials are no longer needed, the memory required to store them and the memory required for the array should be freed by the caller of this function.<p>
Reference:<p>
S. Audoly, G. Bella, L. D'Angio, M. P. Saccomani, and C. Cobelli, "Global Identifiability of Nonlinear Models of Biological Systems," IEEE Transactions on Biomedical Engineering, Vol. 48, pp. 55 - 65, January 2001.<p>
F. Boulier, "The bad library (version 1.7.2)", pp. 2-6, 2004.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>If level = 0, then no intermediate information from the identifiability calculation will be printed to standard output. If level = 1, then all of the intermediate information will be printed except for the system-experiment model. If level = 2, then all of the intermediate information will be printed including the system-experiment model.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nTheta</em>&nbsp;</td><td>The number of elements in the THETA vector, which are the parameters that will be checked to be identifiable or not.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>thetaSeed</em>&nbsp;</td><td>The value to use to seed the random number generator used to generate the random value for THETA.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nIdentComp</em>&nbsp;</td><td>The number of compartments that have ordinary differential equations associated with them. The masses in the compartments are functions of the time variable T and are labeled A1, A2, ... , AP, where P = nIdentComp .</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nObservType</em>&nbsp;</td><td>The number of observation types, i.e., the number of different data streams that have measured values. If there is more than one type of observation, then they will be labeled Y1, Y2, ..., YV, in the differential polynomials that make up the system-experiment model, where V = nObservType . If there is only one observation type, then it will be simply labeled Y.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nDoseType</em>&nbsp;</td><td>The number of dose types, i.e., the number of different compartments that will receive doses. If there is more than one type of dose, then they will be labeled U1, U2, ..., UQ , in the differential polynomials that make up the system-experiment model, where Q = nDoseType . If there is only dose type, then it will be simply labeled U.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sysExpModelRegChainIn</em>&nbsp;</td><td>This string is the sytem-experiment model regular chain, which contains all of the differential polynomials that describe the system and experiment. An example sytem-experiment model regular chain is <div class="fragment"><pre class="fragment">

    [A1[T] - THETA2*A2, A2[T] - THETA1*A1, Y1 - A1, THETA1[T], THETA2[T]]

</pre></div> The first and last characters of the string should be left and right square brackets, respectively, and each of the differential polynomials should be separted by a comma. This function assumes that the ordering for the parameters that appear in this regular chain is given by naturalOrderingIn. A regular chain is defined as a triangular set of polynomials, i.e., a set of polynomials having distinct leading variables. Every triangular set of polynomials describes an ideal of polynomials. See the BLAD library documentation, Boulier (2004), for more details on regular chains. Note that in BLAD library notation, the derivatives with respect to T are denoted <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{array}{ccc} A1[T] = \partial / \partial T A1(T), &amp; A1[T,T] = \partial / \partial T [ \partial / \partial T A1(T) ], &amp; \cdots \\ A2[T] = \partial / \partial T A2(T), &amp; A2[T,T] = \partial / \partial T [ \partial / \partial T A2(T) ], &amp; \cdots \\ . &amp; . &amp; . \\ . &amp; . &amp; . \\ . &amp; . &amp; . \mbox{} \end{array} \]" src="form_5.png">
<p>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>naturalOrderingIn</em>&nbsp;</td><td>This string is the natural ordering for the variables, which is the variable order that makes the set of the differential polynomials for the system-experiment model be a regular chain. It should be of the form <div class="fragment"><pre class="fragment">
 
    [[Y1, ... , YV, A1, ... , AP, U1, ... , UQ], [THETA1, ... , THETAR]]
 
</pre></div> where V = nObservType, P = nIdentComp, Q = nDoseType, and r = nTheta. If there is only one observation type, then it should be simply labeled Y. If there is only dose type, then it should be simply labeled U. The first and last characters of the string should be left and right square brackets, respectively.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>charSetOrderingIn</em>&nbsp;</td><td>This string is the characteristic set ordering for the variables, which is the variable order that eliminates the compartment amounts from the set of differential polynomials and leaves the characteristic set. It should be of the form <div class="fragment"><pre class="fragment">

  [[A1, ... , AP], [Y1, ... , YV, U1, ... , UQ], [THETA1, ..., THETAR]]

</pre></div> where V = nObservType, P = nIdentComp, Q = nDoseType, and r = nTheta. If there is only one observation type, then it should be simply labeled Y. If there is only dose type, then it should be simply labeled U. The first and last characters of the string should be left and right square brackets, respectively.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nGroebnerBasisPolyEachOut</em>&nbsp;</td><td>If the Groebner bases were calculated successfully, then the integer array pointed to by this pointer to an integer array will be allocated to have nGroebnerBasis elements. The elements of this array will be set equal to the number of polynomials for each of the Groebner bases that were found. When this array is no longer needed, its memory should be released by the caller of this function. No memory should be allocated by the caller before calling this function, however, because this function does the allocation. It is the responsibility of the caller of the function to free the memory allocated by this function.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nGroebnerBasisPolyTotalOut</em>&nbsp;</td><td>If the Groebner bases were calculated successfully, then the integer pointed to this integer pointer will be set equal to the total number of polynomials in all of the Groebner bases.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>groebnerBasisPolyAllOut</em>&nbsp;</td><td>If the Groebner bases were calculated successfully, then the memory pointed to by this pointer to a pointer to a char pointer (char***) will contain an array with separate C strings for each of the polynomials for each of the bases. An example Groebner bases polynomial with a single basis made up of a single polynomial is <div class="fragment"><pre class="fragment">

    THETA1*THETA2 - 28

</pre></div> When these polynomials are no longer needed, the memory required to store them should be released by the caller of this function. No memory should be allocated by the caller before calling this function, however, because this function does the allocation. It is the responsibility of the caller of the function to free the memory allocated by this function. The memory pointed to by groebnerBasisOut will be allocated using malloc() as a C array of nGroebnerBasisPolyTotalOut pointers to C style strings, each of which contains a polynomial from one of the Groebner bases and each of which will be allocated using malloc() with enough memory to hold the polynomial. The value for nGroebnerBasisPolyTotalOut is equal to the sum of all of the elements in nGroebnerBasisPolyEachOut. The following code shows how to get a pointer to the C string that contains the m-th polynomial: <div class="fragment"><pre class="fragment">     <span class="keywordtype">char</span>* poly_m = (*groebnerBasisPolyAllOut)[m];
</pre></div> When the polynomials are no longer needed, then the memory for each C string must be freed using free() and the memory for the array of pointers to the polynomials' C strings must be freed also using free(). The following code shows how to free all of the memory allocated by this function to hold the Groebner bases polynomials: <div class="fragment"><pre class="fragment">   <span class="keywordflow">for</span> ( m = 0; m &lt; nGroebnerBasisPolyTotalOut; m++)
   {
     <span class="comment">// Free the memory for this polynomial's C style string.</span>
     free( (*groebnerBasisPolyAllOut)[m] );
   }
 
   <span class="comment">// Free the memory for the pointers to the C style strings.</span>
   free( (*groebnerBasisPolyAllOut) );
</pre></div> The above code should be executed by the caller of this function.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd></dd></dl>
If the Groebner bases could not be calculated, then the return value will be equal to 0.<p>
If the Groebner bases were calculated successfully, then the return value will be the number of Groebner bases that were found. 
<p>
Definition at line <a class="el" href="calcGroebnerBasis_8c-source.html#l00282">282</a> of file <a class="el" href="calcGroebnerBasis_8c-source.html">calcGroebnerBasis.c</a>.
<p>
Referenced by <a class="el" href="IdentPredBase_8h-source.html#l00374">IdentPredBase&lt; Value &gt;::checkIndParamIdent()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Mon Sep 10 10:13:35 2007 for SPK Pred Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
