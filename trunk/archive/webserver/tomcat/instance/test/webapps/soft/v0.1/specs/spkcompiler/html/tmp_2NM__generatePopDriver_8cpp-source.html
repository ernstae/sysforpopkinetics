<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SPK Compiler API Documentation: NM_generatePopDriver.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">spkcompiler</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">nonmem</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">tmp</a></div>
<h1>tmp/NM_generatePopDriver.cpp</h1><div class="fragment"><pre class="fragment">00001 
00005 <span class="preprocessor">#include &lt;fstream&gt;</span>
00006 
00007 <span class="preprocessor">#include "<a class="code" href="NonmemTranslator_8h.html">NonmemTranslator.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="SpkCompilerException_8h.html">SpkCompilerException.h</a>"</span>
00009 
00010 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00011 <span class="keyword">using</span> <span class="keyword">namespace </span>xercesc;
00012 
00013 <span class="keywordtype">void</span> <a class="code" href="classNonmemTranslator.html#d24">NonmemTranslator::generatePopDriver</a>()<span class="keyword"> const</span>
00014 <span class="keyword"></span>{
00015   <span class="comment">//==================================================================</span>
00016   <span class="comment">// Generate the driver</span>
00017   <span class="comment">//==================================================================</span>
00018   ofstream oPopDriver ( fFitDriver_cpp );
00019   <span class="keywordflow">if</span>( !oPopDriver.good() )
00020     {
00021       <span class="keywordtype">char</span> mess[ <a class="code" href="classSpkCompilerError.html#e3">SpkCompilerError::maxMessageLen</a>() ];
00022       snprintf( mess, SpkCompilerError::maxMessageLen(),
00023         <span class="stringliteral">"Failed to create %s file."</span>,
00024            fFitDriver_cpp );
00025       <a class="code" href="classSpkCompilerException.html">SpkCompilerException</a> e( SpkCompilerError::ASPK_STD_ERR, mess, __LINE__, __FILE__ );
00026       <span class="keywordflow">throw</span> e;
00027     }
00028 
00029   <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a>* pTheta = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::THETA);
00030   <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a>* pOmega = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::OMEGA);
00031   <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a>* pSigma = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::SIGMA);
00032   <span class="keyword">const</span> <a class="code" href="classSymbol.html">Symbol</a>* pEta   = <a class="code" href="classNonmemTranslator.html#r1">table</a>-&gt;<a class="code" href="classSymbolTable.html#a1">find</a>(nonmem::ETA);
00033   
00034   oPopDriver &lt;&lt; <span class="stringliteral">"// "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r2">myDescription</a> &lt;&lt; endl;
00035 
00036   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;iostream&gt;"</span>                   &lt;&lt; endl;
00037   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;fstream&gt;"</span>                    &lt;&lt; endl;
00038   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;sys/time.h&gt;"</span>                 &lt;&lt; endl;
00039   oPopDriver &lt;&lt; endl;
00040 
00041   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/SpkValarray.h&gt;"</span>          &lt;&lt; endl;
00042   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/SpkException.h&gt;"</span>         &lt;&lt; endl;
00043   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/WarningsManager.h&gt;"</span>      &lt;&lt; endl;
00044   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;CppAD/CppAD.h&gt;"</span>              &lt;&lt; endl;
00045   oPopDriver &lt;&lt; endl;
00046  
00047   oPopDriver &lt;&lt; <span class="stringliteral">"// For parameter estimate "</span> &lt;&lt; endl;
00048   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/fitPopulation.h&gt;"</span>    &lt;&lt; endl;
00049   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/Optimizer.h&gt;"</span>        &lt;&lt; endl;
00050   oPopDriver &lt;&lt; endl;
00051 
00052   oPopDriver &lt;&lt; <span class="stringliteral">"// For statistics"</span> &lt;&lt; endl;
00053   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/derParStatistics.h&gt;"</span> &lt;&lt; endl;
00054   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/popStatistics.h&gt;"</span>    &lt;&lt; endl;
00055   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/inverse.h&gt;"</span>          &lt;&lt; endl;
00056   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/lTilde.h&gt;"</span>           &lt;&lt; endl;
00057   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/NaiveFoModel.h&gt;"</span>     &lt;&lt; endl;
00058   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/multiply.h&gt;"</span>         &lt;&lt; endl;
00059   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/cholesky.h&gt;"</span>         &lt;&lt; endl;
00060   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/indResiduals.h&gt;"</span>     &lt;&lt; endl;
00061   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/popResiduals.h&gt;"</span>     &lt;&lt; endl;
00062   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/symmetrize.h&gt;"</span>       &lt;&lt; endl;
00063   oPopDriver &lt;&lt; endl;
00064 
00065   oPopDriver &lt;&lt; <span class="stringliteral">"// For data simulation"</span> &lt;&lt; endl;
00066   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spk/simulate.h&gt;"</span> &lt;&lt; endl;
00067   oPopDriver &lt;&lt; endl;
00068 
00069   oPopDriver &lt;&lt; <span class="stringliteral">"// SPK Compiler generated headers/classes"</span> &lt;&lt; endl;
00070   oPopDriver &lt;&lt; <span class="stringliteral">"#include \"IndData.h\""</span>      &lt;&lt; endl;
00071   oPopDriver &lt;&lt; <span class="stringliteral">"#include \"DataSet.h\""</span>      &lt;&lt; endl;
00072   oPopDriver &lt;&lt; endl;
00073 
00074   oPopDriver &lt;&lt; <span class="stringliteral">"//   NONMEM specific"</span>   &lt;&lt; endl;
00075   <span class="keywordflow">if</span>( myModelSpec == PRED )
00076     oPopDriver &lt;&lt; <span class="stringliteral">"#include \"Pred.h\""</span> &lt;&lt; endl;
00077   <span class="keywordflow">else</span>
00078     oPopDriver &lt;&lt; <span class="stringliteral">"#include \"OdePred.h\""</span> &lt;&lt; endl;
00079 
00080   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spkpred/Cov.h&gt;"</span>                &lt;&lt; endl;
00081   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spkpred/IndPredModel.h&gt;"</span>       &lt;&lt; endl;
00082   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spkpred/PopPredModel.h&gt;"</span>       &lt;&lt; endl;
00083   oPopDriver &lt;&lt; <span class="stringliteral">"#include &lt;spkpred/predTwoStageMethod.h&gt;"</span> &lt;&lt; endl;
00084   oPopDriver &lt;&lt; <span class="stringliteral">"#include \"NonmemPars.h\""</span>   &lt;&lt; endl;
00085   oPopDriver &lt;&lt; endl;
00086 
00087   oPopDriver &lt;&lt; <span class="stringliteral">"using SPK_VA::valarray;"</span> &lt;&lt; endl;
00088   oPopDriver &lt;&lt; <span class="stringliteral">"using namespace std;"</span> &lt;&lt; endl;
00089   oPopDriver &lt;&lt; endl;
00090   oPopDriver &lt;&lt; <span class="stringliteral">"enum RETURN_CODE { SUCCESS              = 0,"</span>   &lt;&lt; endl;
00091   oPopDriver &lt;&lt; <span class="stringliteral">"                   UNKNOWN_ERROR        = 1,"</span>   &lt;&lt; endl;
00092   oPopDriver &lt;&lt; <span class="stringliteral">"                   UNKNOWN_FAILURE      = 2,"</span>   &lt;&lt; endl;
00093   oPopDriver &lt;&lt; <span class="stringliteral">"                   FILE_ACCESS_ERROR    = 10,"</span>  &lt;&lt; endl;
00094   oPopDriver &lt;&lt; <span class="stringliteral">"                   OPTIMIZATION_ERROR   = 12,"</span>  &lt;&lt; endl;
00095   oPopDriver &lt;&lt; <span class="stringliteral">"                   STATISTICS_ERROR     = 13,"</span>  &lt;&lt; endl;
00096   oPopDriver &lt;&lt; <span class="stringliteral">"                   USER_INPUT_ERROR     = 14,"</span>  &lt;&lt; endl;
00097   oPopDriver &lt;&lt; <span class="stringliteral">"                   PROGRAMMER_ERROR     = 15,"</span>  &lt;&lt; endl;
00098   oPopDriver &lt;&lt; <span class="stringliteral">"                   SIMULATION_ERROR     = 16,"</span>  &lt;&lt; endl;
00099   oPopDriver &lt;&lt; <span class="stringliteral">"                   FILE_ACCESS_FAILURE  = 100,"</span> &lt;&lt; endl;
00100   oPopDriver &lt;&lt; <span class="stringliteral">"                   RESERVED_DO_NOT_USE  = 101,"</span> &lt;&lt; endl;
00101   oPopDriver &lt;&lt; <span class="stringliteral">"                   OPTIMIZATION_FAILURE = 102,"</span> &lt;&lt; endl;
00102   oPopDriver &lt;&lt; <span class="stringliteral">"                   STATISTICS_FAILURE   = 103,"</span> &lt;&lt; endl;
00103   oPopDriver &lt;&lt; <span class="stringliteral">"                   PROGRAMMER_FAILURE   = 105,"</span> &lt;&lt; endl;
00104   oPopDriver &lt;&lt; <span class="stringliteral">"                   SIMULATION_FAILURE   = 106"</span>  &lt;&lt; endl;
00105   oPopDriver &lt;&lt; <span class="stringliteral">"                 };"</span>       &lt;&lt; endl;
00106   oPopDriver &lt;&lt; endl;
00107 
00108   oPopDriver &lt;&lt; <span class="stringliteral">"int main( int argc, const char argv[] )"</span> &lt;&lt; endl;
00109   oPopDriver &lt;&lt; <span class="stringliteral">"{"</span> &lt;&lt; endl;
00110   oPopDriver &lt;&lt; <span class="stringliteral">"   /*******************************************************************/"</span> &lt;&lt; endl;
00111   oPopDriver &lt;&lt; <span class="stringliteral">"   /*                                                                 */"</span> &lt;&lt; endl;
00112   oPopDriver &lt;&lt; <span class="stringliteral">"   /*   Variable declarations and definitions                         */"</span> &lt;&lt; endl;
00113   oPopDriver &lt;&lt; <span class="stringliteral">"   /*                                                                 */"</span> &lt;&lt; endl;
00114   oPopDriver &lt;&lt; <span class="stringliteral">"   /*******************************************************************/"</span> &lt;&lt; endl;
00115   oPopDriver &lt;&lt; <span class="stringliteral">"   enum RETURN_CODE ret = SUCCESS;"</span> &lt;&lt; endl;
00116   oPopDriver &lt;&lt; endl;
00117 
00118   oPopDriver &lt;&lt; <span class="stringliteral">"   SpkException errors;"</span> &lt;&lt; endl;
00119   oPopDriver &lt;&lt; <span class="stringliteral">"   try{"</span> &lt;&lt; endl;
00120   oPopDriver &lt;&lt; <span class="stringliteral">"      ofstream oLongError;"</span> &lt;&lt; endl;
00121   oPopDriver &lt;&lt; endl;
00122 
00123   oPopDriver &lt;&lt; <span class="stringliteral">"      const bool isSimRequested     = "</span> &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r4">myIsSimulate</a>? <span class="stringliteral">"true"</span>:<span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00124   oPopDriver &lt;&lt; <span class="stringliteral">"      bool haveCompleteData         = !isSimRequested;"</span> &lt;&lt; endl;
00125   oPopDriver &lt;&lt; endl;
00126 
00127   oPopDriver &lt;&lt; <span class="stringliteral">"      const bool isOptRequested     = "</span> &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r3">myIsEstimate</a>? <span class="stringliteral">"true"</span>:<span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00128   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isOptSuccess             = !isOptRequested;"</span> &lt;&lt; endl;
00129   oPopDriver &lt;&lt; <span class="stringliteral">"      Objective objective           = "</span>;
00130   <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a14">getApproximation</a>() == FO )
00131     oPopDriver &lt;&lt; <span class="stringliteral">"FIRST_ORDER;"</span> &lt;&lt; endl;
00132   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a14">getApproximation</a>() == FOCE )
00133     oPopDriver &lt;&lt; <span class="stringliteral">"EXPECTED_HESSIAN;"</span> &lt;&lt; endl;
00134   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a14">getApproximation</a>() == STD_TWO_STAGE )
00135     oPopDriver &lt;&lt; <span class="stringliteral">"STANDARD_TWO_STAGE;"</span> &lt;&lt; endl;
00136   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a14">getApproximation</a>() == GLOBAL_TWO_STAGE )
00137     oPopDriver &lt;&lt; <span class="stringliteral">"GLOBAL_TWO_STAGE;"</span> &lt;&lt; endl;
00138   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classClientTranslator.html#a14">getApproximation</a>() == ITERATIVE_TWO_STAGE )
00139     oPopDriver &lt;&lt; <span class="stringliteral">"ITERATIVE_TWO_STAGE;"</span> &lt;&lt; endl;
00140   <span class="keywordflow">else</span>
00141     oPopDriver &lt;&lt; <span class="stringliteral">"MODIFIED_LAPLACE;"</span> &lt;&lt; endl;
00142   oPopDriver &lt;&lt; endl;
00143 
00144   oPopDriver &lt;&lt; <span class="stringliteral">"      const bool isStatRequested    = "</span> &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r5">myIsStat</a>? <span class="stringliteral">"true"</span>:<span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00145   oPopDriver &lt;&lt; <span class="stringliteral">"      enum PopCovForm covForm       = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r40">myCovForm</a> &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00146   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isStatSuccess            = !isStatRequested;"</span> &lt;&lt; endl;
00147   oPopDriver &lt;&lt; endl;
00148 
00149   oPopDriver &lt;&lt; <span class="stringliteral">"      const bool isRestartRequested = "</span> &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r18">myIsRestart</a>? <span class="stringliteral">"true"</span>:<span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00150   oPopDriver &lt;&lt; endl;
00151 
00152   oPopDriver &lt;&lt; <span class="stringliteral">"      const int nRepeats            = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r16">mySubproblemsN</a> &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00153   oPopDriver &lt;&lt; endl;
00154 
00155   oPopDriver &lt;&lt; <span class="stringliteral">"      const bool isPostHoc          = "</span> &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r17">myIsPosthoc</a>? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00156   oPopDriver &lt;&lt; endl;
00157 
00158   oPopDriver &lt;&lt; <span class="stringliteral">"      DataSet&lt; CppAD::AD&lt;double&gt; &gt; set;"</span> &lt;&lt; endl;
00159   oPopDriver &lt;&lt; <span class="stringliteral">"      const int           nPop      = NonmemPars::nIndividuals;"</span> &lt;&lt; endl;
00160   oPopDriver &lt;&lt; <span class="stringliteral">"      const valarray&lt;int&gt; NObservs  = set.getNObservs();"</span> &lt;&lt; endl;
00161   oPopDriver &lt;&lt; <span class="stringliteral">"      const valarray&lt;int&gt; NRecords  = set.getNRecords();"</span> &lt;&lt; endl;
00162   oPopDriver &lt;&lt; <span class="stringliteral">"      const int           nY        = NObservs.sum();"</span> &lt;&lt; endl;
00163   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt;    y( nY );"</span> &lt;&lt; endl;
00164   oPopDriver &lt;&lt; endl;
00165 
00166   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; thetaIn  ( NonmemPars::thetaIn );"</span> &lt;&lt; endl;
00167   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; omegaIn  ( NonmemPars::omegaIn );"</span> &lt;&lt; endl;
00168   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; sigmaIn  ( NonmemPars::sigmaIn );"</span> &lt;&lt; endl;
00169   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; thetaOut ( NonmemPars::nTheta );"</span> &lt;&lt; endl;
00170   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; omegaOut ( NonmemPars::omegaOrder );"</span> &lt;&lt; endl;
00171   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; sigmaOut ( NonmemPars::sigmaOrder );"</span> &lt;&lt; endl;
00172   oPopDriver &lt;&lt; endl;
00173 
00174   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00175   oPopDriver &lt;&lt; <span class="stringliteral">"      //   Model initialization"</span> &lt;&lt; endl;
00176   <span class="keywordflow">if</span>( myModelSpec == PRED )
00177     {
00178       oPopDriver &lt;&lt; <span class="stringliteral">"      Pred&lt; CppAD::AD&lt;double&gt; &gt; mPred(&amp;set);"</span> &lt;&lt; endl;
00179     }
00180   <span class="keywordflow">else</span> <span class="comment">// ADVAN</span>
00181     {
00182       oPopDriver &lt;&lt; <span class="stringliteral">"      OdePred&lt;CppAD::AD&lt;double&gt; &gt; mPred( &amp;set, "</span> &lt;&lt; endl;
00183       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nIndividuals, "</span> &lt;&lt; endl;
00184       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::isPkFunctionOfT,"</span> &lt;&lt; endl;
00185       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nCompartments,"</span> &lt;&lt; endl;
00186       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nParameters,"</span> &lt;&lt; endl;
00187       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::defaultDoseComp,"</span> &lt;&lt; endl;
00188       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::defaultObservationComp,"</span> &lt;&lt; endl;
00189       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::initialOff,"</span> &lt;&lt; endl;
00190       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::noOff,"</span> &lt;&lt; endl;
00191       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::noDose,"</span> &lt;&lt; endl;
00192       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::relTol"</span> &lt;&lt; endl;
00193       oPopDriver &lt;&lt; <span class="stringliteral">"                                       );"</span> &lt;&lt; endl;
00194     }
00195   oPopDriver &lt;&lt; <span class="stringliteral">"      PopPredModel model( mPred,"</span>                   &lt;&lt; endl;
00196   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nTheta,"</span>      &lt;&lt; endl;
00197   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaLow,"</span>    &lt;&lt; endl;
00198   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaUp,"</span>     &lt;&lt; endl;
00199   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaIn,"</span>     &lt;&lt; endl;
00200   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nEta,"</span>        &lt;&lt; endl;
00201   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::etaIn,"</span>       &lt;&lt; endl;
00202   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nEps,"</span>        &lt;&lt; endl;
00203   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaStruct,"</span> &lt;&lt; endl;
00204   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaIn,"</span>     &lt;&lt; endl;
00205   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaFixed,"</span>  &lt;&lt; endl;
00206   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockStruct,"</span>      &lt;&lt; endl;
00207   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockDims,"</span>        &lt;&lt; endl;
00208   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockSameAsPrev,"</span>  &lt;&lt; endl;
00209   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaStruct,"</span> &lt;&lt; endl;
00210   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaIn,"</span>     &lt;&lt; endl;
00211   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaFixed,"</span>  &lt;&lt; endl;
00212   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockStruct,"</span>      &lt;&lt; endl;
00213   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockDims,"</span>        &lt;&lt; endl;
00214   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockSameAsPrev );"</span>&lt;&lt; endl;
00215   oPopDriver &lt;&lt; <span class="stringliteral">"      //"</span> &lt;&lt; endl;
00216   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00217   oPopDriver &lt;&lt; endl;
00218   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00219   oPopDriver &lt;&lt; <span class="stringliteral">"      //   DataSet and Model for disposal; this DataSet instance is used "</span> &lt;&lt; endl;
00220   oPopDriver &lt;&lt; <span class="stringliteral">"      //   for computations other than parameter estimation, in order to"</span> &lt;&lt; endl;
00221   oPopDriver &lt;&lt; <span class="stringliteral">"      //   save the values at the end of estimation."</span> &lt;&lt; endl;
00222   oPopDriver &lt;&lt; <span class="stringliteral">"      DataSet&lt; CppAD::AD&lt;double&gt; &gt; dataForDisposal;"</span> &lt;&lt; endl;
00223   <span class="keywordflow">if</span>( myModelSpec == PRED )
00224     {
00225       oPopDriver &lt;&lt; <span class="stringliteral">"      Pred&lt; CppAD::AD&lt;double&gt; &gt; predForDisposal(&amp;dataForDisposal);"</span> &lt;&lt; endl;
00226     }
00227   <span class="keywordflow">else</span>
00228     {
00229       oPopDriver &lt;&lt; <span class="stringliteral">"      OdePred&lt; CppAD::AD&lt;double&gt; &gt; predForDisposal( &amp;dataForDisposal, "</span> &lt;&lt; endl;
00230       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nIndividuals, "</span> &lt;&lt; endl;
00231       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::isPkFunctionOfT,"</span> &lt;&lt; endl;
00232       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nCompartments,"</span> &lt;&lt; endl;
00233       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::nParameters,"</span> &lt;&lt; endl;
00234       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::defaultDoseComp,"</span> &lt;&lt; endl;
00235       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::defaultObservationComp,"</span> &lt;&lt; endl;
00236       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::initialOff,"</span> &lt;&lt; endl;
00237       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::noOff,"</span> &lt;&lt; endl;
00238       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::noDose,"</span> &lt;&lt; endl;
00239       oPopDriver &lt;&lt; <span class="stringliteral">"                                         NonmemPars::relTol"</span> &lt;&lt; endl;
00240       oPopDriver &lt;&lt; <span class="stringliteral">"                                       );"</span> &lt;&lt; endl;
00241     }
00242   oPopDriver &lt;&lt; <span class="stringliteral">"      PopPredModel modelForDisposal( predForDisposal,"</span>                   &lt;&lt; endl;
00243   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nTheta,"</span>      &lt;&lt; endl;
00244   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaLow,"</span>    &lt;&lt; endl;
00245   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaUp,"</span>     &lt;&lt; endl;
00246   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::thetaIn,"</span>     &lt;&lt; endl;
00247   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nEta,"</span>        &lt;&lt; endl;
00248   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::etaIn,"</span>       &lt;&lt; endl;
00249   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::nEps,"</span>        &lt;&lt; endl;
00250   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaStruct,"</span> &lt;&lt; endl;
00251   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaIn,"</span>     &lt;&lt; endl;
00252   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaFixed,"</span>  &lt;&lt; endl;
00253   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockStruct,"</span>      &lt;&lt; endl;
00254   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockDims,"</span>        &lt;&lt; endl;
00255   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::omegaBlockSameAsPrev,"</span>  &lt;&lt; endl;
00256   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaStruct,"</span> &lt;&lt; endl;
00257   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaIn,"</span>     &lt;&lt; endl;
00258   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaFixed,"</span>  &lt;&lt; endl;
00259   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockStruct,"</span>      &lt;&lt; endl;
00260   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockDims,"</span>        &lt;&lt; endl;
00261   oPopDriver &lt;&lt; <span class="stringliteral">"                          NonmemPars::sigmaBlockSameAsPrev );"</span>&lt;&lt; endl;
00262   oPopDriver &lt;&lt; <span class="stringliteral">"      //"</span> &lt;&lt; endl;
00263   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00264   oPopDriver &lt;&lt; endl;
00265 
00266   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00267   oPopDriver &lt;&lt; <span class="stringliteral">"      //   Model for two-stage methods."</span> &lt;&lt; endl;
00268   oPopDriver &lt;&lt; <span class="stringliteral">"      IndPredModel indModelForTwoStageMethod( predForDisposal,"</span> &lt;&lt; endl;
00269   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::nTheta,"</span> &lt;&lt; endl;
00270   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::thetaLow,"</span> &lt;&lt; endl;
00271   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::thetaUp,"</span> &lt;&lt; endl;
00272   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::thetaIn,"</span> &lt;&lt; endl;
00273   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::nEps,"</span> &lt;&lt; endl;
00274   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::sigmaStruct,"</span> &lt;&lt; endl;
00275   oPopDriver &lt;&lt; <span class="stringliteral">"                                              NonmemPars::sigmaIn );"</span> &lt;&lt; endl;
00276   oPopDriver &lt;&lt; endl;
00277   oPopDriver &lt;&lt; <span class="stringliteral">"      const int nBTwoStage = indModelForTwoStageMethod.getNIndPar();"</span> &lt;&lt; endl;
00278   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isTwoStageMethod;"</span> &lt;&lt; endl;
00279   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bTwoStageOut;"</span> &lt;&lt; endl;
00280   oPopDriver &lt;&lt; endl;
00281   oPopDriver &lt;&lt; <span class="stringliteral">"      if( objective == STANDARD_TWO_STAGE            ||"</span> &lt;&lt; endl;
00282   oPopDriver &lt;&lt; <span class="stringliteral">"          objective == ITERATIVE_TWO_STAGE           ||"</span> &lt;&lt; endl;
00283   oPopDriver &lt;&lt; <span class="stringliteral">"          objective == GLOBAL_TWO_STAGE              ||"</span> &lt;&lt; endl;
00284   oPopDriver &lt;&lt; <span class="stringliteral">"          objective == MAP_BAYES_STANDARD_TWO_STAGE  ||"</span> &lt;&lt; endl;
00285   oPopDriver &lt;&lt; <span class="stringliteral">"          objective == MAP_BAYES_ITERATIVE_TWO_STAGE ||"</span> &lt;&lt; endl;
00286   oPopDriver &lt;&lt; <span class="stringliteral">"          objective == MAP_BAYES_GLOBAL_TWO_STAGE )"</span> &lt;&lt; endl;
00287   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00288   oPopDriver &lt;&lt; <span class="stringliteral">"         isTwoStageMethod = true;"</span> &lt;&lt; endl;
00289   oPopDriver &lt;&lt; <span class="stringliteral">"         bTwoStageOut.resize( nBTwoStage * nPop );"</span> &lt;&lt; endl;
00290   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
00291   oPopDriver &lt;&lt; <span class="stringliteral">"      else"</span> &lt;&lt; endl;
00292   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00293   oPopDriver &lt;&lt; <span class="stringliteral">"         isTwoStageMethod = false;"</span> &lt;&lt; endl;
00294   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
00295   oPopDriver &lt;&lt; endl;
00296   oPopDriver &lt;&lt; <span class="stringliteral">"      //"</span> &lt;&lt; endl;
00297   oPopDriver &lt;&lt; <span class="stringliteral">"      ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
00298   oPopDriver &lt;&lt; endl;
00299 
00300   oPopDriver &lt;&lt; <span class="stringliteral">"      const int nAlp = model.getNPopPar();"</span> &lt;&lt; endl;
00301   oPopDriver &lt;&lt; <span class="stringliteral">"      const int nB   = model.getNIndPar();"</span> &lt;&lt; endl;
00302   oPopDriver &lt;&lt; endl;
00303    
00304   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpIn  ( nAlp );"</span> &lt;&lt; endl;
00305   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpUp  ( nAlp );"</span> &lt;&lt; endl;
00306   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpLow ( nAlp );"</span> &lt;&lt; endl;
00307   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpStep( nAlp );"</span> &lt;&lt; endl;
00308   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpOut ( nAlp );"</span> &lt;&lt; endl;
00309   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;bool&gt;   alpMask( nAlp );"</span> &lt;&lt; endl;
00310   oPopDriver &lt;&lt; endl;
00311   
00312   oPopDriver &lt;&lt; <span class="stringliteral">"      double           alpObjOut;"</span> &lt;&lt; endl;
00313   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpObj_alpOut    ( nAlp );"</span> &lt;&lt; endl;
00314   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpObj_alp_alpOut( nAlp * nAlp );"</span> &lt;&lt; endl;
00315   oPopDriver &lt;&lt; endl;
00316 
00317   oPopDriver &lt;&lt; <span class="stringliteral">"      model.getPopPar         ( alpIn );"</span> &lt;&lt; endl;
00318   oPopDriver &lt;&lt; <span class="stringliteral">"      model.getPopParLimits   ( alpLow, alpUp );"</span> &lt;&lt; endl;
00319   oPopDriver &lt;&lt; <span class="stringliteral">"      model.getPopParStep     ( alpStep );"</span> &lt;&lt; endl;
00320 
00321   oPopDriver &lt;&lt; endl;
00322 
00323   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bIn  ( nB * nPop );"</span> &lt;&lt; endl;
00324   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; biIn ( nB );"</span> &lt;&lt; endl;
00325   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bUp  ( nB );"</span> &lt;&lt; endl;
00326   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bLow ( nB );"</span> &lt;&lt; endl;
00327   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bStep( nB );"</span> &lt;&lt; endl;
00328   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; bOut ( nB * nPop );"</span> &lt;&lt; endl;
00329   oPopDriver &lt;&lt; <span class="stringliteral">"      for( int i=0; i&lt;nPop; i++ )"</span> &lt;&lt; endl;
00330   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00331   oPopDriver &lt;&lt; <span class="stringliteral">"         model.selectIndividual( i ); "</span> &lt;&lt; endl;
00332   oPopDriver &lt;&lt; <span class="stringliteral">"         model.getIndPar( biIn );"</span> &lt;&lt; endl;
00333   oPopDriver &lt;&lt; <span class="stringliteral">"         bIn[ slice(i*nB, nB, 1) ] = biIn;"</span> &lt;&lt; endl;
00334   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
00335   oPopDriver &lt;&lt; <span class="stringliteral">"      model.getIndParLimits ( bLow, bUp );"</span> &lt;&lt; endl;
00336   oPopDriver &lt;&lt; <span class="stringliteral">"      model.getIndParStep   ( bStep );"</span> &lt;&lt; endl;
00337   oPopDriver &lt;&lt; endl;
00338 
00339   oPopDriver &lt;&lt; <span class="stringliteral">"      timeval optBegin, optEnd;"</span> &lt;&lt; endl;
00340   oPopDriver &lt;&lt; <span class="stringliteral">"      double  optTimeSec = 0.0;"</span> &lt;&lt; endl;
00341   oPopDriver &lt;&lt; <span class="stringliteral">"      const   double popEps             = "</span>   &lt;&lt; <a class="code" href="classNonmemTranslator.html#r35">myPopEpsilon</a>    &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00342   oPopDriver &lt;&lt; <span class="stringliteral">"      const   int    popMitr            = "</span>   &lt;&lt; <a class="code" href="classNonmemTranslator.html#r33">myPopMitr</a>       &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00343   oPopDriver &lt;&lt; <span class="stringliteral">"      const   int    popTrace           = "</span>   &lt;&lt; <a class="code" href="classNonmemTranslator.html#r37">myPopTraceLevel</a> &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00344   oPopDriver &lt;&lt; <span class="stringliteral">"      const   string popCheckpointFile  = \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v20">fCheckpoint_xml</a> &lt;&lt; <span class="stringliteral">"\";"</span> &lt;&lt; endl;
00345   oPopDriver &lt;&lt; <span class="stringliteral">"      bool           popWriteCheckpoint = "</span>   &lt;&lt; (<a class="code" href="classNonmemTranslator.html#r12">myPopWriteCheckpoint</a>? <span class="stringliteral">"true"</span>:<span class="stringliteral">"false"</span>) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00346   oPopDriver &lt;&lt; <span class="stringliteral">"      ifstream       iCheckpoint( popCheckpointFile.c_str() );"</span>  &lt;&lt; endl;
00347   oPopDriver &lt;&lt; <span class="stringliteral">"      // Error if the user asked to continue but no checkpoint.xml is found "</span> &lt;&lt; endl;
00348   oPopDriver &lt;&lt; <span class="stringliteral">"      // in the current directory."</span> &lt;&lt; endl;
00349   oPopDriver &lt;&lt; <span class="stringliteral">"      if( isRestartRequested &amp;&amp; !iCheckpoint.good() )"</span> &lt;&lt; endl;
00350   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00351   oPopDriver &lt;&lt; <span class="stringliteral">"         char m[ SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00352   oPopDriver &lt;&lt; <span class="stringliteral">"         snprintf( m, "</span> &lt;&lt; endl;
00353   oPopDriver &lt;&lt; <span class="stringliteral">"                   SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00354   oPopDriver &lt;&lt; <span class="stringliteral">"                   \"Warm start is request but no checkpoint file found.\" );"</span> &lt;&lt; endl;
00355   oPopDriver &lt;&lt; <span class="stringliteral">"         SpkError e( SpkError::SPK_STD_ERR, m, __LINE__, __FILE__);"</span> &lt;&lt; endl;
00356   oPopDriver &lt;&lt; <span class="stringliteral">"         errors.push( e );"</span> &lt;&lt; endl;
00357   oPopDriver &lt;&lt; <span class="stringliteral">"         ret = FILE_ACCESS_FAILURE;"</span> &lt;&lt; endl;
00358   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
00359   oPopDriver &lt;&lt; <span class="stringliteral">"      // Flag to read the checkpoint file if that exists even "</span> &lt;&lt; endl;
00360   oPopDriver &lt;&lt; <span class="stringliteral">"      // if the user didn't ask a continuation."</span> &lt;&lt; endl;
00361   oPopDriver &lt;&lt; <span class="stringliteral">"      bool           popReadCheckpoint  = iCheckpoint.good();"</span>   &lt;&lt; endl;
00362   oPopDriver &lt;&lt; <span class="stringliteral">"      iCheckpoint.close();"</span>                                    &lt;&lt; endl;
00363   oPopDriver &lt;&lt; <span class="stringliteral">"      Optimizer      popOpt( popEps, "</span>                           &lt;&lt; endl;
00364   oPopDriver &lt;&lt; <span class="stringliteral">"                             popMitr, "</span>                          &lt;&lt; endl;
00365   oPopDriver &lt;&lt; <span class="stringliteral">"                             popTrace, "</span>                         &lt;&lt; endl;
00366   oPopDriver &lt;&lt; <span class="stringliteral">"                             popCheckpointFile, "</span>                &lt;&lt; endl;
00367   oPopDriver &lt;&lt; <span class="stringliteral">"                             popReadCheckpoint,"</span>                 &lt;&lt; endl;
00368   oPopDriver &lt;&lt; <span class="stringliteral">"                             popWriteCheckpoint );"</span>              &lt;&lt; endl;
00369   oPopDriver &lt;&lt; endl;
00370   oPopDriver &lt;&lt; <span class="stringliteral">"      const double   indEps   = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r36">myIndEpsilon</a>    &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00371   oPopDriver &lt;&lt; <span class="stringliteral">"      const int      indMitr  = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r34">myIndMitr</a>       &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00372   oPopDriver &lt;&lt; <span class="stringliteral">"      const int      indTrace = "</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#r38">myIndTraceLevel</a> &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00373   oPopDriver &lt;&lt; <span class="stringliteral">"      Optimizer      indOpt( indEps, indMitr, indTrace );"</span>  &lt;&lt; endl;
00374   oPopDriver &lt;&lt; endl;
00375  
00376   oPopDriver &lt;&lt; <span class="stringliteral">"      timeval statBegin, statEnd;"</span>                               &lt;&lt; endl;
00377   oPopDriver &lt;&lt; <span class="stringliteral">"      double statTimeSec = 0.0;"</span>                                 &lt;&lt; endl;
00378   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; alpCov( nAlp * nAlp );"</span>                   &lt;&lt; endl;
00379   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdPar( nAlp );"</span>                          &lt;&lt; endl;
00380   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdPar_alp( nAlp * nAlp );"</span>               &lt;&lt; endl;
00381   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;bool&gt;   stdParMask( nAlp );"</span>                      &lt;&lt; endl;
00382   oPopDriver &lt;&lt; <span class="stringliteral">"      const int nDegOfFreedom = nY - nAlp;"</span>                      &lt;&lt; endl;
00383   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isCovOut         = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r43">myIsCov</a>?    <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span>      &lt;&lt; endl;
00384   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isInvCovOut      = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r44">myIsInvCov</a>? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span>      &lt;&lt; endl;
00385   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isStdErrOut      = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r41">myIsStderr</a>? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span>      &lt;&lt; endl;
00386   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isCorrelationOut = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r42">myIsCorrelation</a>? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00387   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isCoefficientOut = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r46">myIsCoefficient</a>? <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00388   oPopDriver &lt;&lt; <span class="stringliteral">"      bool isConfidenceOut  = "</span> &lt;&lt; ( <a class="code" href="classNonmemTranslator.html#r45">myIsConfidence</a>?  <span class="stringliteral">"true"</span> : <span class="stringliteral">"false"</span> ) &lt;&lt; <span class="stringliteral">";"</span> &lt;&lt; endl;
00389   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParCovOut        ( nAlp * nAlp );"</span>     &lt;&lt; endl;
00390   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParSEOut         ( nAlp );"</span>            &lt;&lt; endl;
00391   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParCorrelationOut( nAlp * nAlp );"</span>     &lt;&lt; endl;
00392   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParCoefficientOut( nAlp );"</span>            &lt;&lt; endl;
00393   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParConfidenceOut ( 2 * nAlp );"</span>        &lt;&lt; endl;
00394   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; stdParInvCovOut     ( nAlp * nAlp );"</span>     &lt;&lt; endl;
00395   oPopDriver &lt;&lt; endl;
00396 
00397   oPopDriver &lt;&lt; <span class="stringliteral">"      int nTotalRecords = 0;"</span> &lt;&lt; endl;
00398   oPopDriver &lt;&lt; <span class="stringliteral">"      for( int i=0; i&lt;nPop; i++ )"</span> &lt;&lt; endl;
00399   oPopDriver &lt;&lt; <span class="stringliteral">"         nTotalRecords += set.getNRecords(i);"</span> &lt;&lt; endl;
00400   oPopDriver &lt;&lt; endl;
00401   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; predOut               ( nTotalRecords );"</span>      &lt;&lt; endl;
00402   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; resOut                ( nTotalRecords );"</span>      &lt;&lt; endl;
00403   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; resWtdOut             ( nTotalRecords );"</span>      &lt;&lt; endl;
00404   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; parResOut             ( nB*nPop );"</span> &lt;&lt; endl;
00405   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; parResWtdOut          ( nB*nPop );"</span> &lt;&lt; endl;
00406   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; predTruncatedOut      ( nY );"</span>      &lt;&lt; endl;
00407   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; resTruncatedOut       ( nY );"</span>      &lt;&lt; endl;
00408   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; resWtdTruncatedOut    ( nY );"</span>      &lt;&lt; endl;
00409   oPopDriver &lt;&lt; endl;
00410   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iPredOut              ( nTotalRecords );"</span>      &lt;&lt; endl;
00411   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iResOut               ( nTotalRecords );"</span>      &lt;&lt; endl;
00412   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iResWtdOut            ( nTotalRecords );"</span>      &lt;&lt; endl;
00413   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iParResOut            ( nB*nPop );"</span> &lt;&lt; endl;
00414   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iParResWtdOut         ( nB*nPop );"</span> &lt;&lt; endl;
00415   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iPredTruncatedOut     ( nY );"</span>      &lt;&lt; endl;
00416   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iResTruncatedOut      ( nY );"</span>      &lt;&lt; endl;
00417   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; iResWtdTruncatedOut   ( nY );"</span>      &lt;&lt; endl;
00418   oPopDriver &lt;&lt; endl;
00419   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pPredOut              ( nTotalRecords );"</span>      &lt;&lt; endl;
00420   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pResOut               ( nTotalRecords );"</span>      &lt;&lt; endl;
00421   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pResWtdOut            ( nTotalRecords );"</span>      &lt;&lt; endl;
00422   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pParResOut            ( nB*nPop );"</span> &lt;&lt; endl;
00423   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pParResWtdOut         ( nB*nPop );"</span> &lt;&lt; endl;
00424   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pPredTruncatedOut     ( nY );"</span>      &lt;&lt; endl;
00425   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pResTruncatedOut      ( nY );"</span>      &lt;&lt; endl;
00426   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; pResWtdTruncatedOut   ( nY );"</span>      &lt;&lt; endl;
00427   oPopDriver &lt;&lt; endl;
00428   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cPredOut              ( nTotalRecords );"</span>      &lt;&lt; endl;
00429   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cResOut               ( nTotalRecords );"</span>      &lt;&lt; endl;
00430   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cResWtdOut            ( nTotalRecords );"</span>      &lt;&lt; endl;
00431   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cParResOut            ( nB*nPop );"</span> &lt;&lt; endl;
00432   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cParResWtdOut         ( nB*nPop );"</span> &lt;&lt; endl;
00433   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cPredTruncatedOut     ( nY );"</span>      &lt;&lt; endl;
00434   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cResTruncatedOut      ( nY );"</span>      &lt;&lt; endl;
00435   oPopDriver &lt;&lt; <span class="stringliteral">"      valarray&lt;double&gt; cResWtdTruncatedOut   ( nY );"</span>      &lt;&lt; endl;
00436   oPopDriver &lt;&lt; endl;
00437 
00438   oPopDriver &lt;&lt; <span class="stringliteral">"      ofstream oResults;"</span> &lt;&lt; endl;
00439   oPopDriver &lt;&lt; <span class="stringliteral">"      string warningsOut;"</span> &lt;&lt; endl;
00440   oPopDriver &lt;&lt; <span class="stringliteral">"      int seed = NonmemPars::seed; "</span> &lt;&lt; endl;
00441   oPopDriver &lt;&lt; <span class="stringliteral">"      srand( seed );"</span> &lt;&lt; endl;
00442   oPopDriver &lt;&lt; <span class="stringliteral">"      int iSub = 0;"</span> &lt;&lt; endl;
00443   oPopDriver &lt;&lt; endl;
00444 
00445   <span class="comment">// do data simulation first to replace DV data in IndData objects</span>
00446   oPopDriver &lt;&lt; <span class="stringliteral">"      if( ret != SUCCESS )"</span> &lt;&lt; endl;
00447   oPopDriver &lt;&lt; <span class="stringliteral">"        goto REPORT_GEN;"</span> &lt;&lt; endl;
00448   oPopDriver &lt;&lt; endl;
00449   oPopDriver &lt;&lt; <span class="stringliteral">"      remove( \"result.xml\" );"</span> &lt;&lt; endl;
00450   oPopDriver &lt;&lt; <span class="stringliteral">"      for( iSub=0; iSub&lt;nRepeats; iSub++ )"</span> &lt;&lt; endl;
00451   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
00452   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
00453   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
00454   oPopDriver &lt;&lt; <span class="stringliteral">"         /*   Data Initialization                                           */"</span> &lt;&lt; endl;
00455   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
00456   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
00457   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isSimRequested )"</span> &lt;&lt; endl;
00458   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00459   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; yOut( nY );"</span> &lt;&lt; endl;
00460   oPopDriver &lt;&lt; <span class="stringliteral">"            try"</span> &lt;&lt; endl;
00461   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00462   oPopDriver &lt;&lt; <span class="stringliteral">"               simulate( model, alpIn, NObservs, bLow, bUp, yOut, bOut );"</span> &lt;&lt; endl;
00463   oPopDriver &lt;&lt; <span class="stringliteral">"               bIn = bOut;"</span> &lt;&lt; endl;
00464   oPopDriver &lt;&lt; <span class="stringliteral">"               set.replaceAllMeasurements( yOut );"</span> &lt;&lt; endl;
00465   oPopDriver &lt;&lt; <span class="stringliteral">"               y   = yOut;"</span> &lt;&lt; endl;
00466   oPopDriver &lt;&lt; <span class="stringliteral">"               haveCompleteData = true;"</span> &lt;&lt; endl;
00467   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00468   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( const SpkException&amp; e )"</span> &lt;&lt; endl;
00469   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00470   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
00471   oPopDriver &lt;&lt; <span class="stringliteral">"               haveCompleteData = false;"</span> &lt;&lt; endl;
00472   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = SIMULATION_ERROR;"</span> &lt;&lt; endl;
00473   oPopDriver &lt;&lt; <span class="stringliteral">"               goto REPORT_GEN;"</span> &lt;&lt; endl;
00474   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00475   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
00476   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00477   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] =\"Unknown exception: failed in data simulation.\";"</span> &lt;&lt; endl;
00478   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00479   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
00480   oPopDriver &lt;&lt; <span class="stringliteral">"               haveCompleteData = false;"</span> &lt;&lt; endl;
00481   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = SIMULATION_FAILURE;"</span> &lt;&lt; endl;
00482   oPopDriver &lt;&lt; <span class="stringliteral">"               goto REPORT_GEN;"</span> &lt;&lt; endl;
00483   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00484   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00485   oPopDriver &lt;&lt; <span class="stringliteral">"         else"</span> &lt;&lt; endl;
00486   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00487   oPopDriver &lt;&lt; <span class="stringliteral">"            y = set.getAllMeasurements();"</span> &lt;&lt; endl;
00488   oPopDriver &lt;&lt; <span class="stringliteral">"            haveCompleteData = true;"</span> &lt;&lt; endl;
00489   oPopDriver &lt;&lt; endl;
00490   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00491   oPopDriver &lt;&lt; endl;
00492  
00493   oPopDriver &lt;&lt; <span class="stringliteral">"OPTIMIZATION:"</span> &lt;&lt; endl;
00494   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
00495   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
00496   oPopDriver &lt;&lt; <span class="stringliteral">"         /*   Parameter Estimation                                          */"</span> &lt;&lt; endl;
00497   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
00498   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
00499   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isOptRequested &amp;&amp; haveCompleteData )"</span> &lt;&lt; endl;
00500   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00501   oPopDriver &lt;&lt; <span class="stringliteral">"            gettimeofday( &amp;optBegin, NULL );"</span> &lt;&lt; endl;
00502   oPopDriver &lt;&lt; <span class="stringliteral">"            try"</span> &lt;&lt; endl;
00503   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00504   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isTwoStageMethod )"</span> &lt;&lt; endl;
00505   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00506   oPopDriver &lt;&lt; <span class="stringliteral">"                  predTwoStageMethod( model,"</span> &lt;&lt; endl;
00507   oPopDriver &lt;&lt; <span class="stringliteral">"                                      indModelForTwoStageMethod,"</span> &lt;&lt; endl;
00508   oPopDriver &lt;&lt; <span class="stringliteral">"                                      objective,"</span> &lt;&lt; endl;
00509   oPopDriver &lt;&lt; <span class="stringliteral">"                                      NObservs,"</span> &lt;&lt; endl;
00510   oPopDriver &lt;&lt; <span class="stringliteral">"                                      y,"</span> &lt;&lt; endl;
00511   oPopDriver &lt;&lt; <span class="stringliteral">"                                      popOpt,"</span> &lt;&lt; endl;
00512   oPopDriver &lt;&lt; <span class="stringliteral">"                                      indOpt,"</span> &lt;&lt; endl;
00513   oPopDriver &lt;&lt; <span class="stringliteral">"                                      &amp;bTwoStageOut );"</span> &lt;&lt; endl;
00514   oPopDriver &lt;&lt; endl;
00515   oPopDriver &lt;&lt; <span class="stringliteral">"                  // The two-stage methods do not provide values for"</span> &lt;&lt; endl;
00516   oPopDriver &lt;&lt; <span class="stringliteral">"                  // the eta values that appear in the population"</span> &lt;&lt; endl;
00517   oPopDriver &lt;&lt; <span class="stringliteral">"                  // model, so just set them all equal to zero."</span> &lt;&lt; endl;
00518   oPopDriver &lt;&lt; <span class="stringliteral">"                  bOut = 0.0;"</span> &lt;&lt; endl;
00519   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00520   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
00521   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00522   oPopDriver &lt;&lt; <span class="stringliteral">"                  fitPopulation( model,"</span> &lt;&lt; endl;
00523   oPopDriver &lt;&lt; <span class="stringliteral">"                                 objective, "</span> &lt;&lt; endl;
00524   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NObservs,"</span> &lt;&lt; endl;
00525   oPopDriver &lt;&lt; <span class="stringliteral">"                                 y,"</span> &lt;&lt; endl;
00526   oPopDriver &lt;&lt; <span class="stringliteral">"                                 popOpt,"</span> &lt;&lt; endl;
00527   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpLow,"</span> &lt;&lt; endl;
00528   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpUp,"</span> &lt;&lt; endl;
00529   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpIn,"</span> &lt;&lt; endl;
00530   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpStep,"</span> &lt;&lt; endl;
00531   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;alpOut,"</span> &lt;&lt; endl;
00532   oPopDriver &lt;&lt; <span class="stringliteral">"                                 indOpt,"</span> &lt;&lt; endl;
00533   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bLow,"</span> &lt;&lt; endl;
00534   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bUp,"</span> &lt;&lt; endl;
00535   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bIn,"</span> &lt;&lt; endl;
00536   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bStep,"</span> &lt;&lt; endl;
00537   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;bOut,"</span> &lt;&lt; endl;
00538   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;alpObjOut,"</span> &lt;&lt; endl;
00539   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;alpObj_alpOut,"</span> &lt;&lt; endl;
00540   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;alpObj_alp_alpOut );"</span> &lt;&lt; endl;
00541   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00542   oPopDriver &lt;&lt; <span class="stringliteral">"               isOptSuccess = true;"</span>          &lt;&lt; endl;
00543   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00544   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00545   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00546   oPopDriver &lt;&lt; <span class="stringliteral">"               if( e.find( SpkError::SPK_TOO_MANY_ITER ) )"</span> &lt;&lt; endl;
00547   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = OPTIMIZATION_ERROR;"</span> &lt;&lt; endl;
00548   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
00549   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = USER_INPUT_ERROR;"</span> &lt;&lt; endl;
00550   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
00551   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00552   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
00553   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00554   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Unknown exception: failed in parameter estimation.\";"</span> &lt;&lt; endl;
00555   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00556   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
00557   oPopDriver &lt;&lt; <span class="stringliteral">"               isOptSuccess = false;"</span> &lt;&lt; endl;
00558   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = OPTIMIZATION_FAILURE;"</span> &lt;&lt; endl;
00559   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00560   oPopDriver &lt;&lt; <span class="stringliteral">"            gettimeofday( &amp;optEnd, NULL );"</span> &lt;&lt; endl;
00561   oPopDriver &lt;&lt; <span class="stringliteral">"            optTimeSec = difftime( optEnd.tv_sec, optBegin.tv_sec );"</span> &lt;&lt; endl;
00562   oPopDriver &lt;&lt; endl;
00563   oPopDriver &lt;&lt; <span class="stringliteral">"            // Get the latest values of theta, Omega and Sigma."</span> &lt;&lt; endl;
00564   oPopDriver &lt;&lt; <span class="stringliteral">"            // These values may be garbage if optimization had failed."</span> &lt;&lt; endl;
00565   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getTheta( thetaOut );"</span> &lt;&lt; endl;
00566   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getOmega( omegaOut );"</span> &lt;&lt; endl;
00567   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getSigma( sigmaOut );"</span> &lt;&lt; endl;
00568   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceEta( bOut );"</span> &lt;&lt; endl;
00569   oPopDriver &lt;&lt; endl;
00570   oPopDriver &lt;&lt; <span class="stringliteral">"            if( !isOptSuccess )"</span> &lt;&lt; endl;
00571   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00572   oPopDriver &lt;&lt; <span class="stringliteral">"               string optErrHeader;"</span> &lt;&lt; endl;
00573   oPopDriver &lt;&lt; <span class="stringliteral">"               string optErrMessage;"</span> &lt;&lt; endl;
00574   oPopDriver &lt;&lt; <span class="stringliteral">"               oLongError.open( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v19">fSpkRuntimeLongError_tmp</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
00575   oPopDriver &lt;&lt; <span class="stringliteral">"               if( !oLongError.good() )"</span> &lt;&lt; endl;
00576   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00577   oPopDriver &lt;&lt; <span class="stringliteral">"                  char m[ SpkError::maxMessageLen() ];"</span> &lt;&lt; endl;
00578   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( m, "</span> &lt;&lt; endl;
00579   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00580   oPopDriver &lt;&lt; <span class="stringliteral">"                            \"Failed to create a temporary file, %s, for writing.\", "</span> &lt;&lt; endl;
00581   oPopDriver &lt;&lt; <span class="stringliteral">"                           \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v19">fSpkRuntimeLongError_tmp</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
00582   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError e( SpkError::SPK_STD_ERR, m, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00583   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.push( e );"</span> &lt;&lt; endl;
00584   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = FILE_ACCESS_FAILURE;"</span> &lt;&lt; endl;
00585   oPopDriver &lt;&lt; <span class="stringliteral">"                  goto REPORT_GEN;"</span> &lt;&lt; endl;
00586   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00587   oPopDriver &lt;&lt; <span class="stringliteral">"               // If individual level estimation failed, then get any details as to why."</span> &lt;&lt; endl;
00588   oPopDriver &lt;&lt; <span class="stringliteral">"               if( indOpt.isThereErrorInfo() )"</span> &lt;&lt; endl;
00589   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00590   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader  = \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \\n\";"</span> &lt;&lt; endl;
00591   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"Individual level optimization failure details. \\n\";"</span> &lt;&lt; endl;
00592   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \\n\";"</span> &lt;&lt; endl;
00593   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"\\n\";"</span> &lt;&lt; endl;
00594   oPopDriver &lt;&lt; <span class="stringliteral">"                  indOpt.getErrorInfo("</span> &lt;&lt; endl;
00595   oPopDriver &lt;&lt; <span class="stringliteral">"                                       optErrHeader,"</span> &lt;&lt; endl;
00596   oPopDriver &lt;&lt; <span class="stringliteral">"                                       optErrMessage,"</span> &lt;&lt; endl;
00597   oPopDriver &lt;&lt; <span class="stringliteral">"                                       __LINE__,"</span> &lt;&lt; endl;
00598   oPopDriver &lt;&lt; <span class="stringliteral">"                                       __FILE__ );"</span> &lt;&lt; endl;
00599   oPopDriver &lt;&lt; <span class="stringliteral">"                  oLongError &lt;&lt; optErrMessage &lt;&lt; endl;"</span> &lt;&lt; endl;
00600   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00601   oPopDriver &lt;&lt; <span class="stringliteral">"               // If population level estimation failed, then get any details as to why."</span> &lt;&lt; endl;
00602   oPopDriver &lt;&lt; <span class="stringliteral">"               if( popOpt.isThereErrorInfo() )"</span> &lt;&lt; endl;
00603   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00604   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader  = \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \\n\";"</span> &lt;&lt; endl;
00605   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"Population level optimization failure details. \\n\";"</span> &lt;&lt; endl;
00606   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ \\n\";"</span> &lt;&lt; endl;
00607   oPopDriver &lt;&lt; <span class="stringliteral">"                  optErrHeader += \"\\n\";"</span> &lt;&lt; endl;
00608   oPopDriver &lt;&lt; <span class="stringliteral">"                  popOpt.getErrorInfo("</span> &lt;&lt; endl;
00609   oPopDriver &lt;&lt; <span class="stringliteral">"                                       optErrHeader,"</span> &lt;&lt; endl;
00610   oPopDriver &lt;&lt; <span class="stringliteral">"                                       optErrMessage,"</span> &lt;&lt; endl;
00611   oPopDriver &lt;&lt; <span class="stringliteral">"                                       __LINE__,"</span> &lt;&lt; endl;
00612   oPopDriver &lt;&lt; <span class="stringliteral">"                                       __FILE__ );"</span> &lt;&lt; endl;
00613   oPopDriver &lt;&lt; <span class="stringliteral">"                  oLongError &lt;&lt; optErrMessage &lt;&lt; endl;"</span> &lt;&lt; endl;
00614   oPopDriver &lt;&lt; <span class="stringliteral">"                  oLongError.close();"</span> &lt;&lt; endl;
00615   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00616   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00617   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00618   oPopDriver &lt;&lt; endl;
00619 
00620   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isOptRequested &amp;&amp; isOptSuccess &amp;&amp; !isTwoStageMethod )"</span> &lt;&lt; endl;
00621   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00622   oPopDriver &lt;&lt; <span class="stringliteral">"            assert( haveCompleteData );"</span> &lt;&lt; endl;
00623   oPopDriver &lt;&lt; <span class="stringliteral">"            Objective objForDisposal = FIRST_ORDER;"</span>    &lt;&lt; endl;
00624   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; yi;"</span>                       &lt;&lt; endl;
00625   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; bi( nB );"</span>                 &lt;&lt; endl;
00626   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiPredOut;"</span>                &lt;&lt; endl;
00627   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiResOut; "</span>                &lt;&lt; endl;
00628   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiResWtdOut;"</span>              &lt;&lt; endl;
00629   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiParResOut( nB );"</span>        &lt;&lt; endl;
00630   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiParResWtdOut( nB );"</span>     &lt;&lt; endl;
00631   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiPredTruncatedOut;"</span>       &lt;&lt; endl;
00632   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiResTruncatedOut; "</span>       &lt;&lt; endl;
00633   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iiResWtdTruncatedOut;"</span>     &lt;&lt; endl;
00634   oPopDriver &lt;&lt; <span class="stringliteral">"            modelForDisposal.setPopPar( alpOut );"</span>      &lt;&lt; endl;
00635   oPopDriver &lt;&lt; <span class="stringliteral">"            for( int i=0, j=0, k=0; i&lt;nPop; j+=NObservs[i], k+=NRecords[i++] )"</span>     &lt;&lt; endl;
00636   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00637   oPopDriver &lt;&lt; <span class="stringliteral">"               yi.resize         ( NObservs[i] );"</span>             &lt;&lt; endl;
00638   oPopDriver &lt;&lt; <span class="stringliteral">"               iiPredOut.resize  ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00639   oPopDriver &lt;&lt; <span class="stringliteral">"               iiResOut.resize   ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00640   oPopDriver &lt;&lt; <span class="stringliteral">"               iiResWtdOut.resize( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00641   oPopDriver &lt;&lt; <span class="stringliteral">"               iiPredTruncatedOut.resize  ( NObservs[i] );"</span>    &lt;&lt; endl;
00642   oPopDriver &lt;&lt; <span class="stringliteral">"               iiResTruncatedOut.resize   ( NObservs[i] );"</span>    &lt;&lt; endl;
00643   oPopDriver &lt;&lt; <span class="stringliteral">"               iiResWtdTruncatedOut.resize( NObservs[i] );"</span>    &lt;&lt; endl;
00644   oPopDriver &lt;&lt; <span class="stringliteral">"               yi = y[ slice( j, NObservs[i], 1 ) ]; "</span>         &lt;&lt; endl;
00645   oPopDriver &lt;&lt; <span class="stringliteral">"               bi = bOut[ slice( i*nB, nB, 1 ) ];"</span>      &lt;&lt; endl;
00646   oPopDriver &lt;&lt; <span class="stringliteral">"               modelForDisposal.selectIndividual( i );"</span> &lt;&lt; endl;
00647   oPopDriver &lt;&lt; <span class="stringliteral">"               modelForDisposal.setIndPar( bi );"</span>       &lt;&lt; endl;
00648   oPopDriver &lt;&lt; <span class="stringliteral">"               try{"</span> &lt;&lt; endl;
00649   oPopDriver &lt;&lt; <span class="stringliteral">"                  indResiduals( modelForDisposal,"</span>      &lt;&lt; endl;
00650   oPopDriver &lt;&lt; <span class="stringliteral">"                                yi, "</span>                   &lt;&lt; endl;
00651   oPopDriver &lt;&lt; <span class="stringliteral">"                                bi,"</span>                    &lt;&lt; endl;
00652   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iiPredTruncatedOut,"</span>    &lt;&lt; endl;
00653   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iiResTruncatedOut,"</span>     &lt;&lt; endl;
00654   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iiResWtdTruncatedOut, "</span> &lt;&lt; endl;
00655   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iiParResOut, "</span>          &lt;&lt; endl;
00656   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iiParResWtdOut );"</span>      &lt;&lt; endl;
00657   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iiPredTruncatedOut,   iiPredOut );"</span>   &lt;&lt; endl;
00658   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iiResTruncatedOut,    iiResOut );"</span>    &lt;&lt; endl;
00659   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iiResWtdTruncatedOut, iiResWtdOut );"</span> &lt;&lt; endl;
00660    oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00661   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00662   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00663   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00664   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00665   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00666   oPopDriver &lt;&lt;<span class="stringliteral">"                            \"Failed during the calculation of %i-th individual's residuals!\", i );"</span> &lt;&lt; endl;
00667   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00668   oPopDriver &lt;&lt; <span class="stringliteral">"                  e.push( ee );"</span> &lt;&lt; endl;
00669   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.cat( e );"</span> &lt;&lt; endl;
00670   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00671   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00672   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00673   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( ... )"</span> &lt;&lt; endl;
00674   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00675   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00676   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00677   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00678   oPopDriver &lt;&lt; <span class="stringliteral">"                           \"Unknown exception: failed during the calculation of %i-th individual's residuals.\", i );"</span> &lt;&lt; endl;
00679   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00680   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.push( e );"</span> &lt;&lt; endl;
00681   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00682   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = STATISTICS_FAILURE;"</span> &lt;&lt; endl;
00683   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00684   oPopDriver &lt;&lt; <span class="stringliteral">"               iPredOut     [ slice( k, set.getNRecords(i), 1 ) ]  = iiPredOut;"</span>      &lt;&lt; endl;
00685   oPopDriver &lt;&lt; <span class="stringliteral">"               iResOut      [ slice( k, set.getNRecords(i), 1 ) ]  = iiResOut;"</span>       &lt;&lt; endl;
00686   oPopDriver &lt;&lt; <span class="stringliteral">"               iResWtdOut   [ slice( k, set.getNRecords(i), 1 ) ]  = iiResWtdOut;"</span>    &lt;&lt; endl;
00687   oPopDriver &lt;&lt; <span class="stringliteral">"               iParResOut   [ slice( nB*i, nB, 1 ) ] = iiParResOut;"</span>    &lt;&lt; endl;
00688   oPopDriver &lt;&lt; <span class="stringliteral">"               iParResWtdOut[ slice( nB*i, nB, 1 ) ] = iiParResWtdOut;"</span> &lt;&lt; endl;
00689   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00690   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceIPred   ( iPredOut );"</span>           &lt;&lt; endl;
00691   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceIRes    ( iResOut );"</span>            &lt;&lt; endl;
00692   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceIWRes   ( iResWtdOut );"</span>         &lt;&lt; endl;
00693   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceIEtaRes ( iParResOut );"</span>         &lt;&lt; endl;
00694   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceIWEtaRes( iParResWtdOut );"</span>      &lt;&lt; endl;
00695   oPopDriver &lt;&lt; endl;
00696   oPopDriver &lt;&lt; <span class="stringliteral">"            try{"</span> &lt;&lt; endl;
00697   oPopDriver &lt;&lt; <span class="stringliteral">"               popResiduals( modelForDisposal, "</span>        &lt;&lt; endl;
00698   oPopDriver &lt;&lt; <span class="stringliteral">"                             objective, "</span>          &lt;&lt; endl;
00699   oPopDriver &lt;&lt; <span class="stringliteral">"                             NObservs,"</span>                 &lt;&lt; endl;
00700   oPopDriver &lt;&lt; <span class="stringliteral">"                             y,"</span>                        &lt;&lt; endl;
00701   oPopDriver &lt;&lt; <span class="stringliteral">"                             alpOut,"</span>                   &lt;&lt; endl;
00702   oPopDriver &lt;&lt; <span class="stringliteral">"                             bOut,"</span>                     &lt;&lt; endl;
00703   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;pPredTruncatedOut, "</span>       &lt;&lt; endl;
00704   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;pResTruncatedOut, "</span>        &lt;&lt; endl;
00705   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;pResWtdTruncatedOut, "</span>     &lt;&lt; endl;
00706   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;pParResOut, "</span>              &lt;&lt; endl;
00707   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;pParResWtdOut );"</span>          &lt;&lt; endl;
00708   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( pPredTruncatedOut,   pPredOut );"</span>   &lt;&lt; endl;
00709   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( pResTruncatedOut,    pResOut );"</span>    &lt;&lt; endl;
00710   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( pResWtdTruncatedOut, pResWtdOut );"</span> &lt;&lt; endl;
00711   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00712   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00713   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00714   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Failed during the calculation of population (non-conditional) residuals.\";"</span> &lt;&lt; endl;
00715   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00716   oPopDriver &lt;&lt; <span class="stringliteral">"               e.push( ee );"</span> &lt;&lt; endl;
00717   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
00718   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00719   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00720   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
00721   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00722   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Unknown exception: failed during the calculation of population (non-conditional) residuals.\";"</span> &lt;&lt; endl;
00723   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00724   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
00725   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00726   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00727   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePPred   ( pPredOut );"</span>           &lt;&lt; endl;
00728   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePRes    ( pResOut );"</span>            &lt;&lt; endl;
00729   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePWRes   ( pResWtdOut );"</span>         &lt;&lt; endl;
00730   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePEtaRes ( pParResOut );"</span>         &lt;&lt; endl;
00731   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePWEtaRes( pParResWtdOut );"</span>      &lt;&lt; endl;
00732   oPopDriver &lt;&lt; endl;
00733   oPopDriver &lt;&lt; <span class="stringliteral">"            try{"</span> &lt;&lt; endl;
00734   oPopDriver &lt;&lt; <span class="stringliteral">"               if( objective == FIRST_ORDER  || objective == NAIVE_FIRST_ORDER )"</span> &lt;&lt; endl;
00735   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00736   oPopDriver &lt;&lt; <span class="stringliteral">"                  bool calcFoModelMinimizer = true;"</span>       &lt;&lt; endl;
00737   oPopDriver &lt;&lt; <span class="stringliteral">"                  popResiduals( modelForDisposal, "</span>        &lt;&lt; endl;
00738   oPopDriver &lt;&lt; <span class="stringliteral">"                                objective, "</span>               &lt;&lt; endl;
00739   oPopDriver &lt;&lt; <span class="stringliteral">"                                NObservs,"</span>                 &lt;&lt; endl;
00740   oPopDriver &lt;&lt; <span class="stringliteral">"                                y,"</span>                        &lt;&lt; endl;
00741   oPopDriver &lt;&lt; <span class="stringliteral">"                                alpOut,"</span>                   &lt;&lt; endl;
00742   oPopDriver &lt;&lt; <span class="stringliteral">"                                bOut,"</span>                     &lt;&lt; endl;
00743   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;cPredTruncatedOut, "</span>       &lt;&lt; endl;
00744   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;cResTruncatedOut, "</span>        &lt;&lt; endl;
00745   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;cResWtdTruncatedOut, "</span>     &lt;&lt; endl;
00746   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;cParResOut, "</span>              &lt;&lt; endl;
00747   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;cParResWtdOut,"</span>            &lt;&lt; endl;
00748   oPopDriver &lt;&lt; <span class="stringliteral">"                                calcFoModelMinimizer );"</span>   &lt;&lt; endl;
00749   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( cPredTruncatedOut,   cPredOut );"</span>   &lt;&lt; endl;
00750   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( cResTruncatedOut,    cResOut );"</span>    &lt;&lt; endl;
00751   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( cResWtdTruncatedOut, cResWtdOut );"</span> &lt;&lt; endl;
00752   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCPred   ( cPredOut );"</span>        &lt;&lt; endl;
00753   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCRes    ( cResOut );"</span>         &lt;&lt; endl;
00754   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCWRes   ( cResWtdOut );"</span>      &lt;&lt; endl;
00755   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCEtaRes ( cParResOut );"</span>      &lt;&lt; endl;
00756   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCWEtaRes( cParResWtdOut );"</span>   &lt;&lt; endl;
00757   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00758   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
00759   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00760   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCPred   ( iPredOut );"</span>           &lt;&lt; endl;
00761   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCRes    ( iResOut );"</span>            &lt;&lt; endl;
00762   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCWRes   ( iResWtdOut );"</span>         &lt;&lt; endl;
00763   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCEtaRes ( iParResOut );"</span>         &lt;&lt; endl;
00764   oPopDriver &lt;&lt; <span class="stringliteral">"                  set.replaceCWEtaRes( iParResWtdOut );"</span>      &lt;&lt; endl;
00765   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00766   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00767   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00768   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00769   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Failed during the calculation of conditional residuals.\";"</span> &lt;&lt; endl;
00770   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00771   oPopDriver &lt;&lt; <span class="stringliteral">"               e.push( ee );"</span> &lt;&lt; endl;
00772   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
00773   oPopDriver &lt;&lt; <span class="stringliteral">"               isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00774   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00775   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00776   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
00777   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00778   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Unknown exception: failed during the calculation of conditional residuals.\";"</span> &lt;&lt; endl;
00779   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00780   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
00781   oPopDriver &lt;&lt; <span class="stringliteral">"               isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00782   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00783   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00784   oPopDriver &lt;&lt; endl;
00785   oPopDriver &lt;&lt; <span class="stringliteral">"            // Calculate the residuals with the individual parameters"</span> &lt;&lt; endl;
00786   oPopDriver &lt;&lt; <span class="stringliteral">"            // all equal to zero, which is the population mean value."</span> &lt;&lt; endl;
00787   oPopDriver &lt;&lt; <span class="stringliteral">"            try{"</span> &lt;&lt; endl;
00788   oPopDriver &lt;&lt; <span class="stringliteral">"               objForDisposal = FIRST_ORDER;"</span> &lt;&lt; endl;
00789   oPopDriver &lt;&lt; <span class="stringliteral">"               valarray&lt;double&gt; bAllZero( 0.0, nB * nPop );"</span> &lt;&lt; endl;
00790   oPopDriver &lt;&lt; <span class="stringliteral">"               popResiduals( modelForDisposal, "</span> &lt;&lt; endl;
00791   oPopDriver &lt;&lt; <span class="stringliteral">"                             objForDisposal, "</span> &lt;&lt; endl;
00792   oPopDriver &lt;&lt; <span class="stringliteral">"                             NObservs,"</span> &lt;&lt; endl;
00793   oPopDriver &lt;&lt; <span class="stringliteral">"                             y,"</span> &lt;&lt; endl;
00794   oPopDriver &lt;&lt; <span class="stringliteral">"                             alpOut,"</span> &lt;&lt; endl;
00795   oPopDriver &lt;&lt; <span class="stringliteral">"                             bAllZero,"</span> &lt;&lt; endl;
00796   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;predTruncatedOut, "</span> &lt;&lt; endl;
00797   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;resTruncatedOut, "</span> &lt;&lt; endl;
00798   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;resWtdTruncatedOut, "</span> &lt;&lt; endl;
00799   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;parResOut, "</span> &lt;&lt; endl;
00800   oPopDriver &lt;&lt; <span class="stringliteral">"                            &amp;parResWtdOut );"</span> &lt;&lt; endl;
00801   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( predTruncatedOut,   predOut );"</span> &lt;&lt; endl;
00802   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( resTruncatedOut,    resOut );"</span> &lt;&lt; endl;
00803   oPopDriver &lt;&lt; <span class="stringliteral">"               dataForDisposal.expand( resWtdTruncatedOut, resWtdOut );"</span> &lt;&lt; endl;
00804   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00805   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00806   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00807   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Failed during the calculation of standard residuals.\";"</span> &lt;&lt; endl;
00808   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00809   oPopDriver &lt;&lt; <span class="stringliteral">"               e.push( ee );"</span> &lt;&lt; endl;
00810   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
00811   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00812   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00813   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
00814   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00815   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Unknown exception: failed during the calculation of standard residuals.\";"</span> &lt;&lt; endl;
00816   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00817   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
00818   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00819   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00820   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replacePred   ( predOut );"</span> &lt;&lt; endl;
00821   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceRes    ( resOut );"</span> &lt;&lt; endl;
00822   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceWRes   ( resWtdOut );"</span> &lt;&lt; endl;
00823   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceEtaRes ( parResOut );"</span> &lt;&lt; endl;
00824   oPopDriver &lt;&lt; <span class="stringliteral">"            set.replaceWEtaRes( parResWtdOut );"</span> &lt;&lt; endl;
00825   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00826 
00827   oPopDriver &lt;&lt; <span class="stringliteral">"         // Calculate the residuals for the two-stage methods."</span> &lt;&lt; endl;
00828   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isOptRequested &amp;&amp; isOptSuccess &amp;&amp; isTwoStageMethod )"</span> &lt;&lt; endl;
00829   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
00830   oPopDriver &lt;&lt; <span class="stringliteral">"            assert( haveCompleteData );"</span> &lt;&lt; endl;
00831   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; yiTwoStage;"</span> &lt;&lt; endl;
00832   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; biTwoStage( nBTwoStage );"</span> &lt;&lt; endl;
00833   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStagePredOut;"</span> &lt;&lt; endl;
00834   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStageResOut; "</span> &lt;&lt; endl;
00835   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStageResWtdOut;"</span> &lt;&lt; endl;
00836   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStagePredTruncatedOut;"</span> &lt;&lt; endl;
00837   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStageResTruncatedOut; "</span> &lt;&lt; endl;
00838   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; iTwoStageResWtdTruncatedOut;"</span> &lt;&lt; endl;
00839   oPopDriver &lt;&lt; <span class="stringliteral">"            for( int i=0, j=0, k=0; i&lt;nPop; j+=NObservs[i], k+=NRecords[i++] )"</span> &lt;&lt; endl;
00840   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00841   oPopDriver &lt;&lt; <span class="stringliteral">"               yiTwoStage.resize        ( NObservs[i] );"</span> &lt;&lt; endl;
00842   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStagePredOut.resize  ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00843   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStageResOut.resize   ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00844   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStageResWtdOut.resize( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00845   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStagePredTruncatedOut.resize  ( NObservs[i] );"</span> &lt;&lt; endl;
00846   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStageResTruncatedOut.resize   ( NObservs[i] );"</span> &lt;&lt; endl;
00847   oPopDriver &lt;&lt; <span class="stringliteral">"               iTwoStageResWtdTruncatedOut.resize( NObservs[i] );"</span> &lt;&lt; endl;
00848   oPopDriver &lt;&lt; <span class="stringliteral">"               yiTwoStage = y[ slice( j, NObservs[i], 1 ) ]; "</span> &lt;&lt; endl;
00849   oPopDriver &lt;&lt; <span class="stringliteral">"               biTwoStage = bTwoStageOut[ slice( i*nBTwoStage, nBTwoStage, 1 ) ];"</span> &lt;&lt; endl;
00850   oPopDriver &lt;&lt; <span class="stringliteral">"               indModelForTwoStageMethod.selectIndividual( i );"</span> &lt;&lt; endl;
00851   oPopDriver &lt;&lt; <span class="stringliteral">"               indModelForTwoStageMethod.setIndPar( biTwoStage );"</span> &lt;&lt; endl;
00852   oPopDriver &lt;&lt; <span class="stringliteral">"               try{"</span> &lt;&lt; endl;
00853   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Don't calculate the individual's parameter residuals."</span> &lt;&lt; endl;
00854   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt;* pVANull = 0;"</span> &lt;&lt; endl;
00855   oPopDriver &lt;&lt; <span class="stringliteral">"                  indResiduals( indModelForTwoStageMethod,"</span> &lt;&lt; endl;
00856   oPopDriver &lt;&lt; <span class="stringliteral">"                                yiTwoStage, "</span> &lt;&lt; endl;
00857   oPopDriver &lt;&lt; <span class="stringliteral">"                                biTwoStage,"</span> &lt;&lt; endl;
00858   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iTwoStagePredTruncatedOut,"</span> &lt;&lt; endl;
00859   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iTwoStageResTruncatedOut,"</span> &lt;&lt; endl;
00860   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;iTwoStageResWtdTruncatedOut, "</span> &lt;&lt; endl;
00861   oPopDriver &lt;&lt; <span class="stringliteral">"                                pVANull, "</span> &lt;&lt; endl;
00862   oPopDriver &lt;&lt; <span class="stringliteral">"                                pVANull );"</span> &lt;&lt; endl;
00863   oPopDriver &lt;&lt; endl;
00864   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iTwoStagePredTruncatedOut,   iTwoStagePredOut );"</span> &lt;&lt; endl;
00865   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iTwoStageResTruncatedOut,    iTwoStageResOut );"</span> &lt;&lt; endl;
00866   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, iTwoStageResWtdTruncatedOut, iTwoStageResWtdOut );"</span> &lt;&lt; endl;
00867   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00868   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00869   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00870   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00871   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00872   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00873   oPopDriver &lt;&lt; <span class="stringliteral">"                            \"Failed during the calculation of %i-th individual's residuals!\", i );"</span> &lt;&lt; endl;
00874   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00875   oPopDriver &lt;&lt; <span class="stringliteral">"                  e.push( ee );"</span> &lt;&lt; endl;
00876   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.cat( e );"</span> &lt;&lt; endl;
00877   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00878   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00879   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00880   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( ... )"</span> &lt;&lt; endl;
00881   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00882   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00883   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00884   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00885   oPopDriver &lt;&lt; <span class="stringliteral">"                           \"Unknown exception: failed during the calculation of %i-th individual's residuals.\", i );"</span> &lt;&lt; endl;
00886   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00887   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.push( e );"</span> &lt;&lt; endl;
00888   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00889   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = STATISTICS_FAILURE;"</span> &lt;&lt; endl;
00890   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00891   oPopDriver &lt;&lt; <span class="stringliteral">"               iPredOut     [ slice( k, set.getNRecords(i), 1 ) ]  = iTwoStagePredOut;"</span> &lt;&lt; endl;
00892   oPopDriver &lt;&lt; <span class="stringliteral">"               iResOut      [ slice( k, set.getNRecords(i), 1 ) ]  = iTwoStageResOut;"</span> &lt;&lt; endl;
00893   oPopDriver &lt;&lt; <span class="stringliteral">"               iResWtdOut   [ slice( k, set.getNRecords(i), 1 ) ]  = iTwoStageResWtdOut;"</span> &lt;&lt; endl;
00894   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00895   oPopDriver &lt;&lt; <span class="stringliteral">"            // The two-stage methods do not provide values for the eta"</span> &lt;&lt; endl;
00896   oPopDriver &lt;&lt; <span class="stringliteral">"            // values that appear in the population model, so just set"</span> &lt;&lt; endl;
00897   oPopDriver &lt;&lt; <span class="stringliteral">"            // these residuals all equal to zero."</span> &lt;&lt; endl;
00898   oPopDriver &lt;&lt; <span class="stringliteral">"            iParResOut    = 0.0;"</span> &lt;&lt; endl;
00899   oPopDriver &lt;&lt; <span class="stringliteral">"            iParResWtdOut = 0.0;"</span> &lt;&lt; endl;
00900   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceIPred   ( iPredOut );"</span> &lt;&lt; endl;
00901   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceIRes    ( iResOut );"</span> &lt;&lt; endl;
00902   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceIWRes   ( iResWtdOut );"</span> &lt;&lt; endl;
00903   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceIEtaRes ( iParResOut );"</span> &lt;&lt; endl;
00904   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceIWEtaRes( iParResWtdOut );"</span> &lt;&lt; endl;
00905   oPopDriver &lt;&lt; endl;
00906   oPopDriver &lt;&lt; <span class="stringliteral">"            // The population model's theta value contains the population."</span> &lt;&lt; endl;
00907   oPopDriver &lt;&lt; <span class="stringliteral">"            // mean of the individuals' theta values."</span> &lt;&lt; endl;
00908   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; thetaTwoStagePopMean( NonmemPars::nTheta );"</span> &lt;&lt; endl;
00909   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getTheta( thetaTwoStagePopMean );"</span> &lt;&lt; endl;
00910   oPopDriver &lt;&lt; <span class="stringliteral">"            indModelForTwoStageMethod.setTheta( thetaTwoStagePopMean );"</span> &lt;&lt; endl;
00911   oPopDriver &lt;&lt; endl;
00912   oPopDriver &lt;&lt; <span class="stringliteral">"            // The population model's sigma value contains the population."</span> &lt;&lt; endl;
00913   oPopDriver &lt;&lt; <span class="stringliteral">"            // mean of the individuals' omega values."</span> &lt;&lt; endl;
00914   oPopDriver &lt;&lt; <span class="stringliteral">"            int nTwoStageSigmaPar = model.getSigma().getNPar();"</span> &lt;&lt; endl;
00915   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; omegaTwoStagePopMeanMinRep( nTwoStageSigmaPar );"</span> &lt;&lt; endl;
00916   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; omegaTwoStagePopMean( NonmemPars::nEps * NonmemPars::nEps );"</span> &lt;&lt; endl;
00917   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getSigma( omegaTwoStagePopMeanMinRep );"</span> &lt;&lt; endl;
00918   oPopDriver &lt;&lt; <span class="stringliteral">"            model.getSigma().expandCovMinRep( omegaTwoStagePopMeanMinRep, omegaTwoStagePopMean );"</span> &lt;&lt; endl;
00919   oPopDriver &lt;&lt; <span class="stringliteral">"            indModelForTwoStageMethod.setOmega( omegaTwoStagePopMean );"</span> &lt;&lt; endl;
00920   oPopDriver &lt;&lt; endl;
00921   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; bTwoStagePopMean( nBTwoStage );"</span> &lt;&lt; endl;
00922   oPopDriver &lt;&lt; <span class="stringliteral">"            indModelForTwoStageMethod.getIndPar( bTwoStagePopMean );"</span> &lt;&lt; endl;
00923   oPopDriver &lt;&lt; endl;
00924   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStagePredOut;"</span> &lt;&lt; endl;
00925   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStageResOut; "</span> &lt;&lt; endl;
00926   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStageResWtdOut;"</span> &lt;&lt; endl;
00927   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStagePredTruncatedOut;"</span> &lt;&lt; endl;
00928   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStageResTruncatedOut; "</span> &lt;&lt; endl;
00929   oPopDriver &lt;&lt; <span class="stringliteral">"            valarray&lt;double&gt; twoStageResWtdTruncatedOut;"</span> &lt;&lt; endl;
00930   oPopDriver &lt;&lt; <span class="stringliteral">"            for( int i=0, j=0, k=0; i&lt;nPop; j+=NObservs[i], k+=NRecords[i++] )"</span> &lt;&lt; endl;
00931   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
00932   oPopDriver &lt;&lt; <span class="stringliteral">"               yiTwoStage.resize        ( NObservs[i] );"</span> &lt;&lt; endl;
00933   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStagePredOut.resize  ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00934   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStageResOut.resize   ( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00935   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStageResWtdOut.resize( dataForDisposal.getNRecords(i) );"</span> &lt;&lt; endl;
00936   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStagePredTruncatedOut.resize  ( NObservs[i] );"</span> &lt;&lt; endl;
00937   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStageResTruncatedOut.resize   ( NObservs[i] );"</span> &lt;&lt; endl;
00938   oPopDriver &lt;&lt; <span class="stringliteral">"               twoStageResWtdTruncatedOut.resize( NObservs[i] );"</span> &lt;&lt; endl;
00939   oPopDriver &lt;&lt; <span class="stringliteral">"               yiTwoStage = y[ slice( j, NObservs[i], 1 ) ]; "</span> &lt;&lt; endl;
00940   oPopDriver &lt;&lt; <span class="stringliteral">"               indModelForTwoStageMethod.selectIndividual( i );"</span> &lt;&lt; endl;
00941   oPopDriver &lt;&lt; <span class="stringliteral">"               try{"</span> &lt;&lt; endl;
00942   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Don't calculate the individual's parameter residuals."</span> &lt;&lt; endl;
00943   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt;* pVANull = 0;"</span> &lt;&lt; endl;
00944   oPopDriver &lt;&lt; <span class="stringliteral">"                  indResiduals( indModelForTwoStageMethod,"</span> &lt;&lt; endl;
00945   oPopDriver &lt;&lt; <span class="stringliteral">"                                yiTwoStage, "</span> &lt;&lt; endl;
00946   oPopDriver &lt;&lt; <span class="stringliteral">"                                bTwoStagePopMean,"</span> &lt;&lt; endl;
00947   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;twoStagePredTruncatedOut,"</span> &lt;&lt; endl;
00948   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;twoStageResTruncatedOut,"</span> &lt;&lt; endl;
00949   oPopDriver &lt;&lt; <span class="stringliteral">"                               &amp;twoStageResWtdTruncatedOut, "</span> &lt;&lt; endl;
00950   oPopDriver &lt;&lt; <span class="stringliteral">"                                pVANull, "</span> &lt;&lt; endl;
00951   oPopDriver &lt;&lt; <span class="stringliteral">"                                pVANull );"</span> &lt;&lt; endl;
00952   oPopDriver &lt;&lt; endl;
00953   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, twoStagePredTruncatedOut,   twoStagePredOut );"</span> &lt;&lt; endl;
00954   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, twoStageResTruncatedOut,    twoStageResOut );"</span> &lt;&lt; endl;
00955   oPopDriver &lt;&lt; <span class="stringliteral">"                  dataForDisposal.expand( i, twoStageResWtdTruncatedOut, twoStageResWtdOut );"</span> &lt;&lt; endl;
00956   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00957   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( SpkException&amp; e )"</span> &lt;&lt; endl;
00958   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00959   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00960   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00961   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00962   oPopDriver &lt;&lt; <span class="stringliteral">"                            \"Failed during the calculation of %i-th individual's residuals!\", i );"</span> &lt;&lt; endl;
00963   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError ee( SpkError::SPK_STATISTICS_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00964   oPopDriver &lt;&lt; <span class="stringliteral">"                  e.push( ee );"</span> &lt;&lt; endl;
00965   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.cat( e );"</span> &lt;&lt; endl;
00966   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00967   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = PROGRAMMER_FAILURE;"</span> &lt;&lt; endl;
00968   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00969   oPopDriver &lt;&lt; <span class="stringliteral">"               catch( ... )"</span> &lt;&lt; endl;
00970   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
00971   oPopDriver &lt;&lt; <span class="stringliteral">"                  char message[SpkError::maxMessageLen()];"</span> &lt;&lt; endl;
00972   oPopDriver &lt;&lt; <span class="stringliteral">"                  snprintf( message, "</span> &lt;&lt; endl;
00973   oPopDriver &lt;&lt; <span class="stringliteral">"                            SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
00974   oPopDriver &lt;&lt; <span class="stringliteral">"                           \"Unknown exception: failed during the calculation of %i-th individual's residuals.\", i );"</span> &lt;&lt; endl;
00975   oPopDriver &lt;&lt; <span class="stringliteral">"                  SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
00976   oPopDriver &lt;&lt; <span class="stringliteral">"                  errors.push( e );"</span> &lt;&lt; endl;
00977   oPopDriver &lt;&lt; <span class="stringliteral">"                  isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
00978   oPopDriver &lt;&lt; <span class="stringliteral">"                  ret = STATISTICS_FAILURE;"</span> &lt;&lt; endl;
00979   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
00980   oPopDriver &lt;&lt; <span class="stringliteral">"               predOut     [ slice( k, set.getNRecords(i), 1 ) ]  = twoStagePredOut;"</span> &lt;&lt; endl;
00981   oPopDriver &lt;&lt; <span class="stringliteral">"               resOut      [ slice( k, set.getNRecords(i), 1 ) ]  = twoStageResOut;"</span> &lt;&lt; endl;
00982   oPopDriver &lt;&lt; <span class="stringliteral">"               resWtdOut   [ slice( k, set.getNRecords(i), 1 ) ]  = twoStageResWtdOut;"</span> &lt;&lt; endl;
00983   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
00984   oPopDriver &lt;&lt; <span class="stringliteral">"            // The two-stage methods do not provide values for the eta"</span> &lt;&lt; endl;
00985   oPopDriver &lt;&lt; <span class="stringliteral">"            // values that appear in the population model, so just set"</span> &lt;&lt; endl;
00986   oPopDriver &lt;&lt; <span class="stringliteral">"            // these residuals all equal to zero."</span> &lt;&lt; endl;
00987   oPopDriver &lt;&lt; <span class="stringliteral">"            parResOut    = 0.0;"</span> &lt;&lt; endl;
00988   oPopDriver &lt;&lt; <span class="stringliteral">"            parResWtdOut = 0.0;"</span> &lt;&lt; endl;
00989   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replacePred   ( predOut );"</span> &lt;&lt; endl;
00990   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceRes    ( resOut );"</span> &lt;&lt; endl;
00991   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceWRes   ( resWtdOut );"</span> &lt;&lt; endl;
00992   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceEtaRes ( parResOut );"</span> &lt;&lt; endl;
00993   oPopDriver &lt;&lt; <span class="stringliteral">"            dataForDisposal.replaceWEtaRes( parResWtdOut );"</span> &lt;&lt; endl;
00994   oPopDriver &lt;&lt; endl;
00995   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
00996   oPopDriver &lt;&lt; endl;
00997  
00998   <span class="comment">// Statistics can be only computed when the parameter estimation has been done.</span>
00999   oPopDriver &lt;&lt; <span class="stringliteral">"STATISTICS:"</span> &lt;&lt; endl;
01000   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
01001   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
01002   oPopDriver &lt;&lt; <span class="stringliteral">"         /*   Statistics                                                    */"</span> &lt;&lt; endl;
01003   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
01004   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
01005   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isStatRequested &amp;&amp; isOptRequested &amp;&amp; isOptSuccess &amp;&amp; !isTwoStageMethod )"</span> &lt;&lt; endl;
01006   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01007   oPopDriver &lt;&lt; <span class="stringliteral">"            gettimeofday( &amp;statBegin, NULL );"</span> &lt;&lt; endl;
01008   oPopDriver &lt;&lt; <span class="stringliteral">"            try"</span> &lt;&lt; endl;
01009   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01010   oPopDriver &lt;&lt; <span class="stringliteral">"               for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01011   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01012   oPopDriver &lt;&lt; <span class="stringliteral">"                  alpMask[i] = !( alpLow[i]==alpUp[i] || alpOut[i]==alpLow[i] || alpOut[i]==alpUp[i] );"</span> &lt;&lt; endl;
01013   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01014   oPopDriver &lt;&lt; <span class="stringliteral">"               model.getStandardParMask( alpMask, stdParMask );"</span> &lt;&lt; endl;
01015   oPopDriver &lt;&lt; <span class="stringliteral">"               model.getStandardPar( stdPar );"</span> &lt;&lt; endl;
01016   oPopDriver &lt;&lt; <span class="stringliteral">"               model.getStandardPar_popPar( stdPar_alp );"</span> &lt;&lt; endl;
01017   oPopDriver &lt;&lt; <span class="stringliteral">"               popStatistics(    modelForDisposal, "</span>                  &lt;&lt; endl;
01018   oPopDriver &lt;&lt; <span class="stringliteral">"                                 objective,"</span>               &lt;&lt; endl;
01019   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NObservs,"</span>                &lt;&lt; endl;
01020   oPopDriver &lt;&lt; <span class="stringliteral">"                                 y,"</span>                       &lt;&lt; endl;
01021   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpOut, "</span>                 &lt;&lt; endl;
01022   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpMask,"</span>                 &lt;&lt; endl;
01023   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpObj_alp_alpOut, "</span>      &lt;&lt; endl;
01024   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bOut,"</span>                    &lt;&lt; endl;
01025   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bLow,"</span>                    &lt;&lt; endl;
01026   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bUp,"</span>                     &lt;&lt; endl;
01027   oPopDriver &lt;&lt; <span class="stringliteral">"                                 bStep,"</span>                   &lt;&lt; endl;
01028   oPopDriver &lt;&lt; <span class="stringliteral">"                                 covForm,"</span>                 &lt;&lt; endl;
01029   oPopDriver &lt;&lt; <span class="stringliteral">"                                &amp;alpCov, "</span>                 &lt;&lt; endl;
01030   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NULL, "</span>                   &lt;&lt; endl;
01031   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NULL, "</span>                   &lt;&lt; endl;
01032   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NULL, "</span>                   &lt;&lt; endl;
01033   oPopDriver &lt;&lt; <span class="stringliteral">"                                 NULL );"</span>                  &lt;&lt; endl;
01034   oPopDriver &lt;&lt; endl;
01035   oPopDriver &lt;&lt; <span class="stringliteral">"               derParStatistics( alpMask,"</span>                 &lt;&lt; endl;
01036   oPopDriver &lt;&lt; <span class="stringliteral">"                                 alpCov,"</span>                  &lt;&lt; endl;
01037   oPopDriver &lt;&lt; <span class="stringliteral">"                                 stdParMask,"</span>              &lt;&lt; endl;
01038   oPopDriver &lt;&lt; <span class="stringliteral">"                                 stdPar,"</span>                  &lt;&lt; endl;
01039   oPopDriver &lt;&lt; <span class="stringliteral">"                                 stdPar_alp,"</span>              &lt;&lt; endl;
01040   oPopDriver &lt;&lt; <span class="stringliteral">"                                 nDegOfFreedom,"</span>           &lt;&lt; endl;
01041   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isCovOut || isInvCovOut? &amp;stdParCovOut        : NULL),"</span> &lt;&lt; endl;
01042   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isCovOut || isInvCovOut? &amp;stdParInvCovOut     : NULL),"</span> &lt;&lt; endl;
01043   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isStdErrOut?             &amp;stdParSEOut         : NULL),"</span> &lt;&lt; endl;
01044   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isCorrelationOut?        &amp;stdParCorrelationOut: NULL),"</span> &lt;&lt; endl;
01045   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isCoefficientOut?        &amp;stdParCoefficientOut: NULL),"</span> &lt;&lt; endl;
01046   oPopDriver &lt;&lt; <span class="stringliteral">"                                (isConfidenceOut?         &amp;stdParConfidenceOut : NULL) "</span> &lt;&lt; endl;
01047   oPopDriver &lt;&lt; <span class="stringliteral">"                               );"</span> &lt;&lt; endl;
01048   oPopDriver &lt;&lt; <span class="stringliteral">"               isStatSuccess &amp;= true;"</span> &lt;&lt; endl;
01049   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01050   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( SpkException&amp; e )"</span> &lt;&lt; endl;
01051   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01052   oPopDriver &lt;&lt; <span class="stringliteral">"               char mess[ SpkError::maxMessageLen() ];"</span> &lt;&lt; endl;
01053   oPopDriver &lt;&lt; <span class="stringliteral">"               snprintf( mess, "</span> &lt;&lt; endl;
01054   oPopDriver &lt;&lt; <span class="stringliteral">"                         SpkError::maxMessageLen(),"</span> &lt;&lt; endl;
01055   oPopDriver &lt;&lt; <span class="stringliteral">"                        \"Failed to compute statistics value(s).\\n\" );"</span> &lt;&lt; endl;
01056   oPopDriver &lt;&lt; <span class="stringliteral">"               e.push( SpkError::SPK_STATISTICS_ERR, mess, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
01057   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.cat( e );"</span> &lt;&lt; endl;
01058   oPopDriver &lt;&lt; <span class="stringliteral">"               isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
01059   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = STATISTICS_ERROR;"</span> &lt;&lt; endl;
01060   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01061   oPopDriver &lt;&lt; <span class="stringliteral">"            catch( ... )"</span> &lt;&lt; endl;
01062   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01063   oPopDriver &lt;&lt; <span class="stringliteral">"               char message[] = \"Unknown exception: failed in statistics calculation.\";"</span> &lt;&lt; endl;
01064   oPopDriver &lt;&lt; <span class="stringliteral">"               SpkError e( SpkError::SPK_UNKNOWN_ERR, message, __LINE__, __FILE__ );"</span> &lt;&lt; endl;
01065   oPopDriver &lt;&lt; <span class="stringliteral">"               errors.push( e );"</span> &lt;&lt; endl;
01066   oPopDriver &lt;&lt; <span class="stringliteral">"               isStatSuccess &amp;= false;"</span> &lt;&lt; endl;
01067   oPopDriver &lt;&lt; <span class="stringliteral">"               ret = STATISTICS_FAILURE;"</span> &lt;&lt; endl;
01068   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01069   oPopDriver &lt;&lt; <span class="stringliteral">"            gettimeofday( &amp;statEnd, NULL );"</span> &lt;&lt; endl;
01070   oPopDriver &lt;&lt; <span class="stringliteral">"            statTimeSec = difftime( statEnd.tv_sec, statBegin.tv_sec );"</span> &lt;&lt; endl;
01071   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01072   oPopDriver &lt;&lt; endl;
01073 
01074   oPopDriver &lt;&lt; <span class="stringliteral">"REPORT_GEN:"</span> &lt;&lt; endl;
01075   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
01076   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
01077   oPopDriver &lt;&lt; <span class="stringliteral">"         /*   ReportML Document                                             */"</span> &lt;&lt; endl;
01078   oPopDriver &lt;&lt; <span class="stringliteral">"         /*                                                                 */"</span> &lt;&lt; endl;
01079   oPopDriver &lt;&lt; <span class="stringliteral">"         /*******************************************************************/"</span> &lt;&lt; endl;
01080   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults.open( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\", ios_base::app );"</span> &lt;&lt; endl;
01081   oPopDriver &lt;&lt; <span class="stringliteral">"         if( !oResults.good() )"</span> &lt;&lt; endl;
01082   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01083   oPopDriver &lt;&lt; <span class="stringliteral">"            fprintf( stderr, \"Failed to open a file, %s, for writing output.\", \""</span>;
01084   oPopDriver &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
01085   oPopDriver &lt;&lt; <span class="stringliteral">"            ret = FILE_ACCESS_FAILURE;"</span> &lt;&lt; endl;
01086   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01087   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults.close();"</span> &lt;&lt; endl;
01088   oPopDriver &lt;&lt; <span class="stringliteral">"            goto END;"</span> &lt;&lt; endl;
01089   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01090 
01091   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01092   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;?xml version=\\\"1.0\\\"?&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01093   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01094   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01095   oPopDriver &lt;&lt; endl;
01096 
01097   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults &lt;&lt; \"&lt;error_list length=\\\"\" &lt;&lt; errors.size() &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01098   oPopDriver &lt;&lt; <span class="stringliteral">"         if( !(haveCompleteData &amp;&amp; isOptSuccess &amp;&amp; isStatSuccess) )"</span> &lt;&lt; endl;
01099   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01100   oPopDriver &lt;&lt; <span class="stringliteral">"            // Print out ordinary-length error messages"</span> &lt;&lt; endl;
01101   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; errors &lt;&lt; endl;"</span> &lt;&lt; endl;
01102   oPopDriver &lt;&lt; endl;
01103   oPopDriver &lt;&lt; <span class="stringliteral">"            // Print out a long error message if exists."</span> &lt;&lt; endl;
01104   oPopDriver &lt;&lt; <span class="stringliteral">"            char ch;"</span> &lt;&lt; endl;
01105   oPopDriver &lt;&lt; <span class="stringliteral">"            ifstream iLongError( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v19">fSpkRuntimeLongError_tmp</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
01106   oPopDriver &lt;&lt; <span class="stringliteral">"            while( iLongError.get(ch) )"</span> &lt;&lt; endl;
01107   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01108   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; ch;"</span> &lt;&lt; endl;
01109   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01110   oPopDriver &lt;&lt; <span class="stringliteral">"            iLongError.close();"</span> &lt;&lt; endl;
01111   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01112   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults &lt;&lt; \"&lt;/error_list&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01113   oPopDriver &lt;&lt; <span class="stringliteral">"         remove( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v19">fSpkRuntimeLongError_tmp</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
01114   oPopDriver &lt;&lt; endl;
01115 
01116   <span class="comment">// Print out &lt;warning_list&gt; even when it is empty.</span>
01117   oPopDriver &lt;&lt; <span class="stringliteral">"         WarningsManager::getAllWarnings( warningsOut );"</span> &lt;&lt; endl;
01118   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults &lt;&lt; warningsOut;"</span> &lt;&lt; endl;
01119   oPopDriver &lt;&lt; endl;
01120 
01121   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isSimRequested )"</span> &lt;&lt; endl;
01122   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01123   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;simulation \";"</span> &lt;&lt; endl;
01124   oPopDriver &lt;&lt; <span class="stringliteral">"            if( iSub == 0 )"</span> &lt;&lt; endl;
01125   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01126   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"seed=\\\"\" &lt;&lt; seed &lt;&lt; \"\\\" \";"</span> &lt;&lt; endl;
01127   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01128   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"subproblem=\\\"\" &lt;&lt; iSub+1 &lt;&lt; \"\\\"/&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01129   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01130   oPopDriver &lt;&lt; endl;
01131 
01132   oPopDriver &lt;&lt; <span class="stringliteral">"         if( isOptRequested )"</span> &lt;&lt; endl;
01133   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01134   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;pop_analysis_result&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01135   oPopDriver &lt;&lt; endl;
01136 
01137   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;pop_opt_result elapsedtime=\\\"\" &lt;&lt; optTimeSec &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01138   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;pop_obj_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01139   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; alpObjOut &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01140   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/pop_obj_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01141   oPopDriver &lt;&lt; endl;
01142   
01143   oPopDriver &lt;&lt; <span class="stringliteral">"            ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
01144   oPopDriver &lt;&lt; <span class="stringliteral">"            //   NONMEM Specific"</span> &lt;&lt; endl;
01145   <span class="comment">// theta in</span>
01146   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;theta_in length=\\\"\" &lt;&lt; NonmemPars::nTheta &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01147   oPopDriver &lt;&lt; <span class="stringliteral">"            for( int i=0; i&lt;NonmemPars::nTheta; i++ )"</span> &lt;&lt; endl;
01148   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01149   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; thetaIn[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01150   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01151   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/theta_in&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01152   <span class="comment">// theta out</span>
01153   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;theta_out length=\\\"\" &lt;&lt; NonmemPars::nTheta &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01154   oPopDriver &lt;&lt; <span class="stringliteral">"            for( int i=0; i&lt;NonmemPars::nTheta; i++ )"</span> &lt;&lt; endl;
01155   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01156   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; thetaOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01157   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01158   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/theta_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01159 
01160   <span class="comment">// sigma in</span>
01161   oPopDriver &lt;&lt; <span class="stringliteral">"            for(int ii=0, idx=0; ii&lt;NonmemPars::nSigmaBlk; ii++)"</span> &lt;&lt; endl;
01162   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01163   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;sigma_in dimension=\" &lt;&lt; \"\\\"\" &lt;&lt; NonmemPars::sigmaBlockDims[ii] &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01164   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \" struct=\" &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01165   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::sigmaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01166   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"diagonal\";"</span> &lt;&lt; endl;
01167   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
01168   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"block\";"</span> &lt;&lt; endl;
01169   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"\\\"\" &lt;&lt; \"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01170   <span class="comment">/*</span>
01171 <span class="comment">  oPopDriver &lt;&lt; "            for( int i=0; i&lt;NonmemPars::sigmaOrder; i++ )" &lt;&lt; endl;</span>
01172 <span class="comment">  oPopDriver &lt;&lt; "            {" &lt;&lt; endl;</span>
01173 <span class="comment">  oPopDriver &lt;&lt; "               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; sigmaIn[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01174 <span class="comment">  oPopDriver &lt;&lt; "            }" &lt;&lt; endl;</span>
01175 <span class="comment">  */</span>
01176   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::sigmaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01177   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01178   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;NonmemPars::sigmaBlockDims[ii]; i++ )"</span> &lt;&lt; endl;
01179   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01180   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; sigmaIn[idx] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01181   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01182   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01183   oPopDriver &lt;&lt; <span class="stringliteral">"               else // full"</span> &lt;&lt; endl;
01184   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01185   oPopDriver &lt;&lt; <span class="stringliteral">"                  int n = NonmemPars::sigmaBlockDims[ii];"</span> &lt;&lt; endl;
01186   oPopDriver &lt;&lt; <span class="stringliteral">"                  int m = (n*(n+1))/2;"</span> &lt;&lt; endl;
01187   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; full( n * n );"</span> &lt;&lt; endl;
01188   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; row_minimal( m );"</span> &lt;&lt; endl;
01189   oPopDriver &lt;&lt; endl;
01190   oPopDriver &lt;&lt; <span class="stringliteral">"                  // First make a full matrix out of the minimal representation"</span> &lt;&lt; endl;
01191   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int j=0; j&lt;n; j++ )"</span> &lt;&lt; endl;
01192   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01193   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int i=0; i&lt;n-j; i++, idx++ ) // lower only"</span> &lt;&lt; endl;
01194   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01195   oPopDriver &lt;&lt; <span class="stringliteral">"                        full[ (j*n)+(j+i) ] = sigmaIn[idx];"</span> &lt;&lt; endl;
01196   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01197   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01198   oPopDriver &lt;&lt; endl;
01199   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Copy the lower triangle to the upper and complete fullification"</span> &lt;&lt; endl;
01200   oPopDriver &lt;&lt; <span class="stringliteral">"                  symmetrize( full, n, full );"</span> &lt;&lt; endl;
01201   oPopDriver &lt;&lt; endl;
01202   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Read the lower triangle in the row-major order"</span> &lt;&lt; endl;
01203   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0, k=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
01204   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01205   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;i+1; j++, k++ )"</span> &lt;&lt; endl;
01206   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01207   oPopDriver &lt;&lt; <span class="stringliteral">"                        row_minimal[k] = full[(i*n)+j];"</span> &lt;&lt; endl;
01208   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01209   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01210   oPopDriver &lt;&lt; endl;
01211   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;m; i++ )"</span> &lt;&lt; endl;
01212   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01213   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; row_minimal[ i ];"</span> &lt;&lt; endl;
01214   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01215   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01216   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01217   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;/sigma_in&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01218   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01219 
01220   <span class="comment">// sigma out</span>
01221   oPopDriver &lt;&lt; <span class="stringliteral">"            for(int ii=0, idx=0; ii&lt;NonmemPars::nSigmaBlk; ii++)"</span> &lt;&lt; endl;
01222   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01223   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;sigma_out dimension=\" &lt;&lt; \"\\\"\" &lt;&lt; NonmemPars::sigmaBlockDims[ii] &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01224   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \" struct=\" &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01225   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::sigmaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01226   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"diagonal\";"</span> &lt;&lt; endl;
01227   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
01228   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"block\";"</span> &lt;&lt; endl;
01229   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"\\\"\" &lt;&lt; \"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01230   <span class="comment">/*</span>
01231 <span class="comment">  oPopDriver &lt;&lt; "            for( int i=0; i&lt;NonmemPars::sigmaOrder; i++ )" &lt;&lt; endl;</span>
01232 <span class="comment">  oPopDriver &lt;&lt; "            {" &lt;&lt; endl;</span>
01233 <span class="comment">  oPopDriver &lt;&lt; "               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; sigmaOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01234 <span class="comment">  oPopDriver &lt;&lt; "            }" &lt;&lt; endl;</span>
01235 <span class="comment">  oPopDriver &lt;&lt; "            oResults &lt;&lt; \"&lt;/sigma_out&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01236 <span class="comment">  */</span>
01237   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::sigmaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01238   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01239   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;NonmemPars::sigmaBlockDims[ii]; i++, idx++ )"</span> &lt;&lt; endl;
01240   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01241   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; sigmaOut[idx] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01242   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01243   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01244   oPopDriver &lt;&lt; <span class="stringliteral">"               else // full"</span> &lt;&lt; endl;
01245   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01246   oPopDriver &lt;&lt; <span class="stringliteral">"                  int n = NonmemPars::sigmaBlockDims[ii];"</span> &lt;&lt; endl;
01247   oPopDriver &lt;&lt; <span class="stringliteral">"                  int m = (n*(n+1))/2;"</span> &lt;&lt; endl;
01248   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; full( n * n );"</span> &lt;&lt; endl;
01249   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; row_minimal( m );"</span> &lt;&lt; endl;
01250   oPopDriver &lt;&lt; endl;
01251   oPopDriver &lt;&lt; <span class="stringliteral">"                  // First make a full matrix out of the minimal representation"</span> &lt;&lt; endl;
01252   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int j=0; j&lt;n; j++ )"</span> &lt;&lt; endl;
01253   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01254   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int i=0; i&lt;n-j; i++, idx++ ) // lower only"</span> &lt;&lt; endl;
01255   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01256   oPopDriver &lt;&lt; <span class="stringliteral">"                        full[ (j*n)+(j+i) ] = sigmaOut[idx];"</span> &lt;&lt; endl;
01257   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01258   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01259   oPopDriver &lt;&lt; endl;
01260   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Copy the lower triangle to the upper and complete fullification"</span> &lt;&lt; endl;
01261   oPopDriver &lt;&lt; <span class="stringliteral">"                  symmetrize( full, n, full );"</span> &lt;&lt; endl;
01262   oPopDriver &lt;&lt; endl;
01263   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Read the lower triangle in the row-major order"</span> &lt;&lt; endl;
01264   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0, k=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
01265   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01266   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;i+1; j++, k++ )"</span> &lt;&lt; endl;
01267   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01268   oPopDriver &lt;&lt; <span class="stringliteral">"                        row_minimal[k] = full[(i*n)+j];"</span> &lt;&lt; endl;
01269   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01270   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01271   oPopDriver &lt;&lt; endl;
01272   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;m; i++ )"</span> &lt;&lt; endl;
01273   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01274   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; row_minimal[ i ];"</span> &lt;&lt; endl;
01275   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01276   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01277   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01278   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;/sigma_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01279   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01280 
01281   <span class="comment">// omega in</span>
01282   oPopDriver &lt;&lt; <span class="stringliteral">"            for(int ii=0, idx=0; ii&lt;NonmemPars::nOmegaBlk; ii++)"</span> &lt;&lt; endl;
01283   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01284   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;omega_in dimension=\" &lt;&lt; \"\\\"\" &lt;&lt; NonmemPars::omegaBlockDims[ii] &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01285   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \" struct=\" &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01286   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::omegaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01287   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"diagonal\";"</span> &lt;&lt; endl;
01288   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
01289   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"block\";"</span> &lt;&lt; endl;
01290   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"\\\"\" &lt;&lt; \"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01291 
01292   <span class="comment">/*</span>
01293 <span class="comment">  oPopDriver &lt;&lt; "            for( int i=0; i&lt;NonmemPars::omegaOrder; i++ )" &lt;&lt; endl;</span>
01294 <span class="comment">  oPopDriver &lt;&lt; "            {" &lt;&lt; endl;</span>
01295 <span class="comment">  oPopDriver &lt;&lt; "               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; omegaIn[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01296 <span class="comment">  oPopDriver &lt;&lt; "            }" &lt;&lt; endl;</span>
01297 <span class="comment">  */</span>
01298 
01299   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::omegaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01300   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01301   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;NonmemPars::omegaBlockDims[ii]; i++, idx++ )"</span> &lt;&lt; endl;
01302   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01303   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; omegaIn[idx] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01304   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01305   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01306   oPopDriver &lt;&lt; <span class="stringliteral">"               else // full"</span> &lt;&lt; endl;
01307   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01308   oPopDriver &lt;&lt; <span class="stringliteral">"                  int n = NonmemPars::omegaDim;"</span> &lt;&lt; endl;
01309   oPopDriver &lt;&lt; <span class="stringliteral">"                  int m = (n*(n+1))/2;"</span> &lt;&lt; endl;
01310   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; full( n * n );"</span> &lt;&lt; endl;
01311   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; row_minimal( m );"</span> &lt;&lt; endl;
01312   oPopDriver &lt;&lt; endl;
01313   oPopDriver &lt;&lt; <span class="stringliteral">"                  // First make a full matrix out of the minimal representation"</span> &lt;&lt; endl;
01314   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int j=0; j&lt;n; j++ )"</span> &lt;&lt; endl;
01315   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01316   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int i=0; i&lt;n-j; i++, idx++ ) // lower only"</span> &lt;&lt; endl;
01317   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01318   oPopDriver &lt;&lt; <span class="stringliteral">"                        full[ (j*n)+(j+i) ] = omegaIn[idx];"</span> &lt;&lt; endl;
01319   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01320   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01321   oPopDriver &lt;&lt; endl;
01322   oPopDriver &lt;&lt; <span class="stringliteral">"                  // Copy the lower triangle to the upper and complete fullification"</span> &lt;&lt; endl;
01323   oPopDriver &lt;&lt; <span class="stringliteral">"                  symmetrize( full, n, full );"</span> &lt;&lt; endl;
01324   oPopDriver &lt;&lt; endl;
01325   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0, k=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
01326   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01327   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;i+1; j++, k++ )"</span> &lt;&lt; endl;
01328   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01329   oPopDriver &lt;&lt; <span class="stringliteral">"                        row_minimal[k] = full[i*n+j];"</span> &lt;&lt; endl;
01330   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01331   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01332   oPopDriver &lt;&lt; endl;
01333   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;m; i++ )"</span> &lt;&lt; endl;
01334   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01335   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; row_minimal[ i ];"</span> &lt;&lt; endl;
01336   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01337   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01338   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01339 
01340   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;/omega_in&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01341   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01342 
01343   <span class="comment">// omega out</span>
01344   oPopDriver &lt;&lt; <span class="stringliteral">"            for(int ii=0, idx=0; ii&lt;NonmemPars::nOmegaBlk; ii++)"</span> &lt;&lt; endl;
01345   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01346   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;omega_out dimension=\" &lt;&lt; \"\\\"\" &lt;&lt; NonmemPars::omegaBlockDims[ii] &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01347   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \" struct=\" &lt;&lt; \"\\\"\";"</span> &lt;&lt; endl;
01348   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::omegaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01349   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"diagonal\";"</span> &lt;&lt; endl;
01350   oPopDriver &lt;&lt; <span class="stringliteral">"               else"</span> &lt;&lt; endl;
01351   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"block\";"</span> &lt;&lt; endl;
01352   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"\\\"\" &lt;&lt; \"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01353   
01354   <span class="comment">/*</span>
01355 <span class="comment">  oPopDriver &lt;&lt; "            for( int i=0; i&lt;NonmemPars::omegaOrder; i++ )" &lt;&lt; endl;</span>
01356 <span class="comment">  oPopDriver &lt;&lt; "            {" &lt;&lt; endl;</span>
01357 <span class="comment">  oPopDriver &lt;&lt; "               oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; omegaOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;" &lt;&lt; endl;</span>
01358 <span class="comment">  oPopDriver &lt;&lt; "            }" &lt;&lt; endl;</span>
01359 <span class="comment">  */</span>
01360 
01361   oPopDriver &lt;&lt; <span class="stringliteral">"               if( NonmemPars::omegaBlockStruct[ii]==DIAGONAL )"</span> &lt;&lt; endl;
01362   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01363   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;NonmemPars::omegaBlockDims[ii]; i++, idx++ )"</span> &lt;&lt; endl;
01364   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01365   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; omegaOut[idx] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01366   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01367   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01368   oPopDriver &lt;&lt; <span class="stringliteral">"               else // full"</span> &lt;&lt; endl;
01369   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01370   oPopDriver &lt;&lt; <span class="stringliteral">"                  int n = NonmemPars::omegaBlockDims[ii];"</span> &lt;&lt; endl;
01371   oPopDriver &lt;&lt; <span class="stringliteral">"                  int m = (n*(n+1))/2;"</span> &lt;&lt; endl;
01372   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; full( n * n );"</span> &lt;&lt; endl;
01373   oPopDriver &lt;&lt; <span class="stringliteral">"                  valarray&lt;double&gt; row_minimal( m );"</span> &lt;&lt; endl;
01374   oPopDriver &lt;&lt; endl;
01375   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int j=0; j&lt;n; j++ )"</span> &lt;&lt; endl;
01376   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01377   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int i=0; i&lt;n-j; i++, idx++ )"</span> &lt;&lt; endl;
01378   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01379   oPopDriver &lt;&lt; <span class="stringliteral">"                        full[j*n+(j+i)] = omegaOut[idx];  "</span> &lt;&lt; endl;
01380   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01381   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01382   oPopDriver &lt;&lt; <span class="stringliteral">"                  symmetrize( full, n, full );"</span> &lt;&lt; endl;
01383   oPopDriver &lt;&lt; endl;
01384   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0, k=0; i&lt;n; i++ )"</span> &lt;&lt; endl;
01385   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01386   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;i+1; j++, k++ )"</span> &lt;&lt; endl;
01387   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01388   oPopDriver &lt;&lt; <span class="stringliteral">"                        row_minimal[k] = full[i*n+j];"</span> &lt;&lt; endl;
01389   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01390   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01391   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;m; i++ )"</span> &lt;&lt; endl;
01392   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01393   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;value&gt;\" &lt;&lt; row_minimal[ i ];"</span> &lt;&lt; endl;
01394   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01395   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01396 
01397   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01398 
01399   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;/omega_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01400   oPopDriver &lt;&lt; <span class="stringliteral">"               //"</span> &lt;&lt; endl;
01401   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01402 
01403   oPopDriver &lt;&lt; <span class="stringliteral">"            ///////////////////////////////////////////////////////////////////"</span> &lt;&lt; endl;
01404   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/pop_opt_result&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01405   oPopDriver &lt;&lt; endl;
01406   
01407   oPopDriver &lt;&lt; <span class="stringliteral">"            if( isStatRequested )"</span> &lt;&lt; endl;
01408   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01409   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;pop_stat_result elapsedtime=\\\"\" &lt;&lt; statTimeSec &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01410   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isCovOut )"</span> &lt;&lt; endl;
01411   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01412   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_covariance_out struct=\\\"block\\\" dimension=\\\"\" &lt;&lt; nAlp &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01413   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01414   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01415   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;=i; j++ )"</span> &lt;&lt; endl;
01416   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01417   oPopDriver &lt;&lt; <span class="stringliteral">"                        oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParCovOut[i+j*nAlp] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01418   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01419   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01420   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_covariance_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01421   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01422   
01423   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isInvCovOut )"</span> &lt;&lt; endl;
01424   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01425   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_inverse_covariance_out struct=\\\"block\\\" dimension=\\\"\" &lt;&lt; nAlp &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01426   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01427   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01428   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;=i; j++ )"</span> &lt;&lt; endl;
01429   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01430   oPopDriver &lt;&lt; <span class="stringliteral">"                        oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParInvCovOut[i+j*nAlp] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01431   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01432   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;
01433   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_inverse_covariance_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01434   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01435   
01436   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isStdErrOut )"</span> &lt;&lt; endl;
01437   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01438   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_stderror_out length=\\\"\" &lt;&lt; nAlp &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01439   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01440   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01441   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParSEOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01442   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;        
01443   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_stderror_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01444   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01445   
01446   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isCorrelationOut )"</span> &lt;&lt; endl;
01447   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01448   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_correlation_out struct=\\\"block\\\" dimension=\\\"\" &lt;&lt; nAlp &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01449   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01450   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01451   oPopDriver &lt;&lt; <span class="stringliteral">"                     for( int j=0; j&lt;=i; j++ )"</span> &lt;&lt; endl;
01452   oPopDriver &lt;&lt; <span class="stringliteral">"                     {"</span> &lt;&lt; endl;
01453   oPopDriver &lt;&lt; <span class="stringliteral">"                        oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParCorrelationOut[i+j*nAlp] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01454   oPopDriver &lt;&lt; <span class="stringliteral">"                     }"</span> &lt;&lt; endl;
01455   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;   
01456   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_correlation_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01457   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01458   
01459   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isCoefficientOut )"</span> &lt;&lt; endl;
01460   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01461   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_coefficient_out length=\\\"\" &lt;&lt; nAlp &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01462   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp; i++ )"</span> &lt;&lt; endl;
01463   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01464   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParCoefficientOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01465   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;        
01466   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_coefficient_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01467   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01468   
01469   oPopDriver &lt;&lt; <span class="stringliteral">"               if( isConfidenceOut )"</span> &lt;&lt; endl;
01470   oPopDriver &lt;&lt; <span class="stringliteral">"               {"</span> &lt;&lt; endl;
01471   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;pop_confidence_out length=\\\"\" &lt;&lt; nAlp*2 &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01472   oPopDriver &lt;&lt; <span class="stringliteral">"                  for( int i=0; i&lt;nAlp*2; i++ )"</span> &lt;&lt; endl;
01473   oPopDriver &lt;&lt; <span class="stringliteral">"                  {"</span> &lt;&lt; endl;
01474   oPopDriver &lt;&lt; <span class="stringliteral">"                     oResults &lt;&lt; \"   &lt;value&gt;\" &lt;&lt; stdParConfidenceOut[i] &lt;&lt; \"&lt;/value&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01475   oPopDriver &lt;&lt; <span class="stringliteral">"                  }"</span> &lt;&lt; endl;    
01476   oPopDriver &lt;&lt; <span class="stringliteral">"                  oResults &lt;&lt; \"&lt;/pop_confidence_out&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01477   oPopDriver &lt;&lt; <span class="stringliteral">"               }"</span> &lt;&lt; endl;
01478   
01479   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; \"&lt;/pop_stat_result&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01480   oPopDriver &lt;&lt; endl;
01481   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01482   
01483   oPopDriver &lt;&lt; <span class="stringliteral">"            oResults &lt;&lt; \"&lt;/pop_analysis_result&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01484   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01485   oPopDriver &lt;&lt; endl;
01486   <span class="comment">// Print out &lt;presentation_data&gt; if this is the last subproblem.</span>
01487   oPopDriver &lt;&lt; <span class="stringliteral">"         if( iSub == nRepeats-1 )"</span> &lt;&lt; endl;
01488   oPopDriver &lt;&lt; <span class="stringliteral">"         {"</span> &lt;&lt; endl;
01489   oPopDriver &lt;&lt; <span class="stringliteral">"            // Use the proper data set here."</span> &lt;&lt; endl;
01490   oPopDriver &lt;&lt; <span class="stringliteral">"            if( !isTwoStageMethod )"</span> &lt;&lt; endl;
01491   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01492   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; set &lt;&lt; endl;"</span> &lt;&lt; endl;
01493   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01494   oPopDriver &lt;&lt; <span class="stringliteral">"            else"</span> &lt;&lt; endl;
01495   oPopDriver &lt;&lt; <span class="stringliteral">"            {"</span> &lt;&lt; endl;
01496   oPopDriver &lt;&lt; <span class="stringliteral">"               oResults &lt;&lt; dataForDisposal &lt;&lt; endl;"</span> &lt;&lt; endl;
01497   oPopDriver &lt;&lt; <span class="stringliteral">"            }"</span> &lt;&lt; endl;
01498   oPopDriver &lt;&lt; <span class="stringliteral">"         }"</span> &lt;&lt; endl;
01499   oPopDriver &lt;&lt; endl;
01500   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults &lt;&lt; \"&lt;/spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01501   oPopDriver &lt;&lt; <span class="stringliteral">"         oResults.close();"</span> &lt;&lt; endl;
01502   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
01503   oPopDriver &lt;&lt; endl;
01504   oPopDriver &lt;&lt; <span class="stringliteral">"END:"</span> &lt;&lt; endl;
01505   oPopDriver &lt;&lt; <span class="stringliteral">"      // The following statement is to trick g++ compiler, which"</span> &lt;&lt; endl;
01506   oPopDriver &lt;&lt; <span class="stringliteral">"      // complains that a label must be followed by a statement."</span> &lt;&lt; endl;
01507   oPopDriver &lt;&lt; <span class="stringliteral">"      int dummy = 0;"</span> &lt;&lt; endl;
01508   oPopDriver &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
01509   oPopDriver &lt;&lt; <span class="stringliteral">"   catch( const SpkException &amp; e )"</span> &lt;&lt; endl;
01510   oPopDriver &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
01511   oPopDriver &lt;&lt; <span class="stringliteral">"      ofstream oResults;"</span> &lt;&lt; endl;
01512   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults.open( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\", ios_base::app );"</span> &lt;&lt; endl;
01513   oPopDriver &lt;&lt; <span class="stringliteral">"      if( !oResults.good() )"</span> &lt;&lt; endl;
01514   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
01515   oPopDriver &lt;&lt; <span class="stringliteral">"         fprintf( stderr, \"Failed to open a file, %s, for writing output.\","</span> &lt;&lt; endl;
01516   oPopDriver &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
01517   oPopDriver &lt;&lt; <span class="stringliteral">"         ret = FILE_ACCESS_FAILURE;"</span> &lt;&lt; endl;
01518   oPopDriver &lt;&lt; <span class="stringliteral">"         cout &lt;&lt; \"exit code = \" &lt;&lt; ret &lt;&lt; endl;"</span> &lt;&lt; endl;
01519   oPopDriver &lt;&lt; <span class="stringliteral">"         return ret;"</span> &lt;&lt; endl;
01520   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
01521   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;?xml version=\\\"1.0\\\"?&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01522   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01523   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;error_list length=\\\"\" &lt;&lt; e.size() &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01524   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; e &lt;&lt; endl;"</span> &lt;&lt; endl;
01525   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;/spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01526   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults.close();"</span> &lt;&lt; endl;
01527   oPopDriver &lt;&lt; <span class="stringliteral">"      ret = UNKNOWN_ERROR;"</span> &lt;&lt; endl;
01528   oPopDriver &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
01529   oPopDriver &lt;&lt; <span class="stringliteral">"   catch( ... )"</span> &lt;&lt; endl;
01530   oPopDriver &lt;&lt; <span class="stringliteral">"   {"</span> &lt;&lt; endl;
01531   oPopDriver &lt;&lt; <span class="stringliteral">"      ofstream oResults;"</span> &lt;&lt; endl;
01532   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults.open( \""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\", ios_base::app );"</span> &lt;&lt; endl;
01533   oPopDriver &lt;&lt; <span class="stringliteral">"      if( !oResults.good() )"</span> &lt;&lt; endl;
01534   oPopDriver &lt;&lt; <span class="stringliteral">"      {"</span> &lt;&lt; endl;
01535   oPopDriver &lt;&lt; <span class="stringliteral">"         fprintf( stderr, \"Failed to open a file, %s, for writing output.\","</span> &lt;&lt; endl;
01536   oPopDriver &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; <a class="code" href="classNonmemTranslator.html#v21">fResult_xml</a> &lt;&lt; <span class="stringliteral">"\" );"</span> &lt;&lt; endl;
01537   oPopDriver &lt;&lt; <span class="stringliteral">"         ret = FILE_ACCESS_FAILURE;"</span> &lt;&lt; endl;
01538   oPopDriver &lt;&lt; <span class="stringliteral">"         cout &lt;&lt; \"exit code = \" &lt;&lt; ret &lt;&lt; endl;"</span> &lt;&lt; endl;
01539   oPopDriver &lt;&lt; <span class="stringliteral">"         return ret;"</span> &lt;&lt; endl;
01540   oPopDriver &lt;&lt; <span class="stringliteral">"      }"</span> &lt;&lt; endl;
01541   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;?xml version=\\\"1.0\\\"?&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01542   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01543   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;error_list length=\\\"\" &lt;&lt; 2 &lt;&lt; \"\\\"&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01544   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"Unexpected exceptions are caught.\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01545   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults &lt;&lt; \"&lt;/spkreport&gt;\" &lt;&lt; endl;"</span> &lt;&lt; endl;
01546   oPopDriver &lt;&lt; <span class="stringliteral">"      oResults.close();"</span> &lt;&lt; endl;
01547   oPopDriver &lt;&lt; <span class="stringliteral">"      ret = UNKNOWN_FAILURE;"</span> &lt;&lt; endl;
01548   oPopDriver &lt;&lt; <span class="stringliteral">"   }"</span> &lt;&lt; endl;
01549   oPopDriver &lt;&lt; endl;
01550   oPopDriver &lt;&lt; <span class="stringliteral">"   cout &lt;&lt; \"exit code: \" &lt;&lt; ret &lt;&lt; endl;"</span> &lt;&lt; endl;
01551   oPopDriver &lt;&lt; <span class="stringliteral">"   return ret;"</span> &lt;&lt; endl;
01552   oPopDriver &lt;&lt; <span class="stringliteral">"}"</span> &lt;&lt; endl;
01553   oPopDriver.close();
01554 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jul 10 16:48:16 2007 for SPK Compiler API Documentation by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
