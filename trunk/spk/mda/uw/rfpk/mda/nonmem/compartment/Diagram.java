/**********************************************************************
From:   Resource Facility for Population Kinetics                    
        Department of Bioengineering Box 352255                      
        University of Washington                                     
        Seattle, WA 98195-2255                                       

This file is part of the System for Population Kinetics (SPK), which
was developed with support from NIH grants RR-12609 and P41-
EB001975. Please cite these grants in any publication for which this
software is used and send a notification to the address given above.

SPK is Copyright (C) 1998-2003, by the University of Washington,
Resource Facility for Population Kinetics, and is made available as
free open source software under the terms of the University of
Washington Free-Fork License as a public service.  A copy of the
License can be found in the COPYING file in the root directory of this
distribution.
**********************************************************************/
package uw.rfpk.mda.nonmem.compartment;

import java.awt.Font;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.geom.Point2D;
import java.awt.Cursor;
import java.awt.BasicStroke;
import java.util.Vector;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;
import uw.rfpk.mda.nonmem.Utility;
import javax.swing.DefaultListModel;

/** This class defines diagram of the compartment model.
 *
 * @author  Jiaji Du
 */
public class Diagram extends javax.swing.JPanel {
    
    /** Creates new form Diagram
     * @param frame DesignTool object.
     */
    public Diagram(DesignTool frame) {
        setBackground(new java.awt.Color(255, 255, 255));
        setBorder(new javax.swing.border.EtchedBorder());
        initComponents();
        area = new Dimension(0, 0);
        this.frame = frame;
        model = new Model(frame.models);
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {//GEN-BEGIN:initComponents
        java.awt.GridBagConstraints gridBagConstraints;

        jPopupMenu1 = new javax.swing.JPopupMenu();
        renameMenuItem = new javax.swing.JMenuItem();
        deleteMenuItem = new javax.swing.JMenuItem();
        attributeMenuItem = new javax.swing.JMenuItem();
        compDialog = new javax.swing.JDialog();
        compNameLabel = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        compOKButton = new javax.swing.JButton();
        compCancelButton = new javax.swing.JButton();
        compHelpButton = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        forceButton = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jCheckBox1 = new javax.swing.JCheckBox();
        jCheckBox2 = new javax.swing.JCheckBox();
        jCheckBox3 = new javax.swing.JCheckBox();
        jCheckBox4 = new javax.swing.JCheckBox();
        paramList = new javax.swing.JList();
        jLabel7 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jScrollPane6 = new javax.swing.JScrollPane();
        compEqTextArea = new javax.swing.JTextArea();
        delayDialog = new javax.swing.JDialog();
        delayNameLabel = new javax.swing.JLabel();
        delayModelTextField = new javax.swing.JTextField();
        jLabel28 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        jPanel9 = new javax.swing.JPanel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        fractionList = new javax.swing.JList();
        nDelayCompsComboBox = new javax.swing.JComboBox();
        delayModelRadioButton = new javax.swing.JRadioButton();
        jLabel4 = new javax.swing.JLabel();
        delayTimeRadioButton = new javax.swing.JRadioButton();
        delayTimeTextField = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        fluxDialog = new javax.swing.JDialog();
        fluxNameLabel = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        fluxEqTextArea = new javax.swing.JTextArea();
        fluxVariableTextField = new javax.swing.JTextField();
        jPanel11 = new javax.swing.JPanel();
        fluxOKButton = new javax.swing.JButton();
        fluxCancelButton = new javax.swing.JButton();
        fluxHelpButton = new javax.swing.JButton();
        fluxValueTextField = new javax.swing.JTextField();
        fluxFixedRadioButton = new javax.swing.JRadioButton();
        fluxMixedRadioButton = new javax.swing.JRadioButton();
        fluxRedefinedRadioButton = new javax.swing.JRadioButton();
        jLabel3 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        fluxModelTextField = new javax.swing.JTextField();
        inputDialog = new javax.swing.JDialog();
        jLabel16 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        jRadioButton1 = new javax.swing.JRadioButton();
        jRadioButton2 = new javax.swing.JRadioButton();
        jRadioButton3 = new javax.swing.JRadioButton();
        jRadioButton4 = new javax.swing.JRadioButton();
        jPanel6 = new javax.swing.JPanel();
        jLabel21 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jLabel23 = new javax.swing.JLabel();
        jTextField5 = new javax.swing.JTextField();
        jLabel24 = new javax.swing.JLabel();
        jTextField6 = new javax.swing.JTextField();
        jLabel25 = new javax.swing.JLabel();
        jTextField7 = new javax.swing.JTextField();
        jLabel26 = new javax.swing.JLabel();
        jTextField8 = new javax.swing.JTextField();
        jPanel7 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton7 = new javax.swing.JButton();
        jLabel27 = new javax.swing.JLabel();
        jTextField9 = new javax.swing.JTextField();
        jSeparator1 = new javax.swing.JSeparator();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jButton8 = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        jButton9 = new javax.swing.JButton();
        jButton10 = new javax.swing.JButton();
        jButton11 = new javax.swing.JButton();
        sampleDialog = new javax.swing.JDialog();
        sampleNameLabel = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        errorModelTextField = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        sampleEqTextArea = new javax.swing.JTextArea();
        jPanel3 = new javax.swing.JPanel();
        sampleOKButton = new javax.swing.JButton();
        sampleCancelButton = new javax.swing.JButton();
        sampleHelpButton = new javax.swing.JButton();
        jRadioButton5 = new javax.swing.JRadioButton();
        dataLabelComboBox = new javax.swing.JComboBox();
        forceDialog = new javax.swing.JDialog();
        compLabel = new javax.swing.JLabel();
        turnOffRadioButton = new javax.swing.JRadioButton();
        associateDataRadioButton = new javax.swing.JRadioButton();
        forceEqRadioButton = new javax.swing.JRadioButton();
        jPanel2 = new javax.swing.JPanel();
        ffOKButton = new javax.swing.JButton();
        ffCancelButton = new javax.swing.JButton();
        ffHelpButton = new javax.swing.JButton();
        forceNameLabel = new javax.swing.JLabel();
        jScrollPane7 = new javax.swing.JScrollPane();
        forceEqTextArea = new javax.swing.JTextArea();
        dataNameComboBox = new javax.swing.JComboBox();
        splitInputDialog = new javax.swing.JDialog();
        jScrollPane5 = new javax.swing.JScrollPane();
        jTextArea5 = new javax.swing.JTextArea();
        jPanel10 = new javax.swing.JPanel();
        jButton12 = new javax.swing.JButton();
        jButton13 = new javax.swing.JButton();
        jButton14 = new javax.swing.JButton();
        paramDialog = new javax.swing.JDialog();
        paramNameLabel = new javax.swing.JLabel();
        paramFixedRadioButton = new javax.swing.JRadioButton();
        paramMixedRadioButton = new javax.swing.JRadioButton();
        paramRedefinedRadioButton = new javax.swing.JRadioButton();
        paramNameLabel2 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        paramEqTextArea = new javax.swing.JTextArea();
        jPanel5 = new javax.swing.JPanel();
        jButton15 = new javax.swing.JButton();
        jButton16 = new javax.swing.JButton();
        jButton17 = new javax.swing.JButton();
        jLabel9 = new javax.swing.JLabel();
        paramVariableTextField = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        paramValueTextField = new javax.swing.JTextField();
        paramNameLabel1 = new javax.swing.JLabel();
        paramModelTextField = new javax.swing.JTextField();
        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        buttonGroup3 = new javax.swing.ButtonGroup();
        buttonGroup4 = new javax.swing.ButtonGroup();
        buttonGroup5 = new javax.swing.ButtonGroup();
        buttonGroup6 = new javax.swing.ButtonGroup();

        renameMenuItem.setText("Rename");
        renameMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                renameMenuItemActionPerformed(evt);
            }
        });

        jPopupMenu1.add(renameMenuItem);

        deleteMenuItem.setText("Delete");
        deleteMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                deleteMenuItemActionPerformed(evt);
            }
        });

        jPopupMenu1.add(deleteMenuItem);

        attributeMenuItem.setText("Attributes");
        attributeMenuItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                attributeMenuItemActionPerformed(evt);
            }
        });

        jPopupMenu1.add(attributeMenuItem);

        compDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        compDialog.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        compDialog.setTitle("Compatment Attributes");
        compDialog.setModal(true);
        compDialog.setResizable(false);
        compNameLabel.setText("Name:  ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 8, 12);
        compDialog.getContentPane().add(compNameLabel, gridBagConstraints);

        compOKButton.setText("OK");
        compOKButton.setPreferredSize(new java.awt.Dimension(75, 25));
        compOKButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                compOKButtonActionPerformed(evt);
            }
        });

        jPanel1.add(compOKButton);

        compCancelButton.setText("Cancel");
        compCancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                compCancelButtonActionPerformed(evt);
            }
        });

        jPanel1.add(compCancelButton);

        compHelpButton.setText("Help");
        compHelpButton.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel1.add(compHelpButton);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 9;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        compDialog.getContentPane().add(jPanel1, gridBagConstraints);

        jLabel1.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel1.setText("Select forcing function:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        compDialog.getContentPane().add(jLabel1, gridBagConstraints);

        forceButton.setText("Forcing Function");
        forceButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                forceButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.insets = new java.awt.Insets(0, 4, 0, 12);
        compDialog.getContentPane().add(forceButton, gridBagConstraints);

        jLabel2.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel2.setText("Select optional compartment specific parameters:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(4, 12, 2, 12);
        compDialog.getContentPane().add(jLabel2, gridBagConstraints);

        jCheckBox1.setText("INITIALOFF");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        compDialog.getContentPane().add(jCheckBox1, gridBagConstraints);

        jCheckBox2.setText("NOOFF");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        compDialog.getContentPane().add(jCheckBox2, gridBagConstraints);

        jCheckBox3.setText("DEFDOSE");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        compDialog.getContentPane().add(jCheckBox3, gridBagConstraints);

        jCheckBox4.setText("DEFOBSERVATION");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        compDialog.getContentPane().add(jCheckBox4, gridBagConstraints);

        paramList.setBackground(new java.awt.Color(235, 235, 235));
        paramList.setModel(new javax.swing.AbstractListModel() {
            String[] strings = { "Scaling (Sn)", "Bioavailability (Fn)", "Infusion Rate (Rn)", "Infusion Duration (Dn)", "Absorption Lag (ALAGn)" };
            public int getSize() { return strings.length; }
            public Object getElementAt(int i) { return strings[i]; }
        });
        paramList.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        paramList.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                paramListMouseClicked(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        compDialog.getContentPane().add(paramList, gridBagConstraints);

        jLabel7.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel7.setText("Select compartment attributes:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 12, 2, 12);
        compDialog.getContentPane().add(jLabel7, gridBagConstraints);

        jLabel12.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel12.setText("Define equations:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(4, 12, 2, 12);
        compDialog.getContentPane().add(jLabel12, gridBagConstraints);

        jScrollPane6.setViewportView(compEqTextArea);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipady = 50;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        compDialog.getContentPane().add(jScrollPane6, gridBagConstraints);

        delayDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        delayNameLabel.setText("Name:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 8, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(delayNameLabel, gridBagConstraints);

        delayModelTextField.setBackground(new java.awt.Color(255, 255, 255));
        delayModelTextField.setEditable(false);
        delayModelTextField.setPreferredSize(new java.awt.Dimension(100, 19));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(1, 0, 0, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(delayModelTextField, gridBagConstraints);

        jLabel28.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel28.setText("Select number of compartments:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(3, 12, 2, 19);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(jLabel28, gridBagConstraints);

        jLabel31.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel31.setText("Equations defining fractional distribution:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(8, 12, 2, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(jLabel31, gridBagConstraints);

        jButton2.setText("OK");
        jButton2.setPreferredSize(new java.awt.Dimension(75, 25));
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jPanel9.add(jButton2);

        jButton3.setText("Cancel");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        jPanel9.add(jButton3);

        jButton4.setText("Help");
        jButton4.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel9.add(jButton4);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(6, 12, 12, 12);
        delayDialog.getContentPane().add(jPanel9, gridBagConstraints);

        fractionList.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        fractionList.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                fractionListMouseClicked(evt);
            }
        });

        jScrollPane4.setViewportView(fractionList);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        delayDialog.getContentPane().add(jScrollPane4, gridBagConstraints);

        nDelayCompsComboBox.setPreferredSize(new java.awt.Dimension(60, 21));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(nDelayCompsComboBox, gridBagConstraints);

        delayModelRadioButton.setText("Specify a mixed effect model for the delay");
        buttonGroup6.add(delayModelRadioButton);
        delayModelRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                delayModelRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(2, 9, 0, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(delayModelRadioButton, gridBagConstraints);

        jLabel4.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel4.setText("TLAG1=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 16, 0, 0);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(jLabel4, gridBagConstraints);

        delayTimeRadioButton.setSelected(true);
        delayTimeRadioButton.setText("The delay time is fixed at:");
        buttonGroup6.add(delayTimeRadioButton);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 0);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(delayTimeRadioButton, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(delayTimeTextField, gridBagConstraints);

        jLabel8.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel8.setText("Select modeling options:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(4, 12, 0, 12);
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        delayDialog.getContentPane().add(jLabel8, gridBagConstraints);

        fluxDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        fluxDialog.setTitle("Transfer Attributes");
        fluxNameLabel.setText("Name:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 6, 12);
        fluxDialog.getContentPane().add(fluxNameLabel, gridBagConstraints);

        jLabel34.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel34.setText("Enter variables to model (separated by space):");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(4, 12, 2, 12);
        fluxDialog.getContentPane().add(jLabel34, gridBagConstraints);

        jScrollPane3.setViewportView(fluxEqTextArea);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipady = 60;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 4, 12);
        fluxDialog.getContentPane().add(jScrollPane3, gridBagConstraints);

        fluxVariableTextField.setPreferredSize(new java.awt.Dimension(100, 19));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 9;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 4, 12);
        fluxDialog.getContentPane().add(fluxVariableTextField, gridBagConstraints);

        fluxOKButton.setText("OK");
        fluxOKButton.setPreferredSize(new java.awt.Dimension(75, 25));
        fluxOKButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                fluxOKButtonActionPerformed(evt);
            }
        });

        jPanel11.add(fluxOKButton);

        fluxCancelButton.setText("Cancel");
        fluxCancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                fluxCancelButtonActionPerformed(evt);
            }
        });

        jPanel11.add(fluxCancelButton);

        fluxHelpButton.setText("Help");
        fluxHelpButton.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel11.add(fluxHelpButton);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(5, 12, 12, 12);
        fluxDialog.getContentPane().add(jPanel11, gridBagConstraints);

        fluxValueTextField.setPreferredSize(new java.awt.Dimension(100, 19));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 12);
        fluxDialog.getContentPane().add(fluxValueTextField, gridBagConstraints);

        fluxFixedRadioButton.setSelected(true);
        fluxFixedRadioButton.setText("Transfer coefficient is fixed at");
        buttonGroup4.add(fluxFixedRadioButton);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 0);
        fluxDialog.getContentPane().add(fluxFixedRadioButton, gridBagConstraints);

        fluxMixedRadioButton.setText("Use mixed effect mode (e.g. THETA(1)+ETA(1))");
        buttonGroup4.add(fluxMixedRadioButton);
        fluxMixedRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                fluxMixedRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 0);
        fluxDialog.getContentPane().add(fluxMixedRadioButton, gridBagConstraints);

        fluxRedefinedRadioButton.setText("Redefine transfer coefficient as: (e.g. CL/V)");
        buttonGroup4.add(fluxRedefinedRadioButton);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 0);
        fluxDialog.getContentPane().add(fluxRedefinedRadioButton, gridBagConstraints);

        jLabel3.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel3.setText("K10=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 4, 0);
        fluxDialog.getContentPane().add(jLabel3, gridBagConstraints);

        jLabel6.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel6.setText("Select a modeling option:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 12, 3, 12);
        fluxDialog.getContentPane().add(jLabel6, gridBagConstraints);

        jLabel5.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel5.setText("K10=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
        fluxDialog.getContentPane().add(jLabel5, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        fluxDialog.getContentPane().add(fluxModelTextField, gridBagConstraints);

        inputDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        inputDialog.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        inputDialog.setTitle("Input Attributes");
        inputDialog.setModal(true);
        inputDialog.setResizable(false);
        jLabel16.setText("Name:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        inputDialog.getContentPane().add(jLabel16, gridBagConstraints);

        jLabel20.setText("Units:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        inputDialog.getContentPane().add(jLabel20, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(12, 0, 12, 12);
        inputDialog.getContentPane().add(jTextField2, gridBagConstraints);

        jPanel4.setLayout(new java.awt.GridLayout(4, 1));

        jPanel4.setBorder(new javax.swing.border.TitledBorder(null, "Input Type", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 10)));
        jRadioButton1.setText("Bolus");
        buttonGroup2.add(jRadioButton1);
        jPanel4.add(jRadioButton1);

        jRadioButton2.setText("Infusion");
        buttonGroup2.add(jRadioButton2);
        jPanel4.add(jRadioButton2);

        jRadioButton3.setText("Primed Infusion");
        buttonGroup2.add(jRadioButton3);
        jPanel4.add(jRadioButton3);

        jRadioButton4.setText("Equation");
        buttonGroup2.add(jRadioButton4);
        jPanel4.add(jRadioButton4);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        inputDialog.getContentPane().add(jPanel4, gridBagConstraints);

        jPanel6.setLayout(new java.awt.GridLayout(6, 2));

        jLabel21.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel21.setText("Amount:");
        jPanel6.add(jLabel21);

        jPanel6.add(jTextField3);

        jLabel22.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel22.setText("Constant Rate:");
        jPanel6.add(jLabel22);

        jPanel6.add(jTextField4);

        jLabel23.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel23.setText("Event Start:");
        jPanel6.add(jLabel23);

        jPanel6.add(jTextField5);

        jLabel24.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel24.setText("Event Stop:");
        jPanel6.add(jLabel24);

        jPanel6.add(jTextField6);

        jLabel25.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel25.setText("Repeat Every:");
        jPanel6.add(jLabel25);

        jPanel6.add(jTextField7);

        jLabel26.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel26.setText("No. of Repeats:");
        jPanel6.add(jLabel26);

        jPanel6.add(jTextField8);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        inputDialog.getContentPane().add(jPanel6, gridBagConstraints);

        jPanel7.setLayout(new java.awt.GridLayout(4, 1));

        jButton1.setText("Save");
        jPanel7.add(jButton1);

        jButton5.setText("Edit");
        jPanel7.add(jButton5);

        jButton6.setText("Add");
        jPanel7.add(jButton6);

        jButton7.setText("Delete");
        jPanel7.add(jButton7);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.insets = new java.awt.Insets(0, 6, 0, 12);
        inputDialog.getContentPane().add(jPanel7, gridBagConstraints);

        jLabel27.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel27.setText("Equation:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(4, 12, 2, 0);
        inputDialog.getContentPane().add(jLabel27, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        inputDialog.getContentPane().add(jTextField9, gridBagConstraints);

        jSeparator1.setOrientation(javax.swing.SwingConstants.VERTICAL);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.VERTICAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 6, 0, 0);
        inputDialog.getContentPane().add(jSeparator1, gridBagConstraints);

        jScrollPane2.setPreferredSize(new java.awt.Dimension(453, 103));
        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable1.setPreferredScrollableViewportSize(new java.awt.Dimension(450, 100));
        jTable1.setPreferredSize(new java.awt.Dimension(300, 100));
        jTable1.setShowHorizontalLines(false);
        jTable1.setShowVerticalLines(false);
        jScrollPane2.setViewportView(jTable1);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(7, 12, 0, 12);
        inputDialog.getContentPane().add(jScrollPane2, gridBagConstraints);

        jButton8.setText("Split Input");
        jButton8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton8ActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        inputDialog.getContentPane().add(jButton8, gridBagConstraints);

        jButton9.setText("OK");
        jButton9.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel8.add(jButton9);

        jButton10.setText("Cancel");
        jPanel8.add(jButton10);

        jButton11.setText("Help");
        jButton11.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel8.add(jButton11);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        inputDialog.getContentPane().add(jPanel8, gridBagConstraints);

        sampleDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        sampleDialog.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        sampleDialog.setTitle("Sample Attributes");
        sampleDialog.setModal(true);
        sampleDialog.setResizable(false);
        sampleNameLabel.setText("Name");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 6, 12);
        sampleDialog.getContentPane().add(sampleNameLabel, gridBagConstraints);

        jLabel18.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel18.setText("Associate it with the data name:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(2, 12, 2, 4);
        sampleDialog.getContentPane().add(jLabel18, gridBagConstraints);

        errorModelTextField.setBackground(new java.awt.Color(255, 255, 255));
        errorModelTextField.setEditable(false);
        errorModelTextField.setPreferredSize(new java.awt.Dimension(100, 19));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(2, 16, 2, 12);
        sampleDialog.getContentPane().add(errorModelTextField, gridBagConstraints);

        jLabel19.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel19.setText("Equations:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(2, 12, 2, 0);
        sampleDialog.getContentPane().add(jLabel19, gridBagConstraints);

        sampleEqTextArea.setPreferredSize(new java.awt.Dimension(260, 100));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(3, 12, 0, 12);
        sampleDialog.getContentPane().add(sampleEqTextArea, gridBagConstraints);

        sampleOKButton.setText("OK");
        sampleOKButton.setPreferredSize(new java.awt.Dimension(75, 25));
        sampleOKButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sampleOKButtonActionPerformed(evt);
            }
        });

        jPanel3.add(sampleOKButton);

        sampleCancelButton.setText("Cancel");
        sampleCancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sampleCancelButtonActionPerformed(evt);
            }
        });

        jPanel3.add(sampleCancelButton);

        sampleHelpButton.setText("Help");
        sampleHelpButton.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel3.add(sampleHelpButton);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        sampleDialog.getContentPane().add(jPanel3, gridBagConstraints);

        jRadioButton5.setText("Set residual unknown variability model");
        jRadioButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton5ActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        sampleDialog.getContentPane().add(jRadioButton5, gridBagConstraints);

        dataLabelComboBox.setPreferredSize(new java.awt.Dimension(80, 21));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        sampleDialog.getContentPane().add(dataLabelComboBox, gridBagConstraints);

        forceDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        forceDialog.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        forceDialog.setTitle("Forcing Function");
        forceDialog.setLocationRelativeTo(this);
        forceDialog.setModal(true);
        forceDialog.setResizable(false);
        compLabel.setText("Name");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 7, 12);
        forceDialog.getContentPane().add(compLabel, gridBagConstraints);

        turnOffRadioButton.setSelected(true);
        turnOffRadioButton.setText("Turned Off");
        buttonGroup1.add(turnOffRadioButton);
        turnOffRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                turnOffRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        forceDialog.getContentPane().add(turnOffRadioButton, gridBagConstraints);

        associateDataRadioButton.setText("Associate with date name:");
        associateDataRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                associateDataRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        forceDialog.getContentPane().add(associateDataRadioButton, gridBagConstraints);

        forceEqRadioButton.setText("Equation for the forcing function:");
        buttonGroup1.add(forceEqRadioButton);
        forceEqRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                forceEqRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 2, 12);
        forceDialog.getContentPane().add(forceEqRadioButton, gridBagConstraints);

        ffOKButton.setText("OK");
        ffOKButton.setPreferredSize(new java.awt.Dimension(75, 25));
        ffOKButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ffOKButtonActionPerformed(evt);
            }
        });

        jPanel2.add(ffOKButton);

        ffCancelButton.setText("Cancel");
        ffCancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ffCancelButtonActionPerformed(evt);
            }
        });

        jPanel2.add(ffCancelButton);

        ffHelpButton.setText("Help");
        ffHelpButton.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel2.add(ffHelpButton);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        forceDialog.getContentPane().add(jPanel2, gridBagConstraints);

        forceNameLabel.setText("FF1=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 18, 0, 2);
        forceDialog.getContentPane().add(forceNameLabel, gridBagConstraints);

        forceEqTextArea.setRows(4);
        jScrollPane7.setViewportView(forceEqTextArea);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        forceDialog.getContentPane().add(jScrollPane7, gridBagConstraints);

        dataNameComboBox.setPreferredSize(new java.awt.Dimension(80, 21));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        forceDialog.getContentPane().add(dataNameComboBox, gridBagConstraints);

        splitInputDialog.setTitle("Split Input");
        splitInputDialog.setLocationRelativeTo(this);
        jScrollPane5.setViewportView(jTextArea5);

        splitInputDialog.getContentPane().add(jScrollPane5, java.awt.BorderLayout.CENTER);

        jButton12.setText("OK");
        jButton12.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel10.add(jButton12);

        jButton13.setText("Cancel");
        jPanel10.add(jButton13);

        jButton14.setText("Help");
        jButton14.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel10.add(jButton14);

        splitInputDialog.getContentPane().add(jPanel10, java.awt.BorderLayout.SOUTH);

        paramDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        paramDialog.setTitle("Parameter Dialog");
        paramDialog.setModal(true);
        paramNameLabel.setText("Name:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 6, 12);
        paramDialog.getContentPane().add(paramNameLabel, gridBagConstraints);

        paramFixedRadioButton.setText("The parameter is fixed at");
        buttonGroup5.add(paramFixedRadioButton);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 0);
        paramDialog.getContentPane().add(paramFixedRadioButton, gridBagConstraints);

        paramMixedRadioButton.setText("Use mixed effect model (e.g. THETA(1)+ETA(1))");
        buttonGroup5.add(paramMixedRadioButton);
        paramMixedRadioButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                paramMixedRadioButtonActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 12);
        paramDialog.getContentPane().add(paramMixedRadioButton, gridBagConstraints);

        paramRedefinedRadioButton.setText("Redefine the parameter as: (e.g. CL/V)");
        buttonGroup5.add(paramRedefinedRadioButton);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 9, 0, 12);
        paramDialog.getContentPane().add(paramRedefinedRadioButton, gridBagConstraints);

        paramNameLabel2.setFont(new java.awt.Font("Dialog", 0, 12));
        paramNameLabel2.setText("S1=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 20, 0, 0);
        paramDialog.getContentPane().add(paramNameLabel2, gridBagConstraints);

        jScrollPane1.setViewportView(paramEqTextArea);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipady = 60;
        gridBagConstraints.insets = new java.awt.Insets(1, 0, 0, 12);
        paramDialog.getContentPane().add(jScrollPane1, gridBagConstraints);

        jButton15.setText("OK");
        jButton15.setPreferredSize(new java.awt.Dimension(75, 25));
        jButton15.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton15ActionPerformed(evt);
            }
        });

        jPanel5.add(jButton15);

        jButton16.setText("Cancel");
        jButton16.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton16ActionPerformed(evt);
            }
        });

        jPanel5.add(jButton16);

        jButton17.setText("Help");
        jButton17.setPreferredSize(new java.awt.Dimension(75, 25));
        jPanel5.add(jButton17);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.insets = new java.awt.Insets(12, 12, 12, 12);
        paramDialog.getContentPane().add(jPanel5, gridBagConstraints);

        jLabel9.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel9.setText("Enter variables to model (separated by space):");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(6, 14, 2, 14);
        paramDialog.getContentPane().add(jLabel9, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 9;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 12);
        paramDialog.getContentPane().add(paramVariableTextField, gridBagConstraints);

        jLabel11.setFont(new java.awt.Font("Dialog", 0, 12));
        jLabel11.setText("Select a modeling option:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 3, 12);
        paramDialog.getContentPane().add(jLabel11, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        paramDialog.getContentPane().add(paramValueTextField, gridBagConstraints);

        paramNameLabel1.setFont(new java.awt.Font("Dialog", 0, 12));
        paramNameLabel1.setText("S1=");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
        paramDialog.getContentPane().add(paramNameLabel1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 12);
        paramDialog.getContentPane().add(paramModelTextField, gridBagConstraints);

        setLayout(new java.awt.BorderLayout());

        setToolTipText("");
        addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                formMouseClicked(evt);
            }
            public void mousePressed(java.awt.event.MouseEvent evt) {
                formMousePressed(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                formMouseReleased(evt);
            }
        });
        addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
            public void mouseDragged(java.awt.event.MouseEvent evt) {
                formMouseDragged(evt);
            }
        });

    }//GEN-END:initComponents

    private void fractionListMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_fractionListMouseClicked
        Element.Delay delay = (Element.Delay)model.selectedElement;
        String fraction = JOptionPane.showInputDialog(fractionList, "Enter fraction.");
        int index = fractionList.getSelectedIndex();
        listModel.setElementAt("Compartment " + ((Element.Compartment)delay.compartments.get(index)).number + 
                               ": " + fraction, index);
    }//GEN-LAST:event_fractionListMouseClicked

    private void delayModelRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_delayModelRadioButtonActionPerformed
        Element.Delay delay = (Element.Delay)model.selectedElement;
        String[] model = new String[1];
        model[0] = delayTimeTextField.getText();
        ModelDialog modelDialog = new ModelDialog(new JFrame(), model, delay.name);
        delayModelTextField.setText(model[0]);
    }//GEN-LAST:event_delayModelRadioButtonActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        delayDialog.setVisible(false);
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        Element.Delay delay = (Element.Delay)model.selectedElement;
        if(delayTimeRadioButton.isSelected())
            if(Utility.isPosIntNumber(delayTimeTextField.getText()))
                delay.delayTime = delayTimeTextField.getText();
            else
            {
                JOptionPane.showMessageDialog(null, "Delay time must be a positive integer.",
                                              "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
        else
            delay.delayModel = delayModelTextField.getText();
        delay.nDelayComps = nDelayCompsComboBox.getSelectedIndex() + 2;
        for(int i = 0; i < listModel.size(); i++)
            delay.fractions.setElementAt(((String)listModel.get(i)).split(": ")[1], i);
        delayDialog.setVisible(false);
    }//GEN-LAST:event_jButton2ActionPerformed

    private void sampleCancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sampleCancelButtonActionPerformed
        sampleDialog.setVisible(false);
    }//GEN-LAST:event_sampleCancelButtonActionPerformed

    private void sampleOKButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sampleOKButtonActionPerformed
        Element.Sample sample = (Element.Sample)model.selectedElement;
        sample.associatedDataName = (String)dataLabelComboBox.getSelectedItem();
        sample.errorModel = errorModelTextField.getText();
        sample.equations = sampleEqTextArea.getText();
        sampleDialog.setVisible(false);
        if(frame.isModelApplied)
            frame.clickFinishButton();
        repaint();
    }//GEN-LAST:event_sampleOKButtonActionPerformed

    private void jRadioButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton5ActionPerformed
        Element.Sample sample = (Element.Sample)model.selectedElement;
        String[] model = new String[1];
        model[0] = errorModelTextField.getText();
        ErrorDialog errorDialog = new ErrorDialog(new JFrame(), model, sample.name);
        errorModelTextField.setText(model[0]);
    }//GEN-LAST:event_jRadioButton5ActionPerformed

    private void fluxMixedRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_fluxMixedRadioButtonActionPerformed
        Element.Flux flux = (Element.Flux)model.selectedElement;
        String[] model = new String[1];
        model[0] = fluxModelTextField.getText();
        ModelDialog modelDialog = new ModelDialog(new JFrame(), model, flux.name);
        fluxModelTextField.setText(model[0]);
    }//GEN-LAST:event_fluxMixedRadioButtonActionPerformed

    private void paramMixedRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_paramMixedRadioButtonActionPerformed
        Element.Compartment comp = (Element.Compartment)model.selectedElement;
        String param = "";
        if(paramList.getSelectedIndex() == 0) param = "Sn";
        if(paramList.getSelectedIndex() == 1) param = "Fn";
        if(paramList.getSelectedIndex() == 2) param = "Rn";
        if(paramList.getSelectedIndex() == 3) param = "Dn";
        if(paramList.getSelectedIndex() == 4) param = "ALAGn";
        String[] model = new String[1];
        model[0] = paramModelTextField.getText();
        ModelDialog modelDialog = new ModelDialog(new JFrame(), model, param);
        paramModelTextField.setText(model[0]);
    }//GEN-LAST:event_paramMixedRadioButtonActionPerformed

    private void jButton16ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton16ActionPerformed
        paramDialog.setVisible(false);
    }//GEN-LAST:event_jButton16ActionPerformed

    private void jButton15ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton15ActionPerformed
        Element.Compartment comp = (Element.Compartment)model.selectedElement;
        String param = "";
        if(paramList.getSelectedIndex() == 0) param = "Sn";
        if(paramList.getSelectedIndex() == 1) param = "Fn";
        if(paramList.getSelectedIndex() == 2) param = "Rn";
        if(paramList.getSelectedIndex() == 3) param = "Dn";
        if(paramList.getSelectedIndex() == 4) param = "ALAGn";
        String[] newList = paramVariableTextField.getText().trim().split(" ");
        if(!updateVariableList(newList, comp.variables))
            return;
        if(paramFixedRadioButton.isSelected())
            comp.parameters.setProperty(param, "1" + paramValueTextField.getText());           
        else if(paramMixedRadioButton.isSelected())
            comp.parameters.setProperty(param, "2" + paramModelTextField.getText());          
        else if(paramRedefinedRadioButton.isSelected())
            comp.parameters.setProperty(param, "3" + paramEqTextArea.getText());
        else
        {
            JOptionPane.showMessageDialog(null, "Parameter option was not selected.",
                                          "Input Error", JOptionPane.ERROR_MESSAGE);
            return;
        }
        frame.variableDialog.setVariableList();
        if(frame.isModelApplied)
            frame.clickFinishButton();
        paramDialog.setVisible(false);
    }//GEN-LAST:event_jButton15ActionPerformed

    private void paramListMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_paramListMouseClicked
        Element.Compartment comp = (Element.Compartment)model.selectedElement;
        String param = "";
        if(paramList.getSelectedIndex() == 0) param = "Sn";
        if(paramList.getSelectedIndex() == 1) param = "Fn";
        if(paramList.getSelectedIndex() == 2) param = "Rn";
        if(paramList.getSelectedIndex() == 3) param = "Dn";
        if(paramList.getSelectedIndex() == 4) param = "ALAGn";
        paramNameLabel.setText("Name: " + param);
        paramNameLabel1.setText(param + "=");
        paramNameLabel2.setText(param + "=");
        if(comp.parameters.containsKey(param))
        {
            if(comp.parameters.getProperty(param).startsWith("1"))
            {
                paramFixedRadioButton.doClick();
                paramValueTextField.setText(comp.parameters.getProperty(param).substring(1));
            }
            if(comp.parameters.getProperty(param).startsWith("2"))
            {
                paramMixedRadioButton.setSelected(true);
                paramModelTextField.setText(comp.parameters.getProperty(param).substring(1));
            }
            if(comp.parameters.getProperty(param).startsWith("3"))
            {
                paramRedefinedRadioButton.doClick();
                paramEqTextArea.setText(comp.parameters.getProperty(param).substring(1));
            }
        }
        paramDialog.setSize(350, 350);
        paramDialog.setVisible(true);
    }//GEN-LAST:event_paramListMouseClicked

    private void associateDataRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_associateDataRadioButtonActionPerformed
        forceEqTextArea.setEnabled(false);
        dataNameComboBox.setEnabled(true);
    }//GEN-LAST:event_associateDataRadioButtonActionPerformed

    private boolean updateVariableList(String[] newList, String[] oldList)
    {
        // Find removed variables and remove them from Model.variables
        Vector changedList = removedItem(oldList, newList);
        for(int i = 0; i < changedList.size(); i++)
            Model.variables.remove((String)changedList.get(i));
        
        // Find added variables
        changedList = removedItem(newList, oldList);
        for(int i = 0; i < changedList.size(); i++)
        {
            if(!Model.variables.containsKey((String)changedList.get(i)))
            {
                String item = (String)changedList.get(i);
                Model.variables.setProperty(item, "");
            }
            else
            {
                JOptionPane.showMessageDialog(null, "The variable '" +  (String)changedList.get(i) + 
                                              "' has already been defined in another place.",
                                              "Input Error", JOptionPane.ERROR_MESSAGE);
                return false;
            }
        }
        return true;
    }
    
    private void fluxOKButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_fluxOKButtonActionPerformed
        Element.Flux flux = (Element.Flux)model.selectedElement;
        String[] newList = fluxVariableTextField.getText().trim().split(" ");
        if(!updateVariableList(newList, flux.variables))
            return;
        if(fluxRedefinedRadioButton.isSelected())
        {
            flux.flowRate = null;
            flux.mixedEffect = null;
            flux.equations = "\n" + flux.name + "=" + fluxEqTextArea.getText();
        }
        else if(fluxMixedRadioButton.isSelected())
        {
            flux.flowRate = null;
            flux.mixedEffect = fluxModelTextField.getText();
            flux.equations = null;
        }
        else
        {
            flux.flowRate = fluxValueTextField.getText();
            flux.mixedEffect = null;
            flux.equations = null;
        }
        frame.variableDialog.setVariableList();
        if(frame.isModelApplied)
            frame.clickFinishButton();
        fluxDialog.setVisible(false);
    }//GEN-LAST:event_fluxOKButtonActionPerformed

    private void fluxCancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_fluxCancelButtonActionPerformed
        fluxDialog.setVisible(false);
    }//GEN-LAST:event_fluxCancelButtonActionPerformed

    private void jButton8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton8ActionPerformed
        splitInputDialog.setSize(320, 300);
        splitInputDialog.setVisible(true);
    }//GEN-LAST:event_jButton8ActionPerformed

    private void ffCancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ffCancelButtonActionPerformed
        forceDialog.setVisible(false);
    }//GEN-LAST:event_ffCancelButtonActionPerformed

    private void ffOKButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ffOKButtonActionPerformed
        isForcingFunctionOK = true;
        forceDialog.setVisible(false);
    }//GEN-LAST:event_ffOKButtonActionPerformed

    private void compCancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_compCancelButtonActionPerformed
        compDialog.setVisible(false);
    }//GEN-LAST:event_compCancelButtonActionPerformed

    private void forceEqRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_forceEqRadioButtonActionPerformed
        forceEqTextArea.setEnabled(true);
        dataNameComboBox.setEnabled(false);
    }//GEN-LAST:event_forceEqRadioButtonActionPerformed

    private void turnOffRadioButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_turnOffRadioButtonActionPerformed
        forceEqTextArea.setEnabled(false);
        dataNameComboBox.setEnabled(false);
    }//GEN-LAST:event_turnOffRadioButtonActionPerformed

    private void forceButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_forceButtonActionPerformed
        String[] dataLabels = frame.object.getDataLabels();
        for(int i = 0; i < dataLabels.length; i++)
            dataNameComboBox.addItem(dataLabels[i]);
        compLabel.setText("Name:  " + model.selectedElement.name);
        forceNameLabel.setText("FF" + model.selectedElement.number + "=");
        isForcingFunctionOK = false;
        forceDialog.setSize(310, 255);
        forceDialog.setVisible(true);
    }//GEN-LAST:event_forceButtonActionPerformed

    private void compOKButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_compOKButtonActionPerformed
        Element.Compartment comp = (Element.Compartment)model.selectedElement;
        comp.attributes.clear();
        if(jCheckBox1.isSelected()) comp.attributes.add(jCheckBox1.getText());
        if(jCheckBox2.isSelected()) comp.attributes.add(jCheckBox2.getText());
        if(jCheckBox3.isSelected()) comp.attributes.add(jCheckBox3.getText());
        if(jCheckBox4.isSelected()) comp.attributes.add(jCheckBox4.getText());
        if(isForcingFunctionOK)
        {
            if(turnOffRadioButton.isSelected())
                comp.force = null;
            else if(associateDataRadioButton.isSelected())
                comp.force = forceNameLabel.getText() + (String)dataNameComboBox.getSelectedItem();
            else if(forceEqRadioButton.isSelected())
                comp.force = forceNameLabel.getText() + forceEqTextArea.getText();
            else
            {
                JOptionPane.showMessageDialog(null, "Forcing function option was not selected.",
                                              "Input Error", JOptionPane.ERROR_MESSAGE);
                return;
            }
        }
        comp.equations = compEqTextArea.getText();
        
            
        if(frame.isModelApplied)
            frame.clickFinishButton();;
        compDialog.setVisible(false);
    }//GEN-LAST:event_compOKButtonActionPerformed

    private void attributeMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_attributeMenuItemActionPerformed
        if(model.selectedElement == null) return;
        if(model.selectedElement instanceof Element.Compartment)
        {
            Element.Compartment comp = (Element.Compartment)model.selectedElement;
            compNameLabel.setText("Name:  " + comp.name);
            if(comp.attributes.indexOf("INITIALOFF") != -1) jCheckBox1.setSelected(true);
            if(comp.attributes.indexOf("NOOFF") != -1) jCheckBox2.setSelected(true);
            if(comp.attributes.indexOf("DEFDOSE") != -1) jCheckBox3.setSelected(true);
            if(comp.attributes.indexOf("DEFOBSERVATION") != -1) jCheckBox4.setSelected(true);
            if(comp.nInputs == 0) 
            {
                jCheckBox3.setSelected(false);
                jCheckBox3.setEnabled(false);
            }
            else
                jCheckBox3.setEnabled(true);
            if(comp.nSamples == 0) 
            {
                jCheckBox4.setSelected(false);
                jCheckBox4.setEnabled(false);
            }
            else
                jCheckBox4.setEnabled(true);
            if(comp.equations != null) compEqTextArea.setText(comp.equations);
            compDialog.setSize(332, 400);
            compDialog.setLocation(x + 200, y + 100);
            compDialog.setVisible(true);
        }
        if(model.selectedElement instanceof Element.Delay)
        {
            Element.Delay delay = (Element.Delay)model.selectedElement;
            for(int i = 2; i <= 50; i++)
                nDelayCompsComboBox.addItem(String.valueOf(i));
            delayNameLabel.setText("Name: " + delay.name);
            nDelayCompsComboBox.setSelectedIndex(delay.nDelayComps - 2);
            if(delay.delayModel != null)
            {
                delayModelTextField.setText(delay.delayModel);
                delayModelRadioButton.setSelected(true);
            }
            if(delay.delayTime != null)
            {
                delayTimeTextField.setText(delay.delayTime);
                delayTimeRadioButton.setSelected(true);
            }
            fractionList.setModel(listModel);
            listModel.clear();
            for(int i = 0; i < delay.fractions.size(); i++)
            {
                int number = ((Element.Compartment)delay.compartments.get(i)).number;
                listModel.addElement("Compartment " + number + ": " + (String)delay.fractions.get(i));
            }
            delayDialog.setSize(356, 390);
            delayDialog.setLocation(x + 200, y + 100);
            delayDialog.setVisible(true);
        }
        if(model.selectedElement instanceof Element.Flux && 
           ((Element.Flux)model.selectedElement).element1 != null)
        {
            Element.Flux flux = (Element.Flux)model.selectedElement;
            fluxNameLabel.setText("Name:  " + flux.name);
            fluxValueTextField.setText("");
            fluxEqTextArea.setText("");
            fluxModelTextField.setText("");
            if(flux.flowRate != null)
                fluxValueTextField.setText(flux.flowRate);
            if(flux.equations != null)
                fluxEqTextArea.setText(flux.equations);
            if(flux.mixedEffect != null)
                fluxModelTextField.setText(flux.mixedEffect);
            String variables = "";
            for(int i = 0; i < flux.variables.length; i++)
                variables += flux.variables[i] + " ";
            fluxVariableTextField.setText(variables.trim());
            jLabel3.setText(model.selectedElement.name + "=");
            jLabel5.setText(model.selectedElement.name + "=");
            fluxDialog.setSize(360, 360);
            fluxDialog.setLocation(x + 200, y + 100);
            fluxDialog.setVisible(true);
        }
        if(model.selectedElement instanceof Element.Input)
        {
            inputDialog.setSize(500, 400);
            inputDialog.setLocation(x + 200, y + 100);
            inputDialog.setVisible(true);
        }
        if(model.selectedElement instanceof Element.Sample)
        {
            Element.Sample sample = (Element.Sample)model.selectedElement;
            String[] dataLabels = frame.object.getDataLabels();
            for(int i = 0; i < dataLabels.length; i++)
                dataLabelComboBox.addItem(dataLabels[i]);
            if(sample.associatedDataName != null)
                dataLabelComboBox.setSelectedItem(sample.associatedDataName);
            String text = sample.name + " =";
            for(int i = 0; i < sample.compartments.size(); i++)
            {
                if(i != 0) text += " + ";
                else text += " ";
                text += " " + ((Element)sample.compartments.get(i)).name;
            }
            sampleNameLabel.setText("Name: " + sample.name);
            errorModelTextField.setText(sample.errorModel);
            sampleEqTextArea.setText(text);
            sampleDialog.setSize(320, 320);
            sampleDialog.setLocation(x + 200, y + 100);
            sampleDialog.setVisible(true);
        }
    }//GEN-LAST:event_attributeMenuItemActionPerformed

    private void renameMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_renameMenuItemActionPerformed
        if(model.selectedElement == null) return;
        String name = JOptionPane.showInputDialog(null, "Enter new name.", model.selectedElement.name);
        if(name != null && !name.trim().equals(""))
        {
            model.selectedElement.name = name;
            if(frame.isModelApplied)
                frame.clickFinishButton();
            repaint();
        }
    }//GEN-LAST:event_renameMenuItemActionPerformed

    private void deleteMenuItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_deleteMenuItemActionPerformed
        if(model.selectedElement == null) return;
        model.remove(model.selectedElement);
        if(frame.isModelApplied)
            frame.clickFinishButton();
        repaint();
    }//GEN-LAST:event_deleteMenuItemActionPerformed

    private void formMouseDragged(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseDragged
        if(tempElement != null && (evt.getModifiers() & evt.BUTTON1_MASK) != 0 && start != null)
        {            
            last = evt.getPoint();
            last.setLocation(last.getX() / frame.scale, last.getY() / frame.scale);           
            tempElement.xCenter += (last.getX() - start.getX());
            tempElement.yCenter += (last.getY() - start.getY());
            start = last;
            repaint();
        }        
    }//GEN-LAST:event_formMouseDragged

    private void formMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMousePressed
        if(!frame.pickedElement.equals("")) return;
        start = evt.getPoint();
        start.setLocation(start.getX() / frame.scale, start.getY() / frame.scale);        
        x = (int)start.getX();
        y = (int)start.getY();

        if(evt.isPopupTrigger() && model.selectedElement != null)
        {
            jPopupMenu1.show(evt.getComponent(), evt.getX(), evt.getY());
            if(model.selectedElement instanceof Element.Flux &&
               ((Element.Flux)model.selectedElement).element1 instanceof Element.Delay)
                attributeMenuItem.setEnabled(false);
            else
                attributeMenuItem.setEnabled(true);
            if(model.selectedElement instanceof Element.Flux)
                renameMenuItem.setEnabled(false);
            else
                renameMenuItem.setEnabled(true);
        }
        if((evt.getModifiers() & evt.BUTTON1_MASK) != 0)
            gc2D.setXORMode(Color.white);
      
        for(int i = 0; i < Model.elements.size(); i++)
        {
            if(((Element)Model.elements.get(i)).contains(x, y))
            {
                model.selectedElement = (Element)Model.elements.get(i);
                if(!evt.isPopupTrigger())
                    tempElement = (Element)model.selectedElement.clone();
                else
                    tempElement = null;
                return;
            }
        }
        for(int i = 0; i < Model.fluxes.size(); i++)
        {
            if(((Element)Model.fluxes.get(i)).contains(x, y))
            {
                model.selectedElement = (Element)Model.fluxes.get(i);
                return;
            }
        }
        for(int i = 0; i < model.inputs.size(); i++)
        {
            if(((Element)model.inputs.get(i)).contains(x, y))
            {
                model.selectedElement = (Element)model.inputs.get(i);
                if(!evt.isPopupTrigger())
                    tempElement = (Element)model.selectedElement.clone();
                else
                    tempElement = null;
                return;
            }
        }
        for(int i = 0; i < model.samples.size(); i++)
        {
            if(((Element)model.samples.get(i)).contains(x, y))
            {
                model.selectedElement = (Element)model.samples.get(i);
                if(!evt.isPopupTrigger())
                    tempElement = (Element)model.selectedElement.clone();
                else
                    tempElement = null;
                return;
            }
        }
        model.selectedElement = null;
    }//GEN-LAST:event_formMousePressed

    private void formMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseReleased
        if(tempElement != null && (evt.getModifiers() & evt.BUTTON1_MASK) != 0 && start != null && last != null)
        {
            last = null;
            gc2D.setPaintMode();
            isMouseDragged = false;
            model.selectedElement.xCenter = tempElement.xCenter;
            model.selectedElement.yCenter = tempElement.yCenter;
            tempElement = null;
            repaint();
        }
        if (evt.isPopupTrigger()) 
            jPopupMenu1.show(evt.getComponent(), evt.getX(), evt.getY());
        final int W = 50;
        final int H = 50;
        boolean changed = false;
        if (SwingUtilities.isRightMouseButton(evt)) 
        {

        } 
        else 
        {
            int x = evt.getX() - W/2;
            int y = evt.getY() - H/2;
            if (x < 0) x = 0;
            if (y < 0) y = 0;
            Rectangle rect = new Rectangle(x, y, W, H);
            scrollRectToVisible(rect);

            int this_width = (x + W + 2);
            if (this_width > area.width) {
                area.width = this_width; changed=true;
            }

            int this_height = (y + H + 2);
            if (this_height > area.height) {
                area.height = this_height; changed=true;
            }
        }
        if (changed) {
            //Update client's preferred size because
            //the area taken up by the graphics has
            //gotten larger or smaller (if cleared).
            setPreferredSize(area);

            //Let the scroll pane know to update itself
            //and its scrollbars.
            revalidate();
        }
        repaint();
    }//GEN-LAST:event_formMouseReleased

    private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
        x = (int)(evt.getX() / frame.scale);
        y = (int)(evt.getY() / frame.scale);
        if(frame.pickedElement.equals("compartment"))
        {
            Element.Compartment compartment = new Element.Compartment(x, y, model);
            Model.elements.add(compartment);                
            frame.enableClearButton();
            frame.enableAddButton();
            frame.pickedElement = "";
            repaint();
        }
        else if(frame.pickedElement.equals("delay"))
        {
            if(model.nElement == 9)
            {
                JOptionPane.showMessageDialog(null, "The total number of Compartments and Delays must be <= 9.",
                                              "Input Error", JOptionPane.ERROR_MESSAGE);
                frame.pickedElement = "";
                setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                return;
            }
            Element.Delay delay = new Element.Delay(x, y, model);
            model.elements.add(delay);                
            frame.enableClearButton();
            frame.enableAddButton();            
            frame.pickedElement = "";
            repaint();
        }
        else if(frame.pickedElement.equals("flux"))
        {
            
            
/*            
            if(startElement == null)
            {
                startElement = getSelectedElement();
                if(startElement == null)
                {
                    frame.pickedElement = "";
                    setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                }
                return;   
            }
*/
            
            if(startElement == null && !isBackgroundClicked)
            {
                startElement = getSelectedElement();
                if(startElement == null)
                    isBackgroundClicked = true;
                return;   
            }
            else if(startElement == null && isBackgroundClicked)
            {
                endElement = getSelectedElement();
                isBackgroundClicked = false;
                frame.pickedElement = "";
                setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                if(endElement != null)
                    addFlux();
                return;   
            }
            else
            {
                endElement = getSelectedElement();
                if(startElement instanceof Element.Delay)
                {
                    if(endElement instanceof Element.Delay && startElement != endElement)
                    {
                        JOptionPane.showMessageDialog(null, "A flux from a Delay to another Delay is not allowed.",
                                                      "Input Error", JOptionPane.ERROR_MESSAGE);
                        startElement = null;
                        frame.pickedElement = "";
                        setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                        return;
                    }
                    if(endElement == null)
                    {
                        addFlux();
                        startElement = null;
                        frame.pickedElement = "";
                        setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                        return;
                    }
                }
                if(startElement instanceof Element.Compartment && startElement == endElement)
                {
                    startElement = null;
                    endElement = null;
                    frame.pickedElement = "";
                    setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                    return;                    
                }
            }
            if(startElement != null && endElement != startElement)
                addFlux();
            frame.pickedElement = "";
        }
        else if(frame.pickedElement.equals("input"))
        {
            Element element = getSelectedElement();
            if(element instanceof Element.Compartment)
            {
                inputElement.add(element);
                return;
            }
            else
            {
                // Limit one input on each compartment
/*                if(inputElement.size() == 1)
                {
                    for(int i = 0; i < model.inputs.size(); i++)
                    {
                        Vector compartments = ((Element.Input)model.inputs.get(i)).compartments;
                        if(compartments.size() == 1 && compartments.get(0) == inputElement.get(0))
                        {
                            frame.pickedElement = "";
                            inputElement = new Vector();
                            setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                            return;
                        }
                    }
                }*/
                if(inputElement.size() > 0)
                {
                    Element.Input input = new Element.Input(inputElement, x, y, model);
                    inputElement = new Vector();
                    model.inputs.add(input);
                    for(int i = 0; i < input.compartments.size(); i++)
                        ((Element.Compartment)input.compartments.get(i)).nInputs++;
                    repaint();
                }
            }
            frame.pickedElement = "";
        }
        else if(frame.pickedElement.equals("sample"))
        {
            Element element = getSelectedElement();
            if(element instanceof Element.Compartment)
            {
                inputElement.add(element);
                return;
            }
            else
            {
                // Limit one sample on each compartment
                if(inputElement.size() == 1)
                {
                    for(int i = 0; i < model.samples.size(); i++)
                    {
                        Vector compartments = ((Element.Sample)model.samples.get(i)).compartments;
                        if(compartments.size() == 1 && compartments.get(0) == inputElement.get(0))
                        {
                            frame.pickedElement = "";
                            inputElement = new Vector();
                            setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
                            return;
                        }
                    }
                }
                if(inputElement.size() > 0)
                {
                    Element.Sample sample = new Element.Sample(inputElement, x, y, model);
                    inputElement = new Vector();
                    model.samples.add(sample);
                    for(int i = 0; i < sample.compartments.size(); i++)
                        ((Element.Compartment)sample.compartments.get(i)).nSamples++;
                    repaint();
                }                              
            }
            frame.pickedElement = "";
        }
        if(frame.isModelApplied)
            frame.clickFinishButton();
        setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
    }//GEN-LAST:event_formMouseClicked
    
    private Element getSelectedElement()
    {
        for(int i = 0; i < model.elements.size(); i++)
        {
            Element element = (Element)model.elements.get(i);
            if(element.contains(x, y))
                return element;
        }
        return null;
    }
    
    private void addFlux()
    {
        boolean isExist = false;
        for(int i = 0; i < model.fluxes.size(); i++)
        {
            Element.Flux flux = (Element.Flux)model.fluxes.get(i);
            if(flux.element1 == startElement && flux.element2 == endElement)
            {
                isExist = true;
                break;
            }
        }
        if(!isExist)
        {
            Element.Flux flux = new Element.Flux(startElement, endElement, model);
            model.fluxes.add(flux);               
            startElement = null;
            endElement = null;
            repaint();
        }    
    }
        
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JRadioButton associateDataRadioButton;
    private javax.swing.JMenuItem attributeMenuItem;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.ButtonGroup buttonGroup3;
    private javax.swing.ButtonGroup buttonGroup4;
    private javax.swing.ButtonGroup buttonGroup5;
    private javax.swing.ButtonGroup buttonGroup6;
    private javax.swing.JButton compCancelButton;
    private javax.swing.JDialog compDialog;
    private javax.swing.JTextArea compEqTextArea;
    private javax.swing.JButton compHelpButton;
    private javax.swing.JLabel compLabel;
    private javax.swing.JLabel compNameLabel;
    private javax.swing.JButton compOKButton;
    private javax.swing.JComboBox dataLabelComboBox;
    private javax.swing.JComboBox dataNameComboBox;
    private javax.swing.JDialog delayDialog;
    private javax.swing.JRadioButton delayModelRadioButton;
    private javax.swing.JTextField delayModelTextField;
    private javax.swing.JLabel delayNameLabel;
    private javax.swing.JRadioButton delayTimeRadioButton;
    private javax.swing.JTextField delayTimeTextField;
    private javax.swing.JMenuItem deleteMenuItem;
    private javax.swing.JTextField errorModelTextField;
    private javax.swing.JButton ffCancelButton;
    private javax.swing.JButton ffHelpButton;
    private javax.swing.JButton ffOKButton;
    private javax.swing.JButton fluxCancelButton;
    private javax.swing.JDialog fluxDialog;
    private javax.swing.JTextArea fluxEqTextArea;
    private javax.swing.JRadioButton fluxFixedRadioButton;
    private javax.swing.JButton fluxHelpButton;
    private javax.swing.JRadioButton fluxMixedRadioButton;
    private javax.swing.JTextField fluxModelTextField;
    private javax.swing.JLabel fluxNameLabel;
    private javax.swing.JButton fluxOKButton;
    private javax.swing.JRadioButton fluxRedefinedRadioButton;
    private javax.swing.JTextField fluxValueTextField;
    private javax.swing.JTextField fluxVariableTextField;
    private javax.swing.JButton forceButton;
    private javax.swing.JDialog forceDialog;
    private javax.swing.JRadioButton forceEqRadioButton;
    private javax.swing.JTextArea forceEqTextArea;
    private javax.swing.JLabel forceNameLabel;
    private javax.swing.JList fractionList;
    private javax.swing.JDialog inputDialog;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton10;
    private javax.swing.JButton jButton11;
    private javax.swing.JButton jButton12;
    private javax.swing.JButton jButton13;
    private javax.swing.JButton jButton14;
    private javax.swing.JButton jButton15;
    private javax.swing.JButton jButton16;
    private javax.swing.JButton jButton17;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton7;
    private javax.swing.JButton jButton8;
    private javax.swing.JButton jButton9;
    private javax.swing.JCheckBox jCheckBox1;
    private javax.swing.JCheckBox jCheckBox2;
    private javax.swing.JCheckBox jCheckBox3;
    private javax.swing.JCheckBox jCheckBox4;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JPopupMenu jPopupMenu1;
    private javax.swing.JRadioButton jRadioButton1;
    private javax.swing.JRadioButton jRadioButton2;
    private javax.swing.JRadioButton jRadioButton3;
    private javax.swing.JRadioButton jRadioButton4;
    private javax.swing.JRadioButton jRadioButton5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextArea jTextArea5;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTextField jTextField5;
    private javax.swing.JTextField jTextField6;
    private javax.swing.JTextField jTextField7;
    private javax.swing.JTextField jTextField8;
    private javax.swing.JTextField jTextField9;
    private javax.swing.JComboBox nDelayCompsComboBox;
    private javax.swing.JDialog paramDialog;
    private javax.swing.JTextArea paramEqTextArea;
    private javax.swing.JRadioButton paramFixedRadioButton;
    private javax.swing.JList paramList;
    private javax.swing.JRadioButton paramMixedRadioButton;
    private javax.swing.JTextField paramModelTextField;
    private javax.swing.JLabel paramNameLabel;
    private javax.swing.JLabel paramNameLabel1;
    private javax.swing.JLabel paramNameLabel2;
    private javax.swing.JRadioButton paramRedefinedRadioButton;
    private javax.swing.JTextField paramValueTextField;
    private javax.swing.JTextField paramVariableTextField;
    private javax.swing.JMenuItem renameMenuItem;
    private javax.swing.JButton sampleCancelButton;
    private javax.swing.JDialog sampleDialog;
    private javax.swing.JTextArea sampleEqTextArea;
    private javax.swing.JButton sampleHelpButton;
    private javax.swing.JLabel sampleNameLabel;
    private javax.swing.JButton sampleOKButton;
    private javax.swing.JDialog splitInputDialog;
    private javax.swing.JRadioButton turnOffRadioButton;
    // End of variables declaration//GEN-END:variables
    /** Paint the diagram.
     * @param gc Graphics.
     */    
    public void paintComponent(Graphics gc) 
    {
        super.paintComponent(gc);
        gc2D = ((Graphics2D)gc);
        gc2D.setBackground(Color.white);
        gc2D.setFont(new Font("SansSerif", Font.BOLD, 10));
        gc2D.setStroke(new BasicStroke(2.0f));
        gc2D.setPaintMode();
        gc2D.scale(frame.scale, frame.scale);
        model.draw(gc2D);
        if(tempElement != null) tempElement.drawBoundary(gc2D);
    }

    private Vector removedItem(String[] oldList, String[] newList)
    {
        Vector removed = new Vector();
        String text = "";
        for(int i = 0; i < newList.length; i++)
            text += " " + newList[i];
        for(int i = 0; i < oldList.length; i++)
            if(text.indexOf(oldList[i]) == -1)
                removed.add(oldList[i]);
        return removed;
    }
   
    
    private DesignTool frame;
    private Graphics2D gc2D;
    private Point2D start, last;
    private int x,y;
    private Dimension area;
    /** Model in the diagram */ 
    protected Model model;
    /** Starting element */
    protected Element startElement = null;
    /** Ending element */
    protected Element endElement = null;
    /** Temporary element */
    protected Element tempElement;
    private boolean isMouseDragged = false;
    private boolean isBackgroundClicked = false;
    private boolean isForcingFunctionOK = false;
    private Vector inputElement = new Vector();
    private DefaultListModel listModel = new DefaultListModel();
}
